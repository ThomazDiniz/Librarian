  [1m[35m (1.4ms)[0m  [1m[35mCREATE DATABASE "librarian_development" ENCODING = 'unicode'[0m
  [1m[35m (118.9ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35m (23.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (24.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT pg_try_advisory_lock(4742774613745530285)[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.8ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-11 10:35:33.324725', '2025-11-11 10:35:33.324733') RETURNING "key"[0m
Migrating to CreateUsers (20251111102212)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (21.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (6.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20251111102212') RETURNING "version"[0m
  [1m[36mTRANSACTION (3.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateBooks (20251111102305)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (17.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (9.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (6.5ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (7.3ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (6.5ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (0.8ms)[0m  [1m[35mALTER TABLE "books" ADD CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20251111102305') RETURNING "version"[0m
  [1m[36mTRANSACTION (3.5ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateBorrowings (20251111102335)
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (13.6ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
, CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
)[0m
  [1m[35m (10.6ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (6.4ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (8.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE returned_at IS NULL[0m
  [1m[36mActiveRecord::SchemaMigration Create (1.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20251111102335') RETURNING "version"[0m
  [1m[36mTRANSACTION (3.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.7ms)[0m  [1m[34mSELECT pg_advisory_unlock(4742774613745530285)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (1.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (2.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Libby Page"], ["email", "librarian@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:36:19.826890"], ["updated_at", "2025-11-11 10:36:19.826890"]]
  [1m[36mTRANSACTION (3.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (1.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Milo Reader"], ["email", "member@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:36:20.076903"], ["updated_at", "2025-11-11 10:36:20.076903"]]
  [1m[36mTRANSACTION (3.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (1.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Create (2.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Pragmatic Programmer"], ["author", "Andrew Hunt"], ["genre", "Technology"], ["isbn", "9780201616224"], ["total_copies", 3], ["description", nil], ["created_at", "2025-11-11 10:36:20.189466"], ["updated_at", "2025-11-11 10:36:20.189466"]]
  [1m[36mTRANSACTION (2.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Clean Code"], ["author", "Robert C. Martin"], ["genre", "Technology"], ["isbn", "9780132350884"], ["total_copies", 5], ["description", nil], ["created_at", "2025-11-11 10:36:20.321180"], ["updated_at", "2025-11-11 10:36:20.321180"]]
  [1m[36mTRANSACTION (2.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Sapiens"], ["author", "Yuval Noah Harari"], ["genre", "History"], ["isbn", "9780062316097"], ["total_copies", 4], ["description", nil], ["created_at", "2025-11-11 10:36:20.344218"], ["updated_at", "2025-11-11 10:36:20.344218"]]
  [1m[36mTRANSACTION (2.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Create (3.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Educated"], ["author", "Tara Westover"], ["genre", "Memoir"], ["isbn", "9780399590504"], ["total_copies", 2], ["description", nil], ["created_at", "2025-11-11 10:36:20.369438"], ["updated_at", "2025-11-11 10:36:20.369438"]]
  [1m[36mTRANSACTION (4.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (5.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "1984"], ["author", "George Orwell"], ["genre", "Fiction"], ["isbn", "9780451524935"], ["total_copies", 6], ["description", nil], ["created_at", "2025-11-11 10:36:20.397763"], ["updated_at", "2025-11-11 10:36:20.397763"]]
  [1m[36mTRANSACTION (4.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBorrowing Load (1.1ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBorrowing Count (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 1], ["borrowed_at", "2025-11-01 10:36:20.652340"], ["due_at", "2025-11-15 10:36:20.652340"], ["returned_at", nil], ["created_at", "2025-11-11 10:36:20.811520"], ["updated_at", "2025-11-11 10:36:20.811520"]]
  [1m[36mTRANSACTION (5.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBorrowing Load (0.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 2], ["borrowed_at", "2025-10-22 10:36:20.831186"], ["due_at", "2025-11-05 10:36:20.831186"], ["returned_at", nil], ["created_at", "2025-11-11 10:36:20.849492"], ["updated_at", "2025-11-11 10:36:20.849492"]]
  [1m[36mTRANSACTION (2.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (290.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (109.0ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (1.0ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (23.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (11.0ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (12.3ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (9.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (9.4ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (13.8ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (12.4ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (10.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (19.5ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (10.7ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (6.1ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (3.7ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (16.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (4.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (3.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (20.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-11 10:37:14.872950', '2025-11-11 10:37:14.872962') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (4.6ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-11 10:37:14.892029' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (4.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (4.9ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-11 10:37:15.021262', '2025-11-11 10:37:15.021271') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (27.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Wealth of Nations"], ["author", "Janene Schamberger"], ["genre", "Realistic fiction"], ["isbn", "12345"], ["total_copies", 2], ["description", "Natus ut atque. Cupiditate quis ipsa. Qui dolore exercitationem."], ["created_at", "2025-11-11 10:37:34.267407"], ["updated_at", "2025-11-11 10:37:34.267407"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (8.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Of Mice and Men"], ["author", "George Von III"], ["genre", "Comic/Graphic Novel"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Reprehenderit aut sunt. Consequuntur nesciunt pariatur. Voluptas ea non."], ["created_at", "2025-11-11 10:37:34.385019"], ["updated_at", "2025-11-11 10:37:34.385019"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Carmon Watsica I"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:34.652216"], ["updated_at", "2025-11-11 10:37:34.652216"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 7]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 3], ["book_id", 7], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 3], ["book_id", 7], ["borrowed_at", "2025-11-11 10:37:34.684932"], ["due_at", "2025-11-25 10:37:34.685019"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:34.742059"], ["updated_at", "2025-11-11 10:37:34.742059"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Librada Hilpert"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:34.985850"], ["updated_at", "2025-11-11 10:37:34.985850"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 7]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 4], ["book_id", 7], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 4], ["book_id", 7], ["borrowed_at", "2025-10-21 10:37:34.997397"], ["due_at", "2025-11-04 10:37:34.997627"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:35.014120"], ["updated_at", "2025-11-11 10:37:35.014120"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 7]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Velit ut voluptate. Dolores sit reiciendis. Sed id rerum."], ["created_at", "2025-11-11 10:37:35.089356"], ["updated_at", "2025-11-11 10:37:35.089356"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Quod et voluptatem. Voluptatem consequatur maiores. Quasi ut itaque."], ["created_at", "2025-11-11 10:37:35.112936"], ["updated_at", "2025-11-11 10:37:35.112936"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Way of All Flesh"], ["author", "Gov. Moon Gusikowski"], ["genre", "Horror"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Perferendis inventore nihil. Fugiat temporibus nihil. Sunt sapiente at."], ["created_at", "2025-11-11 10:37:35.732720"], ["updated_at", "2025-11-11 10:37:35.732720"]]
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mrs. Johanna Ritchie"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:36.045577"], ["updated_at", "2025-11-11 10:37:36.045577"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (7.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 10]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 5], ["book_id", 10], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 5], ["book_id", 10], ["borrowed_at", "2025-11-11 10:37:36.056988"], ["due_at", "2025-11-25 10:37:36.057624"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:36.082387"], ["updated_at", "2025-11-11 10:37:36.082387"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (9.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sandie Jones"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:36.367424"], ["updated_at", "2025-11-11 10:37:36.367424"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 10]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 6], ["book_id", 10], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (10.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Benny Rogahn"], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:36.684838"], ["updated_at", "2025-11-11 10:37:36.684838"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "No Country for Old Men"], ["author", "Tyrone Lemke"], ["genre", "Western"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Excepturi voluptatem aut. Quo assumenda quis. Distinctio minus ipsa."], ["created_at", "2025-11-11 10:37:36.711989"], ["updated_at", "2025-11-11 10:37:36.711989"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 11]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 7], ["book_id", 11], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 7], ["book_id", 11], ["borrowed_at", "2025-11-11 10:37:36.726705"], ["due_at", "2025-11-25 10:37:36.726777"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:36.745185"], ["updated_at", "2025-11-11 10:37:36.745185"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 11]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 7], ["book_id", 11], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Misha Goodwin"], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:37.132109"], ["updated_at", "2025-11-11 10:37:37.132109"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Swiftly Tilting Planet"], ["author", "Zane Harris I"], ["genre", "Crime/Detective"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "Et necessitatibus tenetur. Voluptatem pariatur sit. Provident ipsam ullam."], ["created_at", "2025-11-11 10:37:37.159239"], ["updated_at", "2025-11-11 10:37:37.159239"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (7.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 12]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 8], ["book_id", 12], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 8], ["book_id", 12], ["borrowed_at", "2025-11-11 10:37:37.166255"], ["due_at", "2025-11-25 10:37:37.166392"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:37.185086"], ["updated_at", "2025-11-11 10:37:37.185086"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "The Hon. Rheba Ortiz"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:37.493366"], ["updated_at", "2025-11-11 10:37:37.493366"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Glory and the Dream"], ["author", "Dino Hoeger"], ["genre", "Horror"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Ratione itaque maiores. Itaque dolores provident. Quasi quis rerum."], ["created_at", "2025-11-11 10:37:37.513957"], ["updated_at", "2025-11-11 10:37:37.513957"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (6.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 13]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 9], ["book_id", 13], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 9], ["book_id", 13], ["borrowed_at", "2025-11-11 10:37:37.529859"], ["due_at", "2025-11-25 10:37:37.530030"], ["returned_at", "2025-11-10 10:37:37.530291"], ["created_at", "2025-11-11 10:37:37.549384"], ["updated_at", "2025-11-11 10:37:37.549384"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Darin Kemmer"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:37.874711"], ["updated_at", "2025-11-11 10:37:37.874711"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "This Side of Paradise"], ["author", "Emmett Nikolaus DC"], ["genre", "Crime/Detective"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Qui ut sint. Enim dolorem non. Facilis voluptate et."], ["created_at", "2025-11-11 10:37:37.898574"], ["updated_at", "2025-11-11 10:37:37.898574"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 14]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 10], ["book_id", 14], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 10], ["book_id", 14], ["borrowed_at", "2025-10-21 10:37:37.908356"], ["due_at", "2025-11-04 10:37:37.908654"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:37.928245"], ["updated_at", "2025-11-11 10:37:37.928245"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Arleen Tromp"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:38.207612"], ["updated_at", "2025-11-11 10:37:38.207612"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Green Bay Tree"], ["author", "Granville Schimmel LLD"], ["genre", "Science fiction"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Non exercitationem earum. Non dolor omnis. Consequatur qui adipisci."], ["created_at", "2025-11-11 10:37:38.231308"], ["updated_at", "2025-11-11 10:37:38.231308"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 15]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 11], ["book_id", 15], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 11], ["book_id", 15], ["borrowed_at", "2025-11-11 10:37:38.247491"], ["due_at", "2025-11-25 10:37:38.247568"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:38.266926"], ["updated_at", "2025-11-11 10:37:38.266926"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (1.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:37:38.275263')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sen. German Ruecker"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:38.603782"], ["updated_at", "2025-11-11 10:37:38.603782"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "This Lime Tree Bower"], ["author", "Msgr. Connie Daniel"], ["genre", "Speech"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Exercitationem praesentium dolorum. Sit porro modi. Qui minima porro."], ["created_at", "2025-11-11 10:37:38.628481"], ["updated_at", "2025-11-11 10:37:38.628481"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 16]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 12], ["book_id", 16], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 12], ["book_id", 16], ["borrowed_at", "2025-11-11 10:37:38.644724"], ["due_at", "2025-11-25 10:37:38.644784"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:38.660937"], ["updated_at", "2025-11-11 10:37:38.660937"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (6.5ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 11]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lonnie Harber DVM"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:39.250314"], ["updated_at", "2025-11-11 10:37:39.250314"]]
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sergio Baumbach"], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:39.750766"], ["updated_at", "2025-11-11 10:37:39.750766"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Madeline Schaefer IV"], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:40.000840"], ["updated_at", "2025-11-11 10:37:40.000840"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (7.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Create (1.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "O Pioneers!"], ["author", "Everette Crona"], ["genre", "Textbook"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Qui sint ipsum. Soluta minus dolor. Temporibus illo voluptas."], ["created_at", "2025-11-11 10:37:40.024825"], ["updated_at", "2025-11-11 10:37:40.024825"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 17]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 15], ["book_id", 17], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 15], ["book_id", 17], ["borrowed_at", "2025-11-11 10:37:40.034175"], ["due_at", "2025-11-25 10:37:40.034701"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:40.049218"], ["updated_at", "2025-11-11 10:37:40.049218"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Mirror Crack'd from Side to Side"], ["author", "Beverley Mosciski"], ["genre", "Fairy tale"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Qui ullam eos. Aut est excepturi. Aut ratione non."], ["created_at", "2025-11-11 10:37:40.072574"], ["updated_at", "2025-11-11 10:37:40.072574"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (7.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 18]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 15], ["book_id", 18], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 15], ["book_id", 18], ["borrowed_at", "2025-11-11 10:37:40.081661"], ["due_at", "2025-11-25 10:37:40.081738"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:40.097524"], ["updated_at", "2025-11-11 10:37:40.097524"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 15]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ilda Dietrich"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:40.351403"], ["updated_at", "2025-11-11 10:37:40.351403"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (9.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Create (1.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "This Lime Tree Bower"], ["author", "Louis Spencer"], ["genre", "Fairy tale"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Perferendis nostrum facere. Ut sed et. Et dolorem sunt."], ["created_at", "2025-11-11 10:37:40.385814"], ["updated_at", "2025-11-11 10:37:40.385814"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (7.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 19]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 16], ["book_id", 19], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 16], ["book_id", 19], ["borrowed_at", "2025-11-11 10:37:40.398301"], ["due_at", "2025-11-25 10:37:40.398375"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:40.415760"], ["updated_at", "2025-11-11 10:37:40.415760"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Farewell to Arms"], ["author", "Donita Simonis"], ["genre", "Classic"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Fugit animi sit. Excepturi sit dolorem. Voluptatem impedit molestias."], ["created_at", "2025-11-11 10:37:40.440592"], ["updated_at", "2025-11-11 10:37:40.440592"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 20]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 16], ["book_id", 20], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 16], ["book_id", 20], ["borrowed_at", "2025-10-21 10:37:40.446688"], ["due_at", "2025-11-04 10:37:40.446836"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:40.459259"], ["updated_at", "2025-11-11 10:37:40.459259"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (1.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:37:40.467581')[0m  [["user_id", 16]]
  [1m[36mBorrowing Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:37:40.478269') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 16], ["id", 14], ["LIMIT", 1]]
  [1m[36mBorrowing Load (2.1ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:37:40.478269')[0m  [["user_id", 16]]
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Aura Muller"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:41.358981"], ["updated_at", "2025-11-11 10:37:41.358981"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Scotty Goyette"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:41.638972"], ["updated_at", "2025-11-11 10:37:41.638972"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (7.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Ut eaque accusantium. Ratione ut facere. Neque ut et."], ["created_at", "2025-11-11 10:37:41.676564"], ["updated_at", "2025-11-11 10:37:41.676564"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (2.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (9.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "Accusantium aliquid molestiae. Dicta ut placeat. Amet facilis neque."], ["created_at", "2025-11-11 10:37:41.701114"], ["updated_at", "2025-11-11 10:37:41.701114"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gerald Stracke"], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:41.968083"], ["updated_at", "2025-11-11 10:37:41.968083"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Architecto qui rerum. Nesciunt quia corrupti. Quidem et saepe."], ["created_at", "2025-11-11 10:37:42.051638"], ["updated_at", "2025-11-11 10:37:42.051638"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Et voluptas facilis. Rerum alias sed. Deserunt distinctio aspernatur."], ["created_at", "2025-11-11 10:37:42.074040"], ["updated_at", "2025-11-11 10:37:42.074040"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mrs. Hilaria Streich"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:42.330135"], ["updated_at", "2025-11-11 10:37:42.330135"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tenisha McDermott"], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:42.589866"], ["updated_at", "2025-11-11 10:37:42.589866"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mark Krajcik"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:42.835519"], ["updated_at", "2025-11-11 10:37:42.835519"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Create (1.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Fr. Cary Cremin"], ["genre", "Short story"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Non in ut. Dolores excepturi quisquam. Voluptatibus praesentium rerum."], ["created_at", "2025-11-11 10:37:42.866146"], ["updated_at", "2025-11-11 10:37:42.866146"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dante Huels"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:43.097630"], ["updated_at", "2025-11-11 10:37:43.097630"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Louetta Olson Jr."], ["genre", "Fanfiction"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "Officia distinctio sit. Eligendi nihil assumenda. In excepturi tempore."], ["created_at", "2025-11-11 10:37:43.129749"], ["updated_at", "2025-11-11 10:37:43.129749"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Cleopatra Schmidt"], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:43.364687"], ["updated_at", "2025-11-11 10:37:43.364687"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Heart Is a Lonely Hunter"], ["author", "Bernardo Powlowski"], ["genre", "Fanfiction"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Vel cumque deserunt. Illum sunt incidunt. Ea pariatur ut."], ["created_at", "2025-11-11 10:37:43.396485"], ["updated_at", "2025-11-11 10:37:43.396485"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Miss Hoyt Strosin"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:43.704240"], ["updated_at", "2025-11-11 10:37:43.704240"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Daffodil Sky"], ["author", "Pearle Konopelski"], ["genre", "Comic/Graphic Novel"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Voluptatum voluptas omnis. Odio molestiae atque. Eius pariatur esse."], ["created_at", "2025-11-11 10:37:43.734218"], ["updated_at", "2025-11-11 10:37:43.734218"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dane Reinger"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:43.979825"], ["updated_at", "2025-11-11 10:37:43.979825"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Hunter Gulgowski"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:44.210866"], ["updated_at", "2025-11-11 10:37:44.210866"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Oh! To be in England"], ["author", "Dr. Harold Stanton"], ["genre", "Metafiction"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Laudantium et est. Ut explicabo dicta. Et ducimus accusantium."], ["created_at", "2025-11-11 10:37:44.230476"], ["updated_at", "2025-11-11 10:37:44.230476"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 29]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 27], ["book_id", 29], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 27], ["book_id", 29], ["borrowed_at", "2025-11-11 10:37:44.239217"], ["due_at", "2025-11-25 10:37:44.239278"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:44.254766"], ["updated_at", "2025-11-11 10:37:44.254766"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lita Schulist I"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:44.493371"], ["updated_at", "2025-11-11 10:37:44.493371"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "From Here to Eternity"], ["author", "Janee Koelpin"], ["genre", "Horror"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "Provident et sit. Perspiciatis iure enim. Dolorum delectus in."], ["created_at", "2025-11-11 10:37:44.513443"], ["updated_at", "2025-11-11 10:37:44.513443"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 30]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 28], ["book_id", 30], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 28], ["book_id", 30], ["borrowed_at", "2025-11-11 10:37:44.520360"], ["due_at", "2025-11-25 10:37:44.520418"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:44.535226"], ["updated_at", "2025-11-11 10:37:44.535226"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Earnest Hamill Sr."], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:44.775773"], ["updated_at", "2025-11-11 10:37:44.775773"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Consider Phlebas"], ["author", "Lawerence Carroll"], ["genre", "Mythopoeia"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "Sit corrupti perferendis. Nam voluptatibus velit. Enim ipsum est."], ["created_at", "2025-11-11 10:37:44.798475"], ["updated_at", "2025-11-11 10:37:44.798475"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 31]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 29], ["book_id", 31], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 29], ["book_id", 31], ["borrowed_at", "2025-11-11 10:37:44.810176"], ["due_at", "2025-11-25 10:37:44.810243"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:44.825130"], ["updated_at", "2025-11-11 10:37:44.825130"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Nicholas Kautzer"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:45.064931"], ["updated_at", "2025-11-11 10:37:45.064931"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Create (2.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "For a Breath I Tarry"], ["author", "Hulda Baumbach Esq."], ["genre", "Science fiction"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Harum necessitatibus consequatur. Veniam distinctio nobis. Sed architecto aut."], ["created_at", "2025-11-11 10:37:45.088113"], ["updated_at", "2025-11-11 10:37:45.088113"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (8.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 32]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 30], ["book_id", 32], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 30], ["book_id", 32], ["borrowed_at", "2025-11-11 10:37:45.099914"], ["due_at", "2025-11-25 10:37:45.099990"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:45.122203"], ["updated_at", "2025-11-11 10:37:45.122203"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Annemarie Wuckert"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:45.363248"], ["updated_at", "2025-11-11 10:37:45.363248"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Heart Is Deceitful Above All Things"], ["author", "Fabiola Bruen Jr."], ["genre", "Narrative nonfiction"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "At deleniti nihil. Ut nam nulla. Explicabo cum necessitatibus."], ["created_at", "2025-11-11 10:37:45.380227"], ["updated_at", "2025-11-11 10:37:45.380227"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 33]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 31], ["book_id", 33], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 31], ["book_id", 33], ["borrowed_at", "2025-11-11 10:37:45.386185"], ["due_at", "2025-11-25 10:37:45.386248"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:45.403745"], ["updated_at", "2025-11-11 10:37:45.403745"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Shauna Nienow"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:45.633611"], ["updated_at", "2025-11-11 10:37:45.633611"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Some Buried Caesar"], ["author", "Xochitl Russel"], ["genre", "Legend"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "Perspiciatis aperiam aut. Ut consequatur iure. Blanditiis non molestiae."], ["created_at", "2025-11-11 10:37:45.652157"], ["updated_at", "2025-11-11 10:37:45.652157"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Keith Denesik"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:45.924746"], ["updated_at", "2025-11-11 10:37:45.924746"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (8.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Create (1.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Little Foxes"], ["author", "Pres. Loralee Doyle"], ["genre", "Narrative nonfiction"], ["isbn", "978030000033"], ["total_copies", 1], ["description", "Qui autem omnis. Libero reiciendis totam. Quibusdam natus non."], ["created_at", "2025-11-11 10:37:45.966145"], ["updated_at", "2025-11-11 10:37:45.966145"]]
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Omer Armstrong"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:46.219529"], ["updated_at", "2025-11-11 10:37:46.219529"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 35]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 34], ["book_id", 35], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 34], ["book_id", 35], ["borrowed_at", "2025-11-11 10:37:46.229821"], ["due_at", "2025-11-25 10:37:46.229938"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:46.244532"], ["updated_at", "2025-11-11 10:37:46.244532"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Logan Rath"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:46.523508"], ["updated_at", "2025-11-11 10:37:46.523508"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Many-Splendoured Thing"], ["author", "Carmine O'Conner"], ["genre", "Reference book"], ["isbn", "978030000034"], ["total_copies", 2], ["description", "Voluptas eius ducimus. Dignissimos est eos. Deleniti ad et."], ["created_at", "2025-11-11 10:37:46.565008"], ["updated_at", "2025-11-11 10:37:46.565008"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Issac Schulist"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:46.844422"], ["updated_at", "2025-11-11 10:37:46.844422"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (14.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Create (1.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fair Stood the Wind for France"], ["author", "Stephine Bartell"], ["genre", "Speech"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Doloribus molestiae qui. Animi id aut. Blanditiis aliquam eveniet."], ["created_at", "2025-11-11 10:37:46.891630"], ["updated_at", "2025-11-11 10:37:46.891630"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Omer Muller I"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:47.163548"], ["updated_at", "2025-11-11 10:37:47.163548"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 37]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 37], ["book_id", 37], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 37], ["book_id", 37], ["borrowed_at", "2025-11-11 10:37:47.173464"], ["due_at", "2025-11-25 10:37:47.173561"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:47.185193"], ["updated_at", "2025-11-11 10:37:47.185193"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Debbra Stiedemann DDS"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:47.475810"], ["updated_at", "2025-11-11 10:37:47.475810"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (12.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Quo Vadis"], ["author", "Charles Stehr"], ["genre", "Humor"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Aut ut ut. Sed voluptas omnis. Quibusdam error asperiores."], ["created_at", "2025-11-11 10:37:47.517218"], ["updated_at", "2025-11-11 10:37:47.517218"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Berry Bernhard"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:47.804585"], ["updated_at", "2025-11-11 10:37:47.804585"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 38]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 39], ["book_id", 38], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 39], ["book_id", 38], ["borrowed_at", "2025-11-11 10:37:47.818313"], ["due_at", "2025-11-25 10:37:47.818403"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:47.841343"], ["updated_at", "2025-11-11 10:37:47.841343"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (5.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Amb. Darrell Nienow"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:48.140990"], ["updated_at", "2025-11-11 10:37:48.140990"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mr. Beula Mraz"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:37:48.448385"], ["updated_at", "2025-11-11 10:37:48.448385"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jessi Waelchi PhD"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:48.737076"], ["updated_at", "2025-11-11 10:37:48.737076"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Frequent Hearses"], ["author", "Chan Sipes"], ["genre", "Historical fiction"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Nesciunt est et. Et corporis nemo. Consequuntur placeat amet."], ["created_at", "2025-11-11 10:37:48.764351"], ["updated_at", "2025-11-11 10:37:48.764351"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Summer Bird-Cage"], ["author", "Megan Huels"], ["genre", "Folklore"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Et voluptas ducimus. Qui vitae dolorum. Non est atque."], ["created_at", "2025-11-11 10:37:48.792387"], ["updated_at", "2025-11-11 10:37:48.792387"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 39]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 42], ["book_id", 39], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 42], ["book_id", 39], ["borrowed_at", "2025-11-11 10:37:48.803829"], ["due_at", "2025-11-25 10:37:48.803913"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:48.822532"], ["updated_at", "2025-11-11 10:37:48.822532"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 40]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 42], ["book_id", 40], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 42], ["book_id", 40], ["borrowed_at", "2025-10-21 10:37:48.836489"], ["due_at", "2025-11-04 10:37:48.836726"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:48.854238"], ["updated_at", "2025-11-11 10:37:48.854238"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Hugh Kohler"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:37:49.106946"], ["updated_at", "2025-11-11 10:37:49.106946"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Swiftly Tilting Planet"], ["author", "Mrs. Elden Lehner"], ["genre", "Biography/Autobiography"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Corporis beatae odio. Saepe quos laboriosam. Velit necessitatibus placeat."], ["created_at", "2025-11-11 10:37:49.131288"], ["updated_at", "2025-11-11 10:37:49.131288"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 41]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 43], ["book_id", 41], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 43], ["book_id", 41], ["borrowed_at", "2025-11-11 10:37:49.145080"], ["due_at", "2025-11-25 10:37:49.145149"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:49.163995"], ["updated_at", "2025-11-11 10:37:49.163995"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Heart Is a Lonely Hunter"], ["author", "Berniece Larkin"], ["genre", "Legend"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Porro quas quis. Repellendus vero voluptate. Voluptas sit inventore."], ["created_at", "2025-11-11 10:37:49.187150"], ["updated_at", "2025-11-11 10:37:49.187150"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 42]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 43], ["book_id", 42], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 43], ["book_id", 42], ["borrowed_at", "2025-10-21 10:37:49.197074"], ["due_at", "2025-11-04 10:37:49.197261"], ["returned_at", nil], ["created_at", "2025-11-11 10:37:49.213322"], ["updated_at", "2025-11-11 10:37:49.213322"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (2.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (100.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (108.2ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.9ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (22.7ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (11.0ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (15.9ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (7.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (8.2ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (13.5ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (10.2ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (22.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (11.0ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (17.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (11.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (5.0ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (6.7ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (27.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (10.0ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (3.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (17.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.8ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-11 10:40:25.812672', '2025-11-11 10:40:25.812679') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (7.6ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-11 10:40:26.005742' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (2.9ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-11 10:40:26.036053', '2025-11-11 10:40:26.036058') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (30.8ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "As I Lay Dying"], ["author", "Cristobal Sanford DO"], ["genre", "Horror"], ["isbn", "12345"], ["total_copies", 2], ["description", "Maxime sapiente laborum. Qui rerum rerum. Ratione vel ipsum."], ["created_at", "2025-11-11 10:40:31.471009"], ["updated_at", "2025-11-11 10:40:31.471009"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (11.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Gone with the Wind"], ["author", "Rep. Edison Bosco"], ["genre", "Fiction in verse"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Saepe soluta incidunt. Accusamus at temporibus. Eum officia consequuntur."], ["created_at", "2025-11-11 10:40:31.559805"], ["updated_at", "2025-11-11 10:40:31.559805"]]
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kayce Veum V"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:31.865898"], ["updated_at", "2025-11-11 10:40:31.865898"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (11.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 44]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 44], ["book_id", 44], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 44], ["book_id", 44], ["borrowed_at", "2025-11-11 10:40:31.908820"], ["due_at", "2025-11-25 10:40:31.908925"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:31.982821"], ["updated_at", "2025-11-11 10:40:31.982821"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rozella Ziemann"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:32.237990"], ["updated_at", "2025-11-11 10:40:32.237990"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 44]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 45], ["book_id", 44], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 45], ["book_id", 44], ["borrowed_at", "2025-10-21 10:40:32.246513"], ["due_at", "2025-11-04 10:40:32.246686"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:32.260103"], ["updated_at", "2025-11-11 10:40:32.260103"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 44]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Sit ut harum. Dolores dolorem sed. Doloremque voluptates velit."], ["created_at", "2025-11-11 10:40:32.299115"], ["updated_at", "2025-11-11 10:40:32.299115"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Eius repellendus quaerat. Eligendi qui nisi. Doloribus cumque enim."], ["created_at", "2025-11-11 10:40:32.342858"], ["updated_at", "2025-11-11 10:40:32.342858"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 45], ["LIMIT", 1]]
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 46], ["LIMIT", 1]]
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (8.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Let Us Now Praise Famous Men"], ["author", "Ramiro Boyle"], ["genre", "Horror"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Qui error accusantium. Quisquam ut neque. Libero culpa quae."], ["created_at", "2025-11-11 10:40:32.889612"], ["updated_at", "2025-11-11 10:40:32.889612"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mr. Spencer Blanda"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:33.139918"], ["updated_at", "2025-11-11 10:40:33.139918"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (6.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 47]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 46], ["book_id", 47], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 46], ["book_id", 47], ["borrowed_at", "2025-11-11 10:40:33.154844"], ["due_at", "2025-11-25 10:40:33.154938"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:33.174657"], ["updated_at", "2025-11-11 10:40:33.174657"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jacalyn Kuhn CPA"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:33.439289"], ["updated_at", "2025-11-11 10:40:33.439289"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 47]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 47], ["book_id", 47], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tomas Ondricka"], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:33.703305"], ["updated_at", "2025-11-11 10:40:33.703305"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Millstone"], ["author", "Ira Boehm V"], ["genre", "Speech"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Suscipit in sed. Dolorem amet nulla. Molestiae dignissimos consequatur."], ["created_at", "2025-11-11 10:40:33.738670"], ["updated_at", "2025-11-11 10:40:33.738670"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 48]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 48], ["book_id", 48], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (2.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 48], ["book_id", 48], ["borrowed_at", "2025-11-11 10:40:33.749663"], ["due_at", "2025-11-25 10:40:33.749739"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:33.765698"], ["updated_at", "2025-11-11 10:40:33.765698"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 48]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 48], ["book_id", 48], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jocelyn Jaskolski"], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:34.023421"], ["updated_at", "2025-11-11 10:40:34.023421"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Create (2.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Man Within"], ["author", "Clotilde Blick"], ["genre", "Mythology"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "Nihil fuga cum. Modi quas minima. Fuga culpa perferendis."], ["created_at", "2025-11-11 10:40:34.044713"], ["updated_at", "2025-11-11 10:40:34.044713"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 49]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 49], ["book_id", 49], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (2.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 49], ["book_id", 49], ["borrowed_at", "2025-11-11 10:40:34.057312"], ["due_at", "2025-11-25 10:40:34.057384"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:34.073104"], ["updated_at", "2025-11-11 10:40:34.073104"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dusty Kulas"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:34.316057"], ["updated_at", "2025-11-11 10:40:34.316057"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ego Dominus Tuus"], ["author", "Franklin Sporer"], ["genre", "Classic"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Assumenda laudantium placeat. Minus qui qui. Eius excepturi voluptatibus."], ["created_at", "2025-11-11 10:40:34.337711"], ["updated_at", "2025-11-11 10:40:34.337711"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (6.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 50]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 50], ["book_id", 50], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (2.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 50], ["book_id", 50], ["borrowed_at", "2025-11-11 10:40:34.347381"], ["due_at", "2025-11-25 10:40:34.347475"], ["returned_at", "2025-11-10 10:40:34.347713"], ["created_at", "2025-11-11 10:40:34.363327"], ["updated_at", "2025-11-11 10:40:34.363327"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 32], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (3.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Diego Ryan"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:34.641318"], ["updated_at", "2025-11-11 10:40:34.641318"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Create (1.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Dying of the Light"], ["author", "Randolph Predovic"], ["genre", "Fantasy"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Fuga natus iusto. In perferendis odio. Nostrum quas nisi."], ["created_at", "2025-11-11 10:40:34.673061"], ["updated_at", "2025-11-11 10:40:34.673061"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 51]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 51], ["book_id", 51], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 51], ["book_id", 51], ["borrowed_at", "2025-10-21 10:40:34.687343"], ["due_at", "2025-11-04 10:40:34.687508"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:34.706521"], ["updated_at", "2025-11-11 10:40:34.706521"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Noella Koelpin"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:34.971364"], ["updated_at", "2025-11-11 10:40:34.971364"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Moab Is My Washpot"], ["author", "Colin Cole"], ["genre", "Short story"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Voluptatem ut suscipit. Corrupti placeat non. Rem architecto velit."], ["created_at", "2025-11-11 10:40:34.992465"], ["updated_at", "2025-11-11 10:40:34.992465"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (8.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 52]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 52], ["book_id", 52], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 52], ["book_id", 52], ["borrowed_at", "2025-11-11 10:40:35.007953"], ["due_at", "2025-11-25 10:40:35.008060"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:35.031093"], ["updated_at", "2025-11-11 10:40:35.031093"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (1.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:40:35.041110')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ms. Maragret Schaefer"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:35.282705"], ["updated_at", "2025-11-11 10:40:35.282705"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Cricket on the Hearth"], ["author", "Jesus Bergstrom"], ["genre", "Narrative nonfiction"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Molestiae ut voluptas. Est numquam iure. Fugiat architecto amet."], ["created_at", "2025-11-11 10:40:35.301894"], ["updated_at", "2025-11-11 10:40:35.301894"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 53]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 53], ["book_id", 53], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 53], ["book_id", 53], ["borrowed_at", "2025-11-11 10:40:35.310844"], ["due_at", "2025-11-25 10:40:35.310912"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:35.325510"], ["updated_at", "2025-11-11 10:40:35.325510"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (4.1ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 36]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jamaal McLaughlin IV"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:35.812259"], ["updated_at", "2025-11-11 10:40:35.812259"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Taneka Heaney Sr."], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:36.307021"], ["updated_at", "2025-11-11 10:40:36.307021"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Stan Brown"], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:36.544111"], ["updated_at", "2025-11-11 10:40:36.544111"]]
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "By Grand Central Station I Sat Down and Wept"], ["author", "Stephen Rath"], ["genre", "Fantasy"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Consequuntur aliquam voluptatibus. Saepe exercitationem laborum. Quae quis omnis."], ["created_at", "2025-11-11 10:40:36.566053"], ["updated_at", "2025-11-11 10:40:36.566053"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 54]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 56], ["book_id", 54], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 56], ["book_id", 54], ["borrowed_at", "2025-11-11 10:40:36.573811"], ["due_at", "2025-11-25 10:40:36.573942"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:36.589429"], ["updated_at", "2025-11-11 10:40:36.589429"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Brandy of the Damned"], ["author", "Marget Keeling"], ["genre", "Historical fiction"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Deserunt laudantium corporis. Optio nulla iusto. Est quia provident."], ["created_at", "2025-11-11 10:40:36.608107"], ["updated_at", "2025-11-11 10:40:36.608107"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 55]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 56], ["book_id", 55], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 56], ["book_id", 55], ["borrowed_at", "2025-11-11 10:40:36.617062"], ["due_at", "2025-11-25 10:40:36.617138"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:36.628278"], ["updated_at", "2025-11-11 10:40:36.628278"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 56]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kraig Wyman"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:36.874860"], ["updated_at", "2025-11-11 10:40:36.874860"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "As I Lay Dying"], ["author", "Marvin Bergstrom"], ["genre", "Mythopoeia"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Aut nostrum voluptatem. Sequi non consequatur. Asperiores porro distinctio."], ["created_at", "2025-11-11 10:40:36.900166"], ["updated_at", "2025-11-11 10:40:36.900166"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 56]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 57], ["book_id", 56], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 57], ["book_id", 56], ["borrowed_at", "2025-11-11 10:40:36.909972"], ["due_at", "2025-11-25 10:40:36.910026"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:36.924436"], ["updated_at", "2025-11-11 10:40:36.924436"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "In Death Ground"], ["author", "Bryanna Towne DVM"], ["genre", "Classic"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Quibusdam facere cumque. Beatae quia nobis. Mollitia inventore quis."], ["created_at", "2025-11-11 10:40:36.948188"], ["updated_at", "2025-11-11 10:40:36.948188"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (6.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 57]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 57], ["book_id", 57], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 57], ["book_id", 57], ["borrowed_at", "2025-10-21 10:40:36.958545"], ["due_at", "2025-11-04 10:40:36.959482"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:36.974931"], ["updated_at", "2025-11-11 10:40:36.974931"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (1.1ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:40:36.985359')[0m  [["user_id", 57]]
  [1m[36mBorrowing Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:40:36.990735') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 57], ["id", 39], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.1ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:40:36.990735')[0m  [["user_id", 57]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mBEGIN[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Margarett Hagenes"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:37.371450"], ["updated_at", "2025-11-11 10:40:37.371450"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Aja Toy"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:37.601559"], ["updated_at", "2025-11-11 10:40:37.601559"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Ea quisquam eos. Voluptas assumenda aut. Dolore earum corporis."], ["created_at", "2025-11-11 10:40:37.632499"], ["updated_at", "2025-11-11 10:40:37.632499"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (15.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "Modi est voluptates. Beatae dolores laudantium. Nam illo velit."], ["created_at", "2025-11-11 10:40:37.661183"], ["updated_at", "2025-11-11 10:40:37.661183"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Columbus Rodriguez"], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:37.880467"], ["updated_at", "2025-11-11 10:40:37.880467"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Sapiente facere quod. Totam reiciendis rem. Atque eveniet ea."], ["created_at", "2025-11-11 10:40:37.921704"], ["updated_at", "2025-11-11 10:40:37.921704"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Sunt excepturi veritatis. Occaecati et ea. Molestiae iusto nihil."], ["created_at", "2025-11-11 10:40:37.933447"], ["updated_at", "2025-11-11 10:40:37.933447"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Alyson Jacobs"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:38.135849"], ["updated_at", "2025-11-11 10:40:38.135849"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Demetria D'Amore"], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:38.379343"], ["updated_at", "2025-11-11 10:40:38.379343"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ami Keebler"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:38.642613"], ["updated_at", "2025-11-11 10:40:38.642613"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Create (2.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Queenie Schultz"], ["genre", "Historical fiction"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Quis quam perspiciatis. Minima quis sed. In officiis perspiciatis."], ["created_at", "2025-11-11 10:40:38.695729"], ["updated_at", "2025-11-11 10:40:38.695729"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Roseanne Leannon"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:38.946582"], ["updated_at", "2025-11-11 10:40:38.946582"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Elroy Kreiger"], ["genre", "Tall tale"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "Deleniti quis eos. Autem et perspiciatis. Labore placeat unde."], ["created_at", "2025-11-11 10:40:38.986011"], ["updated_at", "2025-11-11 10:40:38.986011"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (11.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Johnathan Reinger"], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:39.227995"], ["updated_at", "2025-11-11 10:40:39.227995"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "By Grand Central Station I Sat Down and Wept"], ["author", "Armando Aufderhar"], ["genre", "Fantasy"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Dignissimos consequatur possimus. Veritatis consequatur ad. Magnam rerum non."], ["created_at", "2025-11-11 10:40:39.273913"], ["updated_at", "2025-11-11 10:40:39.273913"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Nikole Baumbach"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:39.517324"], ["updated_at", "2025-11-11 10:40:39.517324"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mBook Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Now Sleeps the Crimson Petal"], ["author", "Petra Durgan"], ["genre", "Essay"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Architecto laudantium et. Ad aperiam dolorem. Eos explicabo soluta."], ["created_at", "2025-11-11 10:40:39.571246"], ["updated_at", "2025-11-11 10:40:39.571246"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (13.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jaime Brown"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:39.816193"], ["updated_at", "2025-11-11 10:40:39.816193"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jean Streich"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:40.073233"], ["updated_at", "2025-11-11 10:40:40.073233"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Create (1.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Many Waters"], ["author", "Emmitt Beier"], ["genre", "Mythology"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Labore est voluptate. Qui aperiam omnis. Qui est ullam."], ["created_at", "2025-11-11 10:40:40.097891"], ["updated_at", "2025-11-11 10:40:40.097891"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 66]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 68], ["book_id", 66], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 68], ["book_id", 66], ["borrowed_at", "2025-11-11 10:40:40.111728"], ["due_at", "2025-11-25 10:40:40.111893"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:40.129461"], ["updated_at", "2025-11-11 10:40:40.129461"]]
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mr. Oliver Turner"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:40.369619"], ["updated_at", "2025-11-11 10:40:40.369619"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Golden Apples of the Sun"], ["author", "Mrs. Omer Watsica"], ["genre", "Reference book"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "Numquam ab adipisci. Deleniti explicabo cupiditate. Ex quia omnis."], ["created_at", "2025-11-11 10:40:40.389222"], ["updated_at", "2025-11-11 10:40:40.389222"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (7.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 67]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 69], ["book_id", 67], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 69], ["book_id", 67], ["borrowed_at", "2025-11-11 10:40:40.397177"], ["due_at", "2025-11-25 10:40:40.397247"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:40.415477"], ["updated_at", "2025-11-11 10:40:40.415477"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Penni Wiza"], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:40.657075"], ["updated_at", "2025-11-11 10:40:40.657075"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Vile Bodies"], ["author", "Gino Willms CPA"], ["genre", "Essay"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "Quo aspernatur dolor. Voluptatum laudantium dolor. Voluptates perspiciatis a."], ["created_at", "2025-11-11 10:40:40.678911"], ["updated_at", "2025-11-11 10:40:40.678911"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 68]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 70], ["book_id", 68], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 70], ["book_id", 68], ["borrowed_at", "2025-11-11 10:40:40.695993"], ["due_at", "2025-11-25 10:40:40.696192"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:40.712885"], ["updated_at", "2025-11-11 10:40:40.712885"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Darrick Roob"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:40.946492"], ["updated_at", "2025-11-11 10:40:40.946492"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "After Many a Summer Dies the Swan"], ["author", "Tyler Turcotte"], ["genre", "Tall tale"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Quae a numquam. Doloribus earum et. Voluptates est ut."], ["created_at", "2025-11-11 10:40:40.967453"], ["updated_at", "2025-11-11 10:40:40.967453"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 69]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 71], ["book_id", 69], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (2.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 71], ["book_id", 69], ["borrowed_at", "2025-11-11 10:40:40.977907"], ["due_at", "2025-11-25 10:40:40.977970"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:40.991781"], ["updated_at", "2025-11-11 10:40:40.991781"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Donya Gleason"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:41.222930"], ["updated_at", "2025-11-11 10:40:41.222930"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (7.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Have His Carcase"], ["author", "Prof. Emmitt Berge"], ["genre", "Fiction narrative"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "Dolorem debitis praesentium. Possimus provident nemo. Est officiis ipsum."], ["created_at", "2025-11-11 10:40:41.244598"], ["updated_at", "2025-11-11 10:40:41.244598"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 70]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 72], ["book_id", 70], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 72], ["book_id", 70], ["borrowed_at", "2025-11-11 10:40:41.251316"], ["due_at", "2025-11-25 10:40:41.251380"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:41.264810"], ["updated_at", "2025-11-11 10:40:41.264810"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dr. Keesha Rosenbaum"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:41.479192"], ["updated_at", "2025-11-11 10:40:41.479192"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Soldier's Art"], ["author", "Colby Lang"], ["genre", "Fairy tale"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "Consequuntur odit quo. Voluptatum dicta maxime. Labore consequatur quia."], ["created_at", "2025-11-11 10:40:41.515481"], ["updated_at", "2025-11-11 10:40:41.515481"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Carmen Hamill"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:41.719145"], ["updated_at", "2025-11-11 10:40:41.719145"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Tiger! Tiger!"], ["author", "Maira Cronin"], ["genre", "Mystery"], ["isbn", "978030000033"], ["total_copies", 1], ["description", "Omnis et voluptatem. Dolorem adipisci est. Dolor ipsam rerum."], ["created_at", "2025-11-11 10:40:41.747307"], ["updated_at", "2025-11-11 10:40:41.747307"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Buena Nicolas"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:41.947466"], ["updated_at", "2025-11-11 10:40:41.947466"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 72]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 75], ["book_id", 72], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 75], ["book_id", 72], ["borrowed_at", "2025-11-11 10:40:41.953068"], ["due_at", "2025-11-25 10:40:41.953159"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:41.962112"], ["updated_at", "2025-11-11 10:40:41.962112"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Allen Haley"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:42.177564"], ["updated_at", "2025-11-11 10:40:42.177564"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Have His Carcase"], ["author", "Amb. Eli Bednar"], ["genre", "Historical fiction"], ["isbn", "978030000034"], ["total_copies", 2], ["description", "Pariatur consequuntur id. Sed occaecati ea. Ex ea aperiam."], ["created_at", "2025-11-11 10:40:42.211689"], ["updated_at", "2025-11-11 10:40:42.211689"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Caitlin Robel"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:42.436164"], ["updated_at", "2025-11-11 10:40:42.436164"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (12.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Create (2.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "For a Breath I Tarry"], ["author", "Jere Wiza"], ["genre", "Metafiction"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Laudantium voluptatem enim. Ab sequi voluptatem. Dolorem hic error."], ["created_at", "2025-11-11 10:40:42.477336"], ["updated_at", "2025-11-11 10:40:42.477336"]]
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Alberto Ritchie"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:42.704166"], ["updated_at", "2025-11-11 10:40:42.704166"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 74]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 78], ["book_id", 74], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 78], ["book_id", 74], ["borrowed_at", "2025-11-11 10:40:42.713333"], ["due_at", "2025-11-25 10:40:42.713415"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:42.731943"], ["updated_at", "2025-11-11 10:40:42.731943"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tawnya Rohan"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:42.945173"], ["updated_at", "2025-11-11 10:40:42.945173"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Create (1.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Beneath the Bleeding"], ["author", "Shavonne Fritsch Esq."], ["genre", "Biography/Autobiography"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Voluptates nihil quis. Eius sunt ut. In libero atque."], ["created_at", "2025-11-11 10:40:42.985281"], ["updated_at", "2025-11-11 10:40:42.985281"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lourdes Goyette"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:43.211949"], ["updated_at", "2025-11-11 10:40:43.211949"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 75]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 80], ["book_id", 75], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 80], ["book_id", 75], ["borrowed_at", "2025-11-11 10:40:43.219880"], ["due_at", "2025-11-25 10:40:43.219985"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:43.237552"], ["updated_at", "2025-11-11 10:40:43.237552"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jean Stiedemann"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:43.454571"], ["updated_at", "2025-11-11 10:40:43.454571"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Antonia Rau JD"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:40:43.703140"], ["updated_at", "2025-11-11 10:40:43.703140"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jeanelle Adams"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:43.926781"], ["updated_at", "2025-11-11 10:40:43.926781"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Number the Stars"], ["author", "Mark Keeling"], ["genre", "Reference book"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Eius sit omnis. Sed ut dolores. Voluptate dignissimos ipsum."], ["created_at", "2025-11-11 10:40:43.945991"], ["updated_at", "2025-11-11 10:40:43.945991"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Bury My Heart at Wounded Knee"], ["author", "Rueben Legros I"], ["genre", "Western"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Beatae quibusdam sunt. Est omnis voluptate. Explicabo consequatur in."], ["created_at", "2025-11-11 10:40:43.965157"], ["updated_at", "2025-11-11 10:40:43.965157"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 76]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 83], ["book_id", 76], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 83], ["book_id", 76], ["borrowed_at", "2025-11-11 10:40:43.976791"], ["due_at", "2025-11-25 10:40:43.976848"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:43.988623"], ["updated_at", "2025-11-11 10:40:43.988623"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (6.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 77]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 83], ["book_id", 77], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 83], ["book_id", 77], ["borrowed_at", "2025-10-21 10:40:43.998587"], ["due_at", "2025-11-04 10:40:43.998763"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:44.014935"], ["updated_at", "2025-11-11 10:40:44.014935"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Merlin Schuster"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:40:44.251027"], ["updated_at", "2025-11-11 10:40:44.251027"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Jacob Have I Loved"], ["author", "Frankie West"], ["genre", "Mythopoeia"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Ut sunt quo. Perferendis aut ut. Ipsam vel voluptates."], ["created_at", "2025-11-11 10:40:44.267527"], ["updated_at", "2025-11-11 10:40:44.267527"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 78]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 84], ["book_id", 78], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 84], ["book_id", 78], ["borrowed_at", "2025-11-11 10:40:44.275674"], ["due_at", "2025-11-25 10:40:44.275741"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:44.288283"], ["updated_at", "2025-11-11 10:40:44.288283"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (7.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Down to a Sunless Sea"], ["author", "Sharla Mante CPA"], ["genre", "Mystery"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Excepturi minus ducimus. Impedit reiciendis libero. Voluptas consequatur impedit."], ["created_at", "2025-11-11 10:40:44.308883"], ["updated_at", "2025-11-11 10:40:44.308883"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 79]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 84], ["book_id", 79], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 84], ["book_id", 79], ["borrowed_at", "2025-10-21 10:40:44.315524"], ["due_at", "2025-11-04 10:40:44.315724"], ["returned_at", nil], ["created_at", "2025-11-11 10:40:44.329422"], ["updated_at", "2025-11-11 10:40:44.329422"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
[ActionDispatch::HostAuthorization::DefaultResponseApp] Blocked hosts: www.example.com
  [1m[36mActiveRecord::InternalMetadata Load (2.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (94.6ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (96.9ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.9ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (19.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (12.7ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (12.9ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (10.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (9.4ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (10.2ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (7.6ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (10.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (9.1ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (17.2ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (9.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (6.0ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (6.7ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (15.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (5.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (6.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (16.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.8ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-11 10:46:43.594610', '2025-11-11 10:46:43.594613') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (3.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-11 10:46:43.707966' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.8ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-11 10:46:43.718155', '2025-11-11 10:46:43.718162') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (33.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Create (1.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Specimen Days"], ["author", "Carolynn Parker"], ["genre", "Metafiction"], ["isbn", "12345"], ["total_copies", 2], ["description", "Tenetur iste similique. Eaque nostrum aliquid. Dolorem dolor eaque."], ["created_at", "2025-11-11 10:46:47.097058"], ["updated_at", "2025-11-11 10:46:47.097058"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Of Human Bondage"], ["author", "Jane Rippin"], ["genre", "Mythopoeia"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Perspiciatis et fugiat. Est dolor fuga. Quis blanditiis aspernatur."], ["created_at", "2025-11-11 10:46:47.161244"], ["updated_at", "2025-11-11 10:46:47.161244"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Delila Heathcote"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:47.445045"], ["updated_at", "2025-11-11 10:46:47.445045"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (6.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 81]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 85], ["book_id", 81], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 85], ["book_id", 81], ["borrowed_at", "2025-11-11 10:46:47.476974"], ["due_at", "2025-11-25 10:46:47.477098"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:47.535130"], ["updated_at", "2025-11-11 10:46:47.535130"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (2.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Chadwick Harvey"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:47.765346"], ["updated_at", "2025-11-11 10:46:47.765346"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 81]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 86], ["book_id", 81], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 86], ["book_id", 81], ["borrowed_at", "2025-10-21 10:46:47.781371"], ["due_at", "2025-11-04 10:46:47.781727"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:47.804327"], ["updated_at", "2025-11-11 10:46:47.804327"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 81]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Molestiae delectus ut. Consequatur possimus consequatur. Illum eveniet sunt."], ["created_at", "2025-11-11 10:46:47.834768"], ["updated_at", "2025-11-11 10:46:47.834768"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Doloremque quaerat praesentium. Nostrum sint vero. Cumque earum non."], ["created_at", "2025-11-11 10:46:47.872969"], ["updated_at", "2025-11-11 10:46:47.872969"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mBook Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mBook Load (1.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Shall not Perish"], ["author", "Dale Windler"], ["genre", "Mythopoeia"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Facilis sequi ea. Quidem quasi itaque. Quidem omnis consequatur."], ["created_at", "2025-11-11 10:46:48.386392"], ["updated_at", "2025-11-11 10:46:48.386392"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (2.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elvis Bogisich"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:48.632561"], ["updated_at", "2025-11-11 10:46:48.632561"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (9.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 84]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 87], ["book_id", 84], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 87], ["book_id", 84], ["borrowed_at", "2025-11-11 10:46:48.647636"], ["due_at", "2025-11-25 10:46:48.647717"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:48.667738"], ["updated_at", "2025-11-11 10:46:48.667738"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (4.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Marlene Turcotte"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:48.915560"], ["updated_at", "2025-11-11 10:46:48.915560"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 84]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 88], ["book_id", 84], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (11.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (3.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Robt Moen"], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:49.181468"], ["updated_at", "2025-11-11 10:46:49.181468"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "O Pioneers!"], ["author", "Prof. Carol Durgan"], ["genre", "Speech"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Laboriosam saepe repudiandae. Consequatur sequi tenetur. Corporis nisi sequi."], ["created_at", "2025-11-11 10:46:49.205090"], ["updated_at", "2025-11-11 10:46:49.205090"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 85]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 89], ["book_id", 85], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 89], ["book_id", 85], ["borrowed_at", "2025-11-11 10:46:49.214064"], ["due_at", "2025-11-25 10:46:49.214114"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:49.227937"], ["updated_at", "2025-11-11 10:46:49.227937"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 85]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 89], ["book_id", 85], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (2.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gonzalo Koss"], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:49.495669"], ["updated_at", "2025-11-11 10:46:49.495669"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Blithe Spirit"], ["author", "Hilda Mueller"], ["genre", "Mythopoeia"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "Quia itaque ea. Optio vitae modi. Est quaerat dolores."], ["created_at", "2025-11-11 10:46:49.520568"], ["updated_at", "2025-11-11 10:46:49.520568"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 86]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 90], ["book_id", 86], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 90], ["book_id", 86], ["borrowed_at", "2025-11-11 10:46:49.530063"], ["due_at", "2025-11-25 10:46:49.530117"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:49.544404"], ["updated_at", "2025-11-11 10:46:49.544404"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gov. Edmundo Botsford"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:49.782342"], ["updated_at", "2025-11-11 10:46:49.782342"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Skull Beneath the Skin"], ["author", "Oliver Schumm"], ["genre", "Historical fiction"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Minima nesciunt reprehenderit. Recusandae dolorem velit. Ipsum modi eligendi."], ["created_at", "2025-11-11 10:46:49.806075"], ["updated_at", "2025-11-11 10:46:49.806075"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 87]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 91], ["book_id", 87], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 91], ["book_id", 87], ["borrowed_at", "2025-11-11 10:46:49.815229"], ["due_at", "2025-11-25 10:46:49.815542"], ["returned_at", "2025-11-10 10:46:49.815779"], ["created_at", "2025-11-11 10:46:49.829017"], ["updated_at", "2025-11-11 10:46:49.829017"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 57], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 58], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Camilla Roberts VM"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:50.090649"], ["updated_at", "2025-11-11 10:46:50.090649"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The World, the Flesh and the Devil"], ["author", "Miss Michal Christiansen"], ["genre", "Short story"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Nulla rem deleniti. Est eius odit. Aut dolorem facere."], ["created_at", "2025-11-11 10:46:50.114196"], ["updated_at", "2025-11-11 10:46:50.114196"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 88]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 92], ["book_id", 88], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 92], ["book_id", 88], ["borrowed_at", "2025-10-21 10:46:50.127988"], ["due_at", "2025-11-04 10:46:50.128317"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:50.143573"], ["updated_at", "2025-11-11 10:46:50.143573"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Haywood Harber"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:50.370962"], ["updated_at", "2025-11-11 10:46:50.370962"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "That Good Night"], ["author", "Amado Moore"], ["genre", "Legend"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Autem quas aut. Ab laboriosam blanditiis. Voluptates est omnis."], ["created_at", "2025-11-11 10:46:50.394243"], ["updated_at", "2025-11-11 10:46:50.394243"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 89]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 93], ["book_id", 89], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 93], ["book_id", 89], ["borrowed_at", "2025-11-11 10:46:50.408417"], ["due_at", "2025-11-25 10:46:50.408578"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:50.421957"], ["updated_at", "2025-11-11 10:46:50.421957"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:46:50.430552') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 59], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:46:50.438466') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 60], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.1ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:46:50.438466')[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gretchen Blick"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:50.677139"], ["updated_at", "2025-11-11 10:46:50.677139"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Create (1.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Farewell to Arms"], ["author", "Alexis Cassin"], ["genre", "Fantasy"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Quod accusamus cum. Qui placeat aut. Qui architecto repudiandae."], ["created_at", "2025-11-11 10:46:50.701089"], ["updated_at", "2025-11-11 10:46:50.701089"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 90]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 94], ["book_id", 90], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 94], ["book_id", 90], ["borrowed_at", "2025-11-11 10:46:50.713480"], ["due_at", "2025-11-25 10:46:50.713598"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:50.729343"], ["updated_at", "2025-11-11 10:46:50.729343"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (4.3ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 61]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lelah McLaughlin"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:51.232025"], ["updated_at", "2025-11-11 10:46:51.232025"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "The Hon. Solomon Carter"], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:51.715840"], ["updated_at", "2025-11-11 10:46:51.715840"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (1.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 96], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Vanna Shields"], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:51.964256"], ["updated_at", "2025-11-11 10:46:51.964256"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Tirra Lirra by the River"], ["author", "Catheryn Dooley"], ["genre", "Fairy tale"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Numquam eos et. Aspernatur quo dolores. Qui architecto sint."], ["created_at", "2025-11-11 10:46:51.984050"], ["updated_at", "2025-11-11 10:46:51.984050"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 91]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 97], ["book_id", 91], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 97], ["book_id", 91], ["borrowed_at", "2025-11-11 10:46:51.993934"], ["due_at", "2025-11-25 10:46:51.994051"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:52.007241"], ["updated_at", "2025-11-11 10:46:52.007241"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "I Will Fear No Evil"], ["author", "Polly Kuhn"], ["genre", "Biography/Autobiography"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Nobis eligendi consequatur. Qui veniam esse. In voluptatem ut."], ["created_at", "2025-11-11 10:46:52.032667"], ["updated_at", "2025-11-11 10:46:52.032667"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 92]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 97], ["book_id", 92], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 97], ["book_id", 92], ["borrowed_at", "2025-11-11 10:46:52.043995"], ["due_at", "2025-11-25 10:46:52.044210"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:52.058407"], ["updated_at", "2025-11-11 10:46:52.058407"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 97]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Trinidad VonRueden"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:52.287148"], ["updated_at", "2025-11-11 10:46:52.287148"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (11.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Summer Bird-Cage"], ["author", "Sen. Virgilio White"], ["genre", "Textbook"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Sapiente animi iure. Aliquid sint rerum. Quisquam nemo fuga."], ["created_at", "2025-11-11 10:46:52.311254"], ["updated_at", "2025-11-11 10:46:52.311254"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 93]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 98], ["book_id", 93], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 98], ["book_id", 93], ["borrowed_at", "2025-11-11 10:46:52.320148"], ["due_at", "2025-11-25 10:46:52.320215"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:52.339393"], ["updated_at", "2025-11-11 10:46:52.339393"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (7.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Blood's a Rover"], ["author", "Kenneth McGlynn"], ["genre", "Classic"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Et sequi at. Voluptatibus tempore earum. Voluptatem id qui."], ["created_at", "2025-11-11 10:46:52.362634"], ["updated_at", "2025-11-11 10:46:52.362634"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 94]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 98], ["book_id", 94], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 98], ["book_id", 94], ["borrowed_at", "2025-10-21 10:46:52.371567"], ["due_at", "2025-11-04 10:46:52.371819"], ["returned_at", nil], ["created_at", "2025-11-11 10:46:52.385220"], ["updated_at", "2025-11-11 10:46:52.385220"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:46:52.394438')[0m  [["user_id", 98]]
  [1m[36mBorrowing Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:46:52.400461') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 98], ["id", 64], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.0ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:46:52.400461')[0m  [["user_id", 98]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-11 10:46:52 +0000
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "auth"=>{"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "sam@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sam Reader"], ["email", "sam@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:53.049705"], ["updated_at", "2025-11-11 10:46:53.049705"]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 201 Created in 277ms (Views: 0.6ms | ActiveRecord: 5.3ms | Allocations: 5184)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-11 10:46:53 +0000
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"email"=>""}, "auth"=>{"user"=>{"email"=>""}}}
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (6.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", ""], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 422 Unprocessable Content in 18ms (Views: 0.6ms | ActiveRecord: 7.8ms | Allocations: 3357)


  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ericka Macejkovic"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:53.495895"], ["updated_at", "2025-11-11 10:46:53.495895"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-11 10:46:53 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 234ms (Views: 0.7ms | ActiveRecord: 0.5ms | Allocations: 828)


  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (2.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ashely Sawayn"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:54.183523"], ["updated_at", "2025-11-11 10:46:54.183523"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-11 10:46:54 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 401 Unauthorized in 223ms (Views: 0.7ms | ActiveRecord: 1.6ms | Allocations: 580)


  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Enim ut temporibus. Autem aliquam et. Ex nemo laboriosam."], ["created_at", "2025-11-11 10:46:54.620833"], ["updated_at", "2025-11-11 10:46:54.620833"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "Quo ipsum et. Neque voluptatem sint. Consequatur consequatur et."], ["created_at", "2025-11-11 10:46:54.642850"], ["updated_at", "2025-11-11 10:46:54.642850"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Maryln Nolan"], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:54.881076"], ["updated_at", "2025-11-11 10:46:54.881076"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books" for 127.0.0.1 at 2025-11-11 10:46:54 +0000
Processing by BooksController#index as HTML
  Parameters: {"book"=>{}}
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (3.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 95]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 96]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 70ms (Views: 0.5ms | ActiveRecord: 11.3ms | Allocations: 6029)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Ipsa perferendis facere. Laborum illo error. Possimus et voluptates."], ["created_at", "2025-11-11 10:46:55.199144"], ["updated_at", "2025-11-11 10:46:55.199144"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (14.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Illo rerum esse. Ut aut occaecati. Animi aut eum."], ["created_at", "2025-11-11 10:46:55.228970"], ["updated_at", "2025-11-11 10:46:55.228970"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Karie Casper"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:55.459695"], ["updated_at", "2025-11-11 10:46:55.459695"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books?q=ruby" for 127.0.0.1 at 2025-11-11 10:46:55 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"ruby", "book"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 103], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 97]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 16ms (Views: 0.4ms | ActiveRecord: 3.1ms | Allocations: 1713)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Giuseppe Champlin"], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:46:55.875899"], ["updated_at", "2025-11-11 10:46:55.875899"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-11 10:46:55 +0000
Error occurred while parsing request parameters.
Contents:

book[title]=New+Book&book[author]=Author+Name&book[genre]=Genre&book[isbn]=9781234567890&book[total_copies]=3
Processing by BooksController#create as HTML
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 104], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 400 Bad Request in 6ms (ActiveRecord: 0.6ms | Allocations: 723)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/books_controller.rb:49:in `book_params'
app/controllers/books_controller.rb:20:in `create'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (9.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Alfonzo Simonis"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:57.195253"], ["updated_at", "2025-11-11 10:46:57.195253"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-11 10:46:57 +0000
Error occurred while parsing request parameters.
Contents:

book[title]=New+Book&book[author]=Author+Name&book[genre]=Genre&book[isbn]=9781234567890&book[total_copies]=3
Processing by BooksController#create as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 5ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 618)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Rozella Barrows"], ["genre", "Western"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Harum dolor in. Et dolorem numquam. Dolorum et odio."], ["created_at", "2025-11-11 10:46:57.381186"], ["updated_at", "2025-11-11 10:46:57.381186"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Noe Kovacek"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:46:57.598115"], ["updated_at", "2025-11-11 10:46:57.598115"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/99" for 127.0.0.1 at 2025-11-11 10:46:57 +0000
Error occurred while parsing request parameters.
Contents:

book[title]=Updated+Title
Processing by BooksController#update as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 400 Bad Request in 3ms (ActiveRecord: 0.4ms | Allocations: 667)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Lenita Schamberger"], ["genre", "Short story"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "Aspernatur repellat officia. Voluptas illo nihil. Vitae id rerum."], ["created_at", "2025-11-11 10:46:58.491947"], ["updated_at", "2025-11-11 10:46:58.491947"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Yi Collins"], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:58.740848"], ["updated_at", "2025-11-11 10:46:58.740848"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/100" for 127.0.0.1 at 2025-11-11 10:46:58 +0000
Error occurred while parsing request parameters.
Contents:

book[title]=Updated+Title
Processing by BooksController#update as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 7ms (Views: 0.4ms | ActiveRecord: 0.5ms | Allocations: 595)


  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Paths of Glory"], ["author", "Zoila Schuppe"], ["genre", "Short story"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Odit nam aut. Laudantium libero tempora. Quos vel accusantium."], ["created_at", "2025-11-11 10:46:58.941487"], ["updated_at", "2025-11-11 10:46:58.941487"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Manuela Stoltenberg"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:46:59.210710"], ["updated_at", "2025-11-11 10:46:59.210710"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/101" for 127.0.0.1 at 2025-11-11 10:46:59 +0000
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"101", "book"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 101]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBook Destroy (1.7ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 101]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 204 No Content in 43ms (ActiveRecord: 5.6ms | Allocations: 3387)


  [1m[36mBook Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Consider Phlebas"], ["author", "Rev. Melodi Herman"], ["genre", "Biography/Autobiography"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Aut consequuntur officiis. Rerum accusamus eaque. Dolorem harum dolorem."], ["created_at", "2025-11-11 10:46:59.449516"], ["updated_at", "2025-11-11 10:46:59.449516"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Miss Evette Balistreri"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:46:59.695218"], ["updated_at", "2025-11-11 10:46:59.695218"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/102" for 127.0.0.1 at 2025-11-11 10:46:59 +0000
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"102", "book"=>{}}
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 6ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 586)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (8.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Fr. Audra Schmidt"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:00.108214"], ["updated_at", "2025-11-11 10:47:00.108214"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (14.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Let Us Now Praise Famous Men"], ["author", "Cedric Moen"], ["genre", "Fiction in verse"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Quia aut nesciunt. Et saepe quisquam. Sint animi beatae."], ["created_at", "2025-11-11 10:47:00.146563"], ["updated_at", "2025-11-11 10:47:00.146563"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 103]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 110], ["book_id", 103], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 110], ["book_id", 103], ["borrowed_at", "2025-11-11 10:47:00.155560"], ["due_at", "2025-11-25 10:47:00.155655"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:00.171611"], ["updated_at", "2025-11-11 10:47:00.171611"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Chasity Heathcote"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:00.392745"], ["updated_at", "2025-11-11 10:47:00.392745"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "This Side of Paradise"], ["author", "Mira Steuber"], ["genre", "Narrative nonfiction"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "Sit sequi tempore. Dolor suscipit atque. Laborum amet aspernatur."], ["created_at", "2025-11-11 10:47:00.413121"], ["updated_at", "2025-11-11 10:47:00.413121"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 104]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 111], ["book_id", 104], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 111], ["book_id", 104], ["borrowed_at", "2025-11-11 10:47:00.421624"], ["due_at", "2025-11-25 10:47:00.421693"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:00.435280"], ["updated_at", "2025-11-11 10:47:00.435280"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-11 10:47:00 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 110]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 103]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 186ms (Views: 0.4ms | ActiveRecord: 1.7ms | Allocations: 5325)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Bill Thompson"], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:01.038848"], ["updated_at", "2025-11-11 10:47:01.038848"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Green Bay Tree"], ["author", "Shakita Reilly Jr."], ["genre", "Mystery"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "Eum rerum expedita. Sit saepe ut. Quo id expedita."], ["created_at", "2025-11-11 10:47:01.055933"], ["updated_at", "2025-11-11 10:47:01.055933"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 105]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 112], ["book_id", 105], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 112], ["book_id", 105], ["borrowed_at", "2025-11-11 10:47:01.063854"], ["due_at", "2025-11-25 10:47:01.063914"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:01.077056"], ["updated_at", "2025-11-11 10:47:01.077056"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ivory Gerlach DDS"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:01.308121"], ["updated_at", "2025-11-11 10:47:01.308121"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Wildfire at Midnight"], ["author", "Gov. Carolee Bode"], ["genre", "Legend"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Ab est aut. Reprehenderit sed excepturi. Autem laudantium totam."], ["created_at", "2025-11-11 10:47:01.327879"], ["updated_at", "2025-11-11 10:47:01.327879"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 106]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 113], ["book_id", 106], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 113], ["book_id", 106], ["borrowed_at", "2025-11-11 10:47:01.347162"], ["due_at", "2025-11-25 10:47:01.347234"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:01.362726"], ["updated_at", "2025-11-11 10:47:01.362726"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dr. Kennith Ritchie"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:01.593138"], ["updated_at", "2025-11-11 10:47:01.593138"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Create (1.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Now Sleeps the Crimson Petal"], ["author", "Kary Veum"], ["genre", "Biography/Autobiography"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "Deserunt magnam molestias. Consectetur ipsum nisi. Odit aut odio."], ["created_at", "2025-11-11 10:47:01.612987"], ["updated_at", "2025-11-11 10:47:01.612987"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 107]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 114], ["book_id", 107], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 114], ["book_id", 107], ["borrowed_at", "2025-11-11 10:47:01.622867"], ["due_at", "2025-11-25 10:47:01.622940"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:01.639334"], ["updated_at", "2025-11-11 10:47:01.639334"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tera Balistreri"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:47:01.845417"], ["updated_at", "2025-11-11 10:47:01.845417"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-11 10:47:01 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 115], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (1.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 107], ["id", 106], ["id", 105], ["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2, $3, $4)[0m  [["id", 114], ["id", 113], ["id", 112], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 21ms (Views: 0.4ms | ActiveRecord: 4.0ms | Allocations: 3522)


  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Of Mice and Men"], ["author", "Prof. Gidget Krajcik"], ["genre", "Classic"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "Voluptatem maxime nam. Aliquam quo non. Molestias eaque fugiat."], ["created_at", "2025-11-11 10:47:02.052602"], ["updated_at", "2025-11-11 10:47:02.052602"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (136.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tiffiny Okuneva"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:02.444020"], ["updated_at", "2025-11-11 10:47:02.444020"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 10:47:02 +0000
Error occurred while parsing request parameters.
Contents:

borrowing[book_id]=108
Processing by BorrowingsController#create as HTML
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 116], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 400 Bad Request in 5ms (ActiveRecord: 0.5ms | Allocations: 686)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/borrowings_controller.rb:55:in `borrowing_params'
app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "No Country for Old Men"], ["author", "Barry McDermott IV"], ["genre", "Historical fiction"], ["isbn", "978030000033"], ["total_copies", 1], ["description", "Possimus accusamus quis. Voluptate eaque asperiores. Fuga libero molestiae."], ["created_at", "2025-11-11 10:47:03.431736"], ["updated_at", "2025-11-11 10:47:03.431736"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (6.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Abe Yundt"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:03.659052"], ["updated_at", "2025-11-11 10:47:03.659052"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 109]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 117], ["book_id", 109], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 117], ["book_id", 109], ["borrowed_at", "2025-11-11 10:47:03.664379"], ["due_at", "2025-11-25 10:47:03.664420"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:03.675337"], ["updated_at", "2025-11-11 10:47:03.675337"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Enedina Hodkiewicz"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:03.886681"], ["updated_at", "2025-11-11 10:47:03.886681"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 10:47:03 +0000
Error occurred while parsing request parameters.
Contents:

borrowing[book_id]=109
Processing by BorrowingsController#create as HTML
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 118], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 400 Bad Request in 5ms (ActiveRecord: 0.7ms | Allocations: 672)


  
ActionDispatch::Http::Parameters::ParseError (Error occurred while parsing request parameters):
  
app/controllers/borrowings_controller.rb:55:in `borrowing_params'
app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "All Passion Spent"], ["author", "Mr. Davis Kshlerin"], ["genre", "Horror"], ["isbn", "978030000034"], ["total_copies", 2], ["description", "Nisi modi est. Ut enim autem. Dicta eveniet magni."], ["created_at", "2025-11-11 10:47:05.000718"], ["updated_at", "2025-11-11 10:47:05.000718"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Samuel Ward"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:47:05.237452"], ["updated_at", "2025-11-11 10:47:05.237452"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 10:47:05 +0000
Error occurred while parsing request parameters.
Contents:

borrowing[book_id]=110
Processing by BorrowingsController#create as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 119], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 586)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Create (1.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Arms and the Man"], ["author", "Sylvia Ortiz"], ["genre", "Classic"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Omnis consequatur dolores. Ut nihil et. Occaecati quo non."], ["created_at", "2025-11-11 10:47:05.439823"], ["updated_at", "2025-11-11 10:47:05.439823"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Pat Quigley"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:05.672663"], ["updated_at", "2025-11-11 10:47:05.672663"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 111]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 120], ["book_id", 111], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 120], ["book_id", 111], ["borrowed_at", "2025-11-11 10:47:05.681492"], ["due_at", "2025-11-25 10:47:05.681556"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:05.697662"], ["updated_at", "2025-11-11 10:47:05.697662"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Leland Senger I"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:47:05.943965"], ["updated_at", "2025-11-11 10:47:05.943965"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/72/return" for 127.0.0.1 at 2025-11-11 10:47:05 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"72", "borrowing"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 121], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 72], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (1.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (12.2ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-11 10:47:06.158499"], ["updated_at", "2025-11-11 10:47:06.159538"], ["id", 72]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (6.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 120], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 111], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 61ms (Views: 0.5ms | ActiveRecord: 22.5ms | Allocations: 4500)


  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 72], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (8.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Of Human Bondage"], ["author", "Chung Nicolas MD"], ["genre", "Mythology"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Sed hic natus. Odit repudiandae consequatur. Magni qui velit."], ["created_at", "2025-11-11 10:47:06.239799"], ["updated_at", "2025-11-11 10:47:06.239799"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (12.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Miesha Heaney"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:06.496745"], ["updated_at", "2025-11-11 10:47:06.496745"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 112]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 122], ["book_id", 112], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 122], ["book_id", 112], ["borrowed_at", "2025-11-11 10:47:06.511240"], ["due_at", "2025-11-25 10:47:06.511315"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:06.524575"], ["updated_at", "2025-11-11 10:47:06.524575"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Clifford Parker MD"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:47:06.746130"], ["updated_at", "2025-11-11 10:47:06.746130"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/73/return" for 127.0.0.1 at 2025-11-11 10:47:06 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"73", "borrowing"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 123], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (1.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 73], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (4.5ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-11 10:47:06.908644"], ["updated_at", "2025-11-11 10:47:06.909505"], ["id", 73]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 122], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 112], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 34ms (Views: 0.4ms | ActiveRecord: 9.4ms | Allocations: 3890)


Started PATCH "/borrowings/73/return" for 127.0.0.1 at 2025-11-11 10:47:06 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"73", "borrowing"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 123], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 73], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
Completed 422 Unprocessable Content in 9ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 1025)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dodie Heller DC"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:47:07.312164"], ["updated_at", "2025-11-11 10:47:07.312164"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Edris Glover"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:07.545015"], ["updated_at", "2025-11-11 10:47:07.545015"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Many-Splendoured Thing"], ["author", "Chance Wuckert"], ["genre", "Comic/Graphic Novel"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Quisquam voluptatem qui. Consequatur atque harum. Molestias qui iusto."], ["created_at", "2025-11-11 10:47:07.564730"], ["updated_at", "2025-11-11 10:47:07.564730"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Create (1.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Golden Apples of the Sun"], ["author", "Abdul Gibson"], ["genre", "Tall tale"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Ut distinctio sapiente. Dolorum et tempore. Illum enim nihil."], ["created_at", "2025-11-11 10:47:07.590208"], ["updated_at", "2025-11-11 10:47:07.590208"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 113]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 125], ["book_id", 113], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (2.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 125], ["book_id", 113], ["borrowed_at", "2025-11-11 10:47:07.601134"], ["due_at", "2025-11-25 10:47:07.601219"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:07.618641"], ["updated_at", "2025-11-11 10:47:07.618641"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 114]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 125], ["book_id", 114], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 125], ["book_id", 114], ["borrowed_at", "2025-10-21 10:47:07.630569"], ["due_at", "2025-11-04 10:47:07.630962"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:07.644815"], ["updated_at", "2025-11-11 10:47:07.644815"]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-11 10:47:07 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 124], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-11 00:00:00"], ["due_at", "2025-11-11 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (2.3ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:47:07.872020')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:47:08.052529')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
  [1m[36mBorrowing Count (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:47:08.058775')[0m  [["user_id", 125]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 200ms (Views: 0.7ms | ActiveRecord: 9.1ms | Allocations: 6515)


  [1m[36mBook Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (2.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Harriette McClure"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:47:08.307651"], ["updated_at", "2025-11-11 10:47:08.307651"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Waiting for the Barbarians"], ["author", "Herb Ryan"], ["genre", "Fairy tale"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Possimus debitis numquam. Sapiente numquam ut. Fugiat sit dicta."], ["created_at", "2025-11-11 10:47:08.329284"], ["updated_at", "2025-11-11 10:47:08.329284"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 115]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 126], ["book_id", 115], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 126], ["book_id", 115], ["borrowed_at", "2025-11-11 10:47:08.339812"], ["due_at", "2025-11-25 10:47:08.339897"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:08.352594"], ["updated_at", "2025-11-11 10:47:08.352594"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Daffodil Sky"], ["author", "Darren Auer"], ["genre", "Reference book"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Harum eligendi neque. Ea consequuntur qui. Cupiditate facilis est."], ["created_at", "2025-11-11 10:47:08.386726"], ["updated_at", "2025-11-11 10:47:08.386726"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 116]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 126], ["book_id", 116], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 126], ["book_id", 116], ["borrowed_at", "2025-10-21 10:47:08.560851"], ["due_at", "2025-11-04 10:47:08.561136"], ["returned_at", nil], ["created_at", "2025-11-11 10:47:08.576622"], ["updated_at", "2025-11-11 10:47:08.576622"]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-11 10:47:08 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 126], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 126]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (1.0ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 115], ["id", 116]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (1.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:47:08.785649')[0m  [["user_id", 126]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 116]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 35ms (Views: 0.5ms | ActiveRecord: 4.1ms | Allocations: 3539)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (79.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (69.6ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.8ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (15.8ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (12.1ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (9.8ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (8.0ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (9.6ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (15.7ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (6.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (9.0ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (16.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (6.9ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (4.0ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (3.4ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (13.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (7.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (2.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (12.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-11 10:50:12.474426', '2025-11-11 10:50:12.474431') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (3.9ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-11 10:50:12.485603' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (2.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-11 10:50:12.493633', '2025-11-11 10:50:12.493635') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (28.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Moab Is My Washpot"], ["author", "Jesus Ryan"], ["genre", "Mystery"], ["isbn", "12345"], ["total_copies", 2], ["description", "Est et sunt. Quam voluptates qui. Molestias aut maxime."], ["created_at", "2025-11-11 10:50:15.686116"], ["updated_at", "2025-11-11 10:50:15.686116"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Specimen Days"], ["author", "Daren Rohan"], ["genre", "Biography/Autobiography"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Laborum et ab. Veniam assumenda qui. A doloribus et."], ["created_at", "2025-11-11 10:50:15.740353"], ["updated_at", "2025-11-11 10:50:15.740353"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ernie Hand DVM"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:15.986337"], ["updated_at", "2025-11-11 10:50:15.986337"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 118]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 127], ["book_id", 118], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 127], ["book_id", 118], ["borrowed_at", "2025-11-11 10:50:16.013321"], ["due_at", "2025-11-25 10:50:16.013515"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:16.051235"], ["updated_at", "2025-11-11 10:50:16.051235"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "The Hon. Janina Schuster"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:16.252039"], ["updated_at", "2025-11-11 10:50:16.252039"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 118]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 128], ["book_id", 118], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 128], ["book_id", 118], ["borrowed_at", "2025-10-21 10:50:16.257715"], ["due_at", "2025-11-04 10:50:16.257871"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:16.266758"], ["updated_at", "2025-11-11 10:50:16.266758"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 118]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Rerum commodi exercitationem. Et aut itaque. Fuga ullam facilis."], ["created_at", "2025-11-11 10:50:16.310343"], ["updated_at", "2025-11-11 10:50:16.310343"]]
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Voluptatibus dolorum similique. Sit aut totam. Tempora dolores ut."], ["created_at", "2025-11-11 10:50:16.330235"], ["updated_at", "2025-11-11 10:50:16.330235"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 119], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 120], ["LIMIT", 1]]
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Time To Murder And Create"], ["author", "Alva Yost IV"], ["genre", "Western"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Occaecati aliquam consequatur. Et maiores quia. Quo cupiditate officia."], ["created_at", "2025-11-11 10:50:16.770032"], ["updated_at", "2025-11-11 10:50:16.770032"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sylvester Bernhard"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:16.960036"], ["updated_at", "2025-11-11 10:50:16.960036"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 121]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 129], ["book_id", 121], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 129], ["book_id", 121], ["borrowed_at", "2025-11-11 10:50:16.967365"], ["due_at", "2025-11-25 10:50:16.967417"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:16.974723"], ["updated_at", "2025-11-11 10:50:16.974723"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Russell Lemke"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:17.167339"], ["updated_at", "2025-11-11 10:50:17.167339"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 121]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 130], ["book_id", 121], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Karly Bartoletti Ret."], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:17.365840"], ["updated_at", "2025-11-11 10:50:17.365840"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "If I Forget Thee Jerusalem"], ["author", "Flora Weber"], ["genre", "Fairy tale"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Consequatur eveniet perspiciatis. Voluptatem ut totam. Asperiores maxime ipsa."], ["created_at", "2025-11-11 10:50:17.376429"], ["updated_at", "2025-11-11 10:50:17.376429"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 122]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 131], ["book_id", 122], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 131], ["book_id", 122], ["borrowed_at", "2025-11-11 10:50:17.384273"], ["due_at", "2025-11-25 10:50:17.384317"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:17.392148"], ["updated_at", "2025-11-11 10:50:17.392148"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 122]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 131], ["book_id", 122], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lelia Lesch"], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:17.590852"], ["updated_at", "2025-11-11 10:50:17.590852"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Wealth of Nations"], ["author", "Jene Williamson"], ["genre", "Realistic fiction"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "In perferendis est. Et dicta est. Sit qui saepe."], ["created_at", "2025-11-11 10:50:17.602643"], ["updated_at", "2025-11-11 10:50:17.602643"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 123]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 132], ["book_id", 123], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 132], ["book_id", 123], ["borrowed_at", "2025-11-11 10:50:17.607106"], ["due_at", "2025-11-25 10:50:17.607139"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:17.617172"], ["updated_at", "2025-11-11 10:50:17.617172"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mrs. Galina Tillman"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:17.799737"], ["updated_at", "2025-11-11 10:50:17.799737"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "That Hideous Strength"], ["author", "Tommie Schaden"], ["genre", "Fable"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Molestiae rerum harum. Esse inventore modi. Quia asperiores quisquam."], ["created_at", "2025-11-11 10:50:17.810840"], ["updated_at", "2025-11-11 10:50:17.810840"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 124]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 133], ["book_id", 124], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 133], ["book_id", 124], ["borrowed_at", "2025-11-11 10:50:17.819647"], ["due_at", "2025-11-25 10:50:17.819747"], ["returned_at", "2025-11-10 10:50:17.819938"], ["created_at", "2025-11-11 10:50:17.832791"], ["updated_at", "2025-11-11 10:50:17.832791"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dr. Tressie O'Conner"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:18.043914"], ["updated_at", "2025-11-11 10:50:18.043914"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Create (1.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Postern of Fate"], ["author", "Jayson Wiza"], ["genre", "Short story"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Neque tenetur iusto. Mollitia cum rerum. Iure quis facere."], ["created_at", "2025-11-11 10:50:18.061122"], ["updated_at", "2025-11-11 10:50:18.061122"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 125]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 134], ["book_id", 125], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 134], ["book_id", 125], ["borrowed_at", "2025-10-21 10:50:18.071063"], ["due_at", "2025-11-04 10:50:18.071203"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:18.079862"], ["updated_at", "2025-11-11 10:50:18.079862"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Houston Harber"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:18.275297"], ["updated_at", "2025-11-11 10:50:18.275297"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Stranger in a Strange Land"], ["author", "Msgr. Miguel Goyette"], ["genre", "Reference book"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Quisquam sequi nam. Similique velit laborum. Tempora animi praesentium."], ["created_at", "2025-11-11 10:50:18.292666"], ["updated_at", "2025-11-11 10:50:18.292666"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 126]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 135], ["book_id", 126], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 135], ["book_id", 126], ["borrowed_at", "2025-11-11 10:50:18.299789"], ["due_at", "2025-11-25 10:50:18.299849"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:18.311621"], ["updated_at", "2025-11-11 10:50:18.311621"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:18.319925') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 84], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:18.324667') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 85], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:18.324667')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Msgr. Lemuel Nikolaus"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:18.523979"], ["updated_at", "2025-11-11 10:50:18.523979"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Jacob Have I Loved"], ["author", "Caleb Hessel"], ["genre", "Fairy tale"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Libero et architecto. Asperiores error et. Dicta quia ut."], ["created_at", "2025-11-11 10:50:18.536647"], ["updated_at", "2025-11-11 10:50:18.536647"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 127]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 136], ["book_id", 127], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 136], ["book_id", 127], ["borrowed_at", "2025-11-11 10:50:18.542801"], ["due_at", "2025-11-25 10:50:18.542865"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:18.553349"], ["updated_at", "2025-11-11 10:50:18.553349"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (3.5ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 86]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kisha Lebsack"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:18.954445"], ["updated_at", "2025-11-11 10:50:18.954445"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Robbie Renner"], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:19.364947"], ["updated_at", "2025-11-11 10:50:19.364947"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (3.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 138], ["LIMIT", 1]]
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Earlene Streich"], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:19.602720"], ["updated_at", "2025-11-11 10:50:19.602720"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Nectar in a Sieve"], ["author", "Rep. Pamella Greenfelder"], ["genre", "Mythology"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Soluta tempora vitae. Magni et sint. Omnis voluptatibus quis."], ["created_at", "2025-11-11 10:50:19.616618"], ["updated_at", "2025-11-11 10:50:19.616618"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 128]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 139], ["book_id", 128], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 139], ["book_id", 128], ["borrowed_at", "2025-11-11 10:50:19.621481"], ["due_at", "2025-11-25 10:50:19.621518"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:19.628220"], ["updated_at", "2025-11-11 10:50:19.628220"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Cricket on the Hearth"], ["author", "Ms. Lonny Emmerich"], ["genre", "Fantasy"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Est expedita architecto. Odio adipisci consequatur. Sapiente sed rerum."], ["created_at", "2025-11-11 10:50:19.639895"], ["updated_at", "2025-11-11 10:50:19.639895"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 129]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 139], ["book_id", 129], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 139], ["book_id", 129], ["borrowed_at", "2025-11-11 10:50:19.647185"], ["due_at", "2025-11-25 10:50:19.647280"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:19.653940"], ["updated_at", "2025-11-11 10:50:19.653940"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 139]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Maryetta Trantow III"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:19.848906"], ["updated_at", "2025-11-11 10:50:19.848906"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Caridad Mills MD"], ["genre", "Suspense/Thriller"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Et repudiandae eveniet. Distinctio eum itaque. Atque facilis et."], ["created_at", "2025-11-11 10:50:19.865429"], ["updated_at", "2025-11-11 10:50:19.865429"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 130]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 140], ["book_id", 130], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 140], ["book_id", 130], ["borrowed_at", "2025-11-11 10:50:19.868747"], ["due_at", "2025-11-25 10:50:19.868772"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:19.875070"], ["updated_at", "2025-11-11 10:50:19.875070"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Dying of the Light"], ["author", "Lala Stamm"], ["genre", "Tall tale"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Quisquam quia sit. Velit repellat amet. Soluta voluptatibus enim."], ["created_at", "2025-11-11 10:50:19.886572"], ["updated_at", "2025-11-11 10:50:19.886572"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 131]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 140], ["book_id", 131], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 140], ["book_id", 131], ["borrowed_at", "2025-10-21 10:50:19.891616"], ["due_at", "2025-11-04 10:50:19.891765"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:19.900139"], ["updated_at", "2025-11-11 10:50:19.900139"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:19.904658')[0m  [["user_id", 140]]
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:19.907453') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 140], ["id", 89], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:19.907453')[0m  [["user_id", 140]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-11 10:50:19 +0000
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "auth"=>{"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "sam@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sam Reader"], ["email", "sam@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:20.298844"], ["updated_at", "2025-11-11 10:50:20.298844"]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 201 Created in 224ms (Views: 0.3ms | ActiveRecord: 5.1ms | Allocations: 5184)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-11 10:50:20 +0000
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"email"=>""}, "auth"=>{"user"=>{"email"=>""}}}
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", ""], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 422 Unprocessable Content in 23ms (Views: 0.3ms | ActiveRecord: 4.0ms | Allocations: 3358)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Harland Stracke"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:20.649525"], ["updated_at", "2025-11-11 10:50:20.649525"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-11 10:50:20 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 177ms (Views: 0.3ms | ActiveRecord: 0.2ms | Allocations: 826)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Nestor Feil"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:21.112158"], ["updated_at", "2025-11-11 10:50:21.112158"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-11 10:50:21 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 401 Unauthorized in 178ms (Views: 0.3ms | ActiveRecord: 0.5ms | Allocations: 580)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Dolorum sit dolor. Deserunt iusto porro. Ut qui cupiditate."], ["created_at", "2025-11-11 10:50:21.399610"], ["updated_at", "2025-11-11 10:50:21.399610"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "Enim est aut. Nisi est qui. Sit est consectetur."], ["created_at", "2025-11-11 10:50:21.411764"], ["updated_at", "2025-11-11 10:50:21.411764"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jarred Paucek"], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:21.599513"], ["updated_at", "2025-11-11 10:50:21.599513"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books" for 127.0.0.1 at 2025-11-11 10:50:21 +0000
Processing by BooksController#index as HTML
  Parameters: {"book"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 144], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 132]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 133]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 31ms (Views: 0.3ms | ActiveRecord: 4.4ms | Allocations: 6030)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Consequatur dicta inventore. Unde alias error. Dolorem quia ea."], ["created_at", "2025-11-11 10:50:21.751098"], ["updated_at", "2025-11-11 10:50:21.751098"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Quos velit sit. Non dolore cupiditate. Illum id sed."], ["created_at", "2025-11-11 10:50:21.762885"], ["updated_at", "2025-11-11 10:50:21.762885"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Georgianna Breitenberg"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:21.943854"], ["updated_at", "2025-11-11 10:50:21.943854"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books?q=ruby" for 127.0.0.1 at 2025-11-11 10:50:21 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"ruby", "book"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 145], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 134]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 1712)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Laverne Mohr"], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:22.244958"], ["updated_at", "2025-11-11 10:50:22.244958"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-11 10:50:22 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 146], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "New Book"], ["author", "Author Name"], ["genre", "Genre"], ["isbn", "9781234567890"], ["total_copies", 3], ["description", nil], ["created_at", "2025-11-11 10:50:22.373233"], ["updated_at", "2025-11-11 10:50:22.373233"]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 136]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 201 Created in 20ms (Views: 0.2ms | ActiveRecord: 6.6ms | Allocations: 3638)


  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rev. Kisha Wehner"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:22.567804"], ["updated_at", "2025-11-11 10:50:22.567804"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-11 10:50:22 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 147], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 4ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 607)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Dominic Corkery"], ["genre", "Science fiction"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Quis voluptas magnam. Sint quia ipsum. Consequatur tempora facilis."], ["created_at", "2025-11-11 10:50:22.673372"], ["updated_at", "2025-11-11 10:50:22.673372"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Leslie Yundt DVM"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:22.857737"], ["updated_at", "2025-11-11 10:50:22.857737"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/137" for 127.0.0.1 at 2025-11-11 10:50:22 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"137"}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 148], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 137], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBook Update (0.4ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Updated Title"], ["updated_at", "2025-11-11 10:50:22.971225"], ["id", 137]]
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 137]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 24ms (Views: 0.2ms | ActiveRecord: 9.1ms | Allocations: 3874)


  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Hai Cummerata"], ["genre", "Narrative nonfiction"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "Voluptate mollitia cum. Nulla est est. Tempore aut omnis."], ["created_at", "2025-11-11 10:50:23.002485"], ["updated_at", "2025-11-11 10:50:23.002485"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "So Schmidt"], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:23.187065"], ["updated_at", "2025-11-11 10:50:23.187065"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/138" for 127.0.0.1 at 2025-11-11 10:50:23 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"138"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 149], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 5ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 585)


  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (6.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Wildfire at Midnight"], ["author", "Gov. Glenn Gibson"], ["genre", "Essay"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Quis iste voluptatem. Soluta quae nisi. Pariatur corporis cum."], ["created_at", "2025-11-11 10:50:23.309741"], ["updated_at", "2025-11-11 10:50:23.309741"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Vickey Weissnat"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:23.501793"], ["updated_at", "2025-11-11 10:50:23.501793"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/139" for 127.0.0.1 at 2025-11-11 10:50:23 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"139", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 150], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 139], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 139]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBook Destroy (0.7ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 139]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 204 No Content in 15ms (ActiveRecord: 2.3ms | Allocations: 3263)


  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "An Acceptable Time"], ["author", "Harry Bartoletti"], ["genre", "Mystery"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Reprehenderit quisquam quo. Est hic deleniti. Iusto dignissimos esse."], ["created_at", "2025-11-11 10:50:23.626254"], ["updated_at", "2025-11-11 10:50:23.626254"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Roberta Moore"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:23.809884"], ["updated_at", "2025-11-11 10:50:23.809884"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/140" for 127.0.0.1 at 2025-11-11 10:50:23 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"140", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 151], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 585)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Leland Johnson"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:24.102979"], ["updated_at", "2025-11-11 10:50:24.102979"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "In Dubious Battle"], ["author", "Normand Ledner Sr."], ["genre", "Science fiction"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Sunt quidem non. Quia corporis natus. Eos repudiandae eum."], ["created_at", "2025-11-11 10:50:24.113933"], ["updated_at", "2025-11-11 10:50:24.113933"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 141]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 152], ["book_id", 141], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 152], ["book_id", 141], ["borrowed_at", "2025-11-11 10:50:24.122409"], ["due_at", "2025-11-25 10:50:24.122453"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:24.132173"], ["updated_at", "2025-11-11 10:50:24.132173"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Chance Trantow"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:24.328669"], ["updated_at", "2025-11-11 10:50:24.328669"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Mother Night"], ["author", "Nicolas Purdy Ret."], ["genre", "Horror"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "At hic atque. Maiores commodi autem. Nihil quae ratione."], ["created_at", "2025-11-11 10:50:24.346728"], ["updated_at", "2025-11-11 10:50:24.346728"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 142]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 153], ["book_id", 142], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 153], ["book_id", 142], ["borrowed_at", "2025-11-11 10:50:24.350850"], ["due_at", "2025-11-25 10:50:24.350885"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:24.360737"], ["updated_at", "2025-11-11 10:50:24.360737"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-11 10:50:24 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 152], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 152]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 141]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 3410)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ty Swaniawski"], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:24.728965"], ["updated_at", "2025-11-11 10:50:24.728965"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Create (1.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Look to Windward"], ["author", "Halina Nitzsche"], ["genre", "Textbook"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "Cumque sit asperiores. Molestiae aut excepturi. Optio tempora esse."], ["created_at", "2025-11-11 10:50:24.739032"], ["updated_at", "2025-11-11 10:50:24.739032"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 143]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 154], ["book_id", 143], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 154], ["book_id", 143], ["borrowed_at", "2025-11-11 10:50:24.745028"], ["due_at", "2025-11-25 10:50:24.745126"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:24.752566"], ["updated_at", "2025-11-11 10:50:24.752566"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dr. Pearl Schinner"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:24.942864"], ["updated_at", "2025-11-11 10:50:24.942864"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Stranger in a Strange Land"], ["author", "Hermila Tillman IV"], ["genre", "Fable"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Earum blanditiis esse. Optio quod atque. Provident porro non."], ["created_at", "2025-11-11 10:50:24.956583"], ["updated_at", "2025-11-11 10:50:24.956583"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 144]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 155], ["book_id", 144], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 155], ["book_id", 144], ["borrowed_at", "2025-11-11 10:50:24.961513"], ["due_at", "2025-11-25 10:50:24.961573"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:24.969231"], ["updated_at", "2025-11-11 10:50:24.969231"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Miss Jude Sawayn"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:25.148451"], ["updated_at", "2025-11-11 10:50:25.148451"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "It's a Battlefield"], ["author", "Lesley VonRueden"], ["genre", "Fairy tale"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "Nihil dicta dolor. Excepturi sit a. Doloribus rerum et."], ["created_at", "2025-11-11 10:50:25.164055"], ["updated_at", "2025-11-11 10:50:25.164055"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 145]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 156], ["book_id", 145], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 156], ["book_id", 145], ["borrowed_at", "2025-11-11 10:50:25.169917"], ["due_at", "2025-11-25 10:50:25.169960"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:25.177554"], ["updated_at", "2025-11-11 10:50:25.177554"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Brigid Muller"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:25.359762"], ["updated_at", "2025-11-11 10:50:25.359762"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-11 10:50:25 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 157], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 145], ["id", 144], ["id", 143], ["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2, $3, $4)[0m  [["id", 156], ["id", 155], ["id", 154], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 3521)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Antic Hay"], ["author", "Terrence Dach"], ["genre", "Comic/Graphic Novel"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "Quisquam incidunt rerum. Deserunt optio rerum. Pariatur illum ipsum."], ["created_at", "2025-11-11 10:50:25.489072"], ["updated_at", "2025-11-11 10:50:25.489072"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Priscila Mayert"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:25.676358"], ["updated_at", "2025-11-11 10:50:25.676358"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 10:50:25 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>146}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 158], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 146], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 146]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 158], ["book_id", 146], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 158], ["book_id", 146], ["borrowed_at", "2025-11-11 10:50:25.777517"], ["due_at", "2025-11-25 10:50:25.777633"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:25.786443"], ["updated_at", "2025-11-11 10:50:25.786443"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 20ms (Views: 0.2ms | ActiveRecord: 5.1ms | Allocations: 4060)


  [1m[36mBorrowing Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "To Your Scattered Bodies Go"], ["author", "Marx Waelchi"], ["genre", "Crime/Detective"], ["isbn", "978030000033"], ["total_copies", 1], ["description", "Aut laudantium est. Voluptatem dolorum sunt. Et perspiciatis enim."], ["created_at", "2025-11-11 10:50:25.808912"], ["updated_at", "2025-11-11 10:50:25.808912"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Arlie Prohaska DVM"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:26.000599"], ["updated_at", "2025-11-11 10:50:26.000599"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 147]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 159], ["book_id", 147], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 159], ["book_id", 147], ["borrowed_at", "2025-11-11 10:50:26.006923"], ["due_at", "2025-11-25 10:50:26.006984"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:26.016749"], ["updated_at", "2025-11-11 10:50:26.016749"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lincoln Nienow"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:26.209672"], ["updated_at", "2025-11-11 10:50:26.209672"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 10:50:26 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>147}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 160], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 147], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 147]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 160], ["book_id", 147], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 12ms (Views: 0.2ms | ActiveRecord: 3.0ms | Allocations: 3545)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "An Instant In The Wind"], ["author", "Leeanne Lind"], ["genre", "Tall tale"], ["isbn", "978030000034"], ["total_copies", 2], ["description", "Est dolorem totam. Sit asperiores magnam. Rerum maiores adipisci."], ["created_at", "2025-11-11 10:50:26.318832"], ["updated_at", "2025-11-11 10:50:26.318832"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Misti Lebsack"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:26.530912"], ["updated_at", "2025-11-11 10:50:26.530912"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 10:50:26 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>148}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 161], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 577)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Glass of Blessings"], ["author", "Elisha Okuneva"], ["genre", "Biography/Autobiography"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Adipisci eius et. Voluptatem ea velit. Nemo labore quia."], ["created_at", "2025-11-11 10:50:26.645765"], ["updated_at", "2025-11-11 10:50:26.645765"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gov. Gayle Legros"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:26.830245"], ["updated_at", "2025-11-11 10:50:26.830245"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 149]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 162], ["book_id", 149], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 162], ["book_id", 149], ["borrowed_at", "2025-11-11 10:50:26.835269"], ["due_at", "2025-11-25 10:50:26.835340"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:26.842562"], ["updated_at", "2025-11-11 10:50:26.842562"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Theron Borer"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:27.027891"], ["updated_at", "2025-11-11 10:50:27.027891"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/98/return" for 127.0.0.1 at 2025-11-11 10:50:27 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"98", "borrowing"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 163], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 98], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (3.2ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-11 10:50:27.136408"], ["updated_at", "2025-11-11 10:50:27.137041"], ["id", 98]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 162], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 149], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 27ms (Views: 0.3ms | ActiveRecord: 5.8ms | Allocations: 4496)


  [1m[36mBorrowing Load (1.0ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "O Jerusalem!"], ["author", "Fr. Mervin Dickens"], ["genre", "Metafiction"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Culpa sint incidunt. Omnis vitae ut. Sunt aliquam ut."], ["created_at", "2025-11-11 10:50:27.182490"], ["updated_at", "2025-11-11 10:50:27.182490"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Darwin Doyle"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:27.375227"], ["updated_at", "2025-11-11 10:50:27.375227"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 150]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 164], ["book_id", 150], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 164], ["book_id", 150], ["borrowed_at", "2025-11-11 10:50:27.384200"], ["due_at", "2025-11-25 10:50:27.384300"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:27.394524"], ["updated_at", "2025-11-11 10:50:27.394524"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Teisha Rowe"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:27.581671"], ["updated_at", "2025-11-11 10:50:27.581671"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/99/return" for 127.0.0.1 at 2025-11-11 10:50:27 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"99", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 165], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 99], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (1.9ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-11 10:50:27.687931"], ["updated_at", "2025-11-11 10:50:27.688394"], ["id", 99]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 164], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 150], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 16ms (Views: 0.2ms | ActiveRecord: 3.6ms | Allocations: 3889)


Started PATCH "/borrowings/99/return" for 127.0.0.1 at 2025-11-11 10:50:27 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"99", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 165], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 99], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
Completed 422 Unprocessable Content in 6ms (Views: 0.3ms | ActiveRecord: 0.7ms | Allocations: 1025)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dante Langworth"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 10:50:27.984045"], ["updated_at", "2025-11-11 10:50:27.984045"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Xuan Cole"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:28.172971"], ["updated_at", "2025-11-11 10:50:28.172971"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "As I Lay Dying"], ["author", "Blair King"], ["genre", "Western"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Voluptatem fuga et. Doloribus architecto rerum. Id qui ut."], ["created_at", "2025-11-11 10:50:28.184592"], ["updated_at", "2025-11-11 10:50:28.184592"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Look to Windward"], ["author", "Keneth Mann"], ["genre", "Metafiction"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Vel quis minus. Illum vitae qui. Non ut saepe."], ["created_at", "2025-11-11 10:50:28.195396"], ["updated_at", "2025-11-11 10:50:28.195396"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 151]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 167], ["book_id", 151], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 167], ["book_id", 151], ["borrowed_at", "2025-11-11 10:50:28.201940"], ["due_at", "2025-11-25 10:50:28.202032"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:28.211610"], ["updated_at", "2025-11-11 10:50:28.211610"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 152]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 167], ["book_id", 152], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 167], ["book_id", 152], ["borrowed_at", "2025-10-21 10:50:28.217126"], ["due_at", "2025-11-04 10:50:28.217253"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:28.224663"], ["updated_at", "2025-11-11 10:50:28.224663"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-11 10:50:28 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 166], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-11 00:00:00"], ["due_at", "2025-11-11 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:28.340991')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:28.376049')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:28.379427')[0m  [["user_id", 167]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 45ms (Views: 0.2ms | ActiveRecord: 4.8ms | Allocations: 5104)


  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mr. Julie Sporer"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 10:50:28.568857"], ["updated_at", "2025-11-11 10:50:28.568857"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fame Is the Spur"], ["author", "Katrina Romaguera"], ["genre", "Narrative nonfiction"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Dolores voluptates molestias. Qui aliquam vel. Omnis excepturi tenetur."], ["created_at", "2025-11-11 10:50:28.578182"], ["updated_at", "2025-11-11 10:50:28.578182"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 153]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 168], ["book_id", 153], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 168], ["book_id", 153], ["borrowed_at", "2025-11-11 10:50:28.582737"], ["due_at", "2025-11-25 10:50:28.582785"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:28.590531"], ["updated_at", "2025-11-11 10:50:28.590531"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (9.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "In a Glass Darkly"], ["author", "Johnnie Kassulke Ret."], ["genre", "Classic"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Qui ea amet. Ut officiis debitis. Provident similique natus."], ["created_at", "2025-11-11 10:50:28.609499"], ["updated_at", "2025-11-11 10:50:28.609499"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 154]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 168], ["book_id", 154], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 168], ["book_id", 154], ["borrowed_at", "2025-10-21 10:50:28.615735"], ["due_at", "2025-11-04 10:50:28.615909"], ["returned_at", nil], ["created_at", "2025-11-11 10:50:28.625129"], ["updated_at", "2025-11-11 10:50:28.625129"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-11 10:50:28 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 168], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 168]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 153], ["id", 154]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 10:50:28.744397')[0m  [["user_id", 168]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 154]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 3543)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Load (2.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (3.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (72.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (188.3ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.8ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (18.5ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (8.4ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (7.0ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (7.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.4ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (8.6ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (12.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (7.0ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (9.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (8.3ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (3.0ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (12.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (2.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (3.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (13.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (2.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-11 12:47:26.590453', '2025-11-11 12:47:26.590458') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (5.4ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-11 12:47:26.602598' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (3.9ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-11 12:47:26.682508', '2025-11-11 12:47:26.682512') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (31.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Create (2.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "In a Glass Darkly"], ["author", "Man Waelchi"], ["genre", "Speech"], ["isbn", "12345"], ["total_copies", 2], ["description", "Vel ipsam et. Rem dignissimos vel. Suscipit vel harum."], ["created_at", "2025-11-11 12:47:33.756296"], ["updated_at", "2025-11-11 12:47:33.756296"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Tirra Lirra by the River"], ["author", "Dane Schoen"], ["genre", "Textbook"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Deserunt sit eveniet. Qui aspernatur exercitationem. Voluptate dignissimos et."], ["created_at", "2025-11-11 12:47:33.835252"], ["updated_at", "2025-11-11 12:47:33.835252"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sen. Marion Hilpert"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:34.054763"], ["updated_at", "2025-11-11 12:47:34.054763"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (5.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 156]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 169], ["book_id", 156], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (3.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 169], ["book_id", 156], ["borrowed_at", "2025-11-11 12:47:34.120872"], ["due_at", "2025-11-25 12:47:34.121444"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:34.215275"], ["updated_at", "2025-11-11 12:47:34.215275"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Randell Fay"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:34.410185"], ["updated_at", "2025-11-11 12:47:34.410185"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 156]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 170], ["book_id", 156], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 170], ["book_id", 156], ["borrowed_at", "2025-10-21 12:47:34.417626"], ["due_at", "2025-11-04 12:47:34.417830"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:34.427244"], ["updated_at", "2025-11-11 12:47:34.427244"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 156]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Ab molestias nihil. Numquam repellat fugiat. Veniam id at."], ["created_at", "2025-11-11 12:47:34.461052"], ["updated_at", "2025-11-11 12:47:34.461052"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Create (6.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Harum magni voluptatem. Tempora deleniti qui. Libero tempore vel."], ["created_at", "2025-11-11 12:47:34.486323"], ["updated_at", "2025-11-11 12:47:34.486323"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 157], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 158], ["LIMIT", 1]]
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Noli Me Tangere"], ["author", "Ruthe Bosco"], ["genre", "Narrative nonfiction"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Ipsum id tempora. Non qui et. Earum amet alias."], ["created_at", "2025-11-11 12:47:34.899508"], ["updated_at", "2025-11-11 12:47:34.899508"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Franklyn Johns"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:35.086818"], ["updated_at", "2025-11-11 12:47:35.086818"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 159]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 171], ["book_id", 159], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 171], ["book_id", 159], ["borrowed_at", "2025-11-11 12:47:35.092192"], ["due_at", "2025-11-25 12:47:35.092232"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:35.103734"], ["updated_at", "2025-11-11 12:47:35.103734"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gertrude Brekke"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:35.293910"], ["updated_at", "2025-11-11 12:47:35.293910"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 159]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 172], ["book_id", 159], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Frederic Abernathy"], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:35.496002"], ["updated_at", "2025-11-11 12:47:35.496002"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Create (1.1ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Far-Distant Oxus"], ["author", "Renate Nolan"], ["genre", "Short story"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Esse suscipit aliquid. Qui quia et. Et ex consequatur."], ["created_at", "2025-11-11 12:47:35.510062"], ["updated_at", "2025-11-11 12:47:35.510062"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 160]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 173], ["book_id", 160], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 173], ["book_id", 160], ["borrowed_at", "2025-11-11 12:47:35.518207"], ["due_at", "2025-11-25 12:47:35.518257"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:35.526763"], ["updated_at", "2025-11-11 12:47:35.526763"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 160]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 173], ["book_id", 160], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kenneth Walter"], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:35.741482"], ["updated_at", "2025-11-11 12:47:35.741482"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Alone on a Wide, Wide Sea"], ["author", "Jacob Klein"], ["genre", "Folklore"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "Nihil atque quasi. Libero eius officiis. Ut qui facere."], ["created_at", "2025-11-11 12:47:35.754627"], ["updated_at", "2025-11-11 12:47:35.754627"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 161]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 174], ["book_id", 161], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 174], ["book_id", 161], ["borrowed_at", "2025-11-11 12:47:35.760019"], ["due_at", "2025-11-25 12:47:35.760063"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:35.769441"], ["updated_at", "2025-11-11 12:47:35.769441"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Angel Grimes"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:35.955292"], ["updated_at", "2025-11-11 12:47:35.955292"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Waiting for the Barbarians"], ["author", "Darwin Cummerata"], ["genre", "Essay"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Dignissimos non ipsum. Dolores totam facilis. Dolor atque mollitia."], ["created_at", "2025-11-11 12:47:35.968476"], ["updated_at", "2025-11-11 12:47:35.968476"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 162]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 175], ["book_id", 162], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 175], ["book_id", 162], ["borrowed_at", "2025-11-11 12:47:35.973758"], ["due_at", "2025-11-25 12:47:35.973807"], ["returned_at", "2025-11-10 12:47:35.973910"], ["created_at", "2025-11-11 12:47:35.982682"], ["updated_at", "2025-11-11 12:47:35.982682"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Melba Romaguera"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:36.180327"], ["updated_at", "2025-11-11 12:47:36.180327"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Frequent Hearses"], ["author", "Everett Green"], ["genre", "Mythology"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Culpa voluptatum quia. Blanditiis dolor occaecati. Fugit eveniet ut."], ["created_at", "2025-11-11 12:47:36.192303"], ["updated_at", "2025-11-11 12:47:36.192303"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 163]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 176], ["book_id", 163], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 176], ["book_id", 163], ["borrowed_at", "2025-10-21 12:47:36.201656"], ["due_at", "2025-11-04 12:47:36.201810"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:36.209760"], ["updated_at", "2025-11-11 12:47:36.209760"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Virgil Hintz"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:36.395169"], ["updated_at", "2025-11-11 12:47:36.395169"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fame Is the Spur"], ["author", "Arturo Swift"], ["genre", "Humor"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Dolor nihil et. Nobis veritatis non. Deserunt perspiciatis sunt."], ["created_at", "2025-11-11 12:47:36.409240"], ["updated_at", "2025-11-11 12:47:36.409240"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 164]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 177], ["book_id", 164], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 177], ["book_id", 164], ["borrowed_at", "2025-11-11 12:47:36.416038"], ["due_at", "2025-11-25 12:47:36.416088"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:36.424515"], ["updated_at", "2025-11-11 12:47:36.424515"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:36.430522') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:36.434060') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 111], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:36.434060')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Angeles Satterfield"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:36.621775"], ["updated_at", "2025-11-11 12:47:36.621775"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "An Instant In The Wind"], ["author", "Elda Durgan"], ["genre", "Reference book"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Qui sunt consequatur. Ut nesciunt est. Harum et sit."], ["created_at", "2025-11-11 12:47:36.634790"], ["updated_at", "2025-11-11 12:47:36.634790"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 165]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 178], ["book_id", 165], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 178], ["book_id", 165], ["borrowed_at", "2025-11-11 12:47:36.639149"], ["due_at", "2025-11-25 12:47:36.639178"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:36.649310"], ["updated_at", "2025-11-11 12:47:36.649310"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (3.3ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 112]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Shin Predovic"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:37.052764"], ["updated_at", "2025-11-11 12:47:37.052764"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (1.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dr. Carl Carter"], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:37.522146"], ["updated_at", "2025-11-11 12:47:37.522146"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 180], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Keva Powlowski"], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:37.715241"], ["updated_at", "2025-11-11 12:47:37.715241"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Number the Stars"], ["author", "Jude Sauer"], ["genre", "Short story"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Quis dignissimos eos. Quia porro nisi. Consequatur perspiciatis sit."], ["created_at", "2025-11-11 12:47:37.723662"], ["updated_at", "2025-11-11 12:47:37.723662"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 166]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 181], ["book_id", 166], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 181], ["book_id", 166], ["borrowed_at", "2025-11-11 12:47:37.728326"], ["due_at", "2025-11-25 12:47:37.728383"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:37.736085"], ["updated_at", "2025-11-11 12:47:37.736085"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Sun Also Rises"], ["author", "Lynn Schimmel"], ["genre", "Mythology"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Debitis commodi est. Corrupti facilis non. Quo amet ab."], ["created_at", "2025-11-11 12:47:37.744384"], ["updated_at", "2025-11-11 12:47:37.744384"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 167]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 181], ["book_id", 167], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.9ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 181], ["book_id", 167], ["borrowed_at", "2025-11-11 12:47:37.749169"], ["due_at", "2025-11-25 12:47:37.749207"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:37.756165"], ["updated_at", "2025-11-11 12:47:37.756165"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 181]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Walter Welch CPA"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:37.946249"], ["updated_at", "2025-11-11 12:47:37.946249"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (10.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Everything is Illuminated"], ["author", "Msgr. Lezlie Ebert"], ["genre", "Tall tale"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Ea corrupti doloremque. Veniam occaecati itaque. Minus doloremque temporibus."], ["created_at", "2025-11-11 12:47:37.968171"], ["updated_at", "2025-11-11 12:47:37.968171"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 168]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 182], ["book_id", 168], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 182], ["book_id", 168], ["borrowed_at", "2025-11-11 12:47:37.974132"], ["due_at", "2025-11-25 12:47:37.974197"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:37.986120"], ["updated_at", "2025-11-11 12:47:37.986120"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Vile Bodies"], ["author", "Corliss Stehr"], ["genre", "Fiction in verse"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Nostrum neque quia. Illum aut quo. Natus recusandae id."], ["created_at", "2025-11-11 12:47:37.996201"], ["updated_at", "2025-11-11 12:47:37.996201"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 169]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 182], ["book_id", 169], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 182], ["book_id", 169], ["borrowed_at", "2025-10-21 12:47:38.000749"], ["due_at", "2025-11-04 12:47:38.000853"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:38.007128"], ["updated_at", "2025-11-11 12:47:38.007128"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (0.9ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:38.012614')[0m  [["user_id", 182]]
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:38.017539') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 182], ["id", 115], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.0ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:38.017539')[0m  [["user_id", 182]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-11 12:47:38 +0000
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "auth"=>{"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "sam@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sam Reader"], ["email", "sam@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:38.576689"], ["updated_at", "2025-11-11 12:47:38.576689"]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 201 Created in 290ms (Views: 0.2ms | ActiveRecord: 3.2ms | Allocations: 5184)


  [1m[36mTRANSACTION (0.9ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-11 12:47:38 +0000
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"email"=>""}, "auth"=>{"user"=>{"email"=>""}}}
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", ""], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 3.1ms | Allocations: 3337)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Felisa Okuneva"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:38.947012"], ["updated_at", "2025-11-11 12:47:38.947012"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-11 12:47:38 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 183ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 827)


  [1m[36mTRANSACTION (1.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gwenda Crona"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:39.438370"], ["updated_at", "2025-11-11 12:47:39.438370"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-11 12:47:39 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 401 Unauthorized in 182ms (Views: 0.3ms | ActiveRecord: 0.6ms | Allocations: 580)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Enim aliquid eos. Similique in atque. Quod eveniet voluptatem."], ["created_at", "2025-11-11 12:47:39.732359"], ["updated_at", "2025-11-11 12:47:39.732359"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "In corporis corrupti. Commodi qui aut. Itaque dolorem nisi."], ["created_at", "2025-11-11 12:47:39.743523"], ["updated_at", "2025-11-11 12:47:39.743523"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (7.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "James Mante Sr."], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:39.934375"], ["updated_at", "2025-11-11 12:47:39.934375"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books" for 127.0.0.1 at 2025-11-11 12:47:39 +0000
Processing by BooksController#index as HTML
  Parameters: {"book"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 186], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 170]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 171]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 33ms (Views: 0.5ms | ActiveRecord: 6.1ms | Allocations: 6029)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Voluptatibus unde sit. Quis a quia. Molestiae impedit non."], ["created_at", "2025-11-11 12:47:40.148275"], ["updated_at", "2025-11-11 12:47:40.148275"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (12.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Quos molestiae excepturi. Deleniti saepe accusamus. Velit aut atque."], ["created_at", "2025-11-11 12:47:40.172302"], ["updated_at", "2025-11-11 12:47:40.172302"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ila Grady III"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:40.358770"], ["updated_at", "2025-11-11 12:47:40.358770"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books?q=ruby" for 127.0.0.1 at 2025-11-11 12:47:40 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"ruby", "book"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 187], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 172]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1713)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Amb. Jewell Green"], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:40.683254"], ["updated_at", "2025-11-11 12:47:40.683254"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-11 12:47:40 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 188], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "New Book"], ["author", "Author Name"], ["genre", "Genre"], ["isbn", "9781234567890"], ["total_copies", 3], ["description", nil], ["created_at", "2025-11-11 12:47:40.791701"], ["updated_at", "2025-11-11 12:47:40.791701"]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 174]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 201 Created in 18ms (Views: 0.2ms | ActiveRecord: 4.9ms | Allocations: 3638)


  [1m[36mBook Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Marcelino Satterfield"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:40.989398"], ["updated_at", "2025-11-11 12:47:40.989398"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-11 12:47:40 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 189], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 4ms (Views: 0.2ms | ActiveRecord: 0.5ms | Allocations: 606)


  [1m[36mTRANSACTION (0.7ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Gwyn Volkman"], ["genre", "Speech"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Aspernatur architecto soluta. Accusamus et et. Omnis quos vero."], ["created_at", "2025-11-11 12:47:41.107914"], ["updated_at", "2025-11-11 12:47:41.107914"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sen. Marjorie Klein"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:41.321493"], ["updated_at", "2025-11-11 12:47:41.321493"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/175" for 127.0.0.1 at 2025-11-11 12:47:41 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"175"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 190], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 175], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Updated Title"], ["updated_at", "2025-11-11 12:47:41.440577"], ["id", 175]]
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 175]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 6.5ms | Allocations: 3875)


  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 175], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Claris Mills"], ["genre", "Suspense/Thriller"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "Neque id et. Laboriosam provident alias. A omnis consequatur."], ["created_at", "2025-11-11 12:47:41.463522"], ["updated_at", "2025-11-11 12:47:41.463522"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jc Lebsack"], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:41.648888"], ["updated_at", "2025-11-11 12:47:41.648888"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/176" for 127.0.0.1 at 2025-11-11 12:47:41 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"176"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 191], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 585)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Monstrous Regiment of Women"], ["author", "Sona Huels"], ["genre", "Suspense/Thriller"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Animi excepturi laudantium. Est ut harum. Mollitia placeat nobis."], ["created_at", "2025-11-11 12:47:41.756557"], ["updated_at", "2025-11-11 12:47:41.756557"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Coral Mraz"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:41.967493"], ["updated_at", "2025-11-11 12:47:41.967493"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/177" for 127.0.0.1 at 2025-11-11 12:47:41 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"177", "book"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 192], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 177], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 177]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBook Destroy (1.1ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 177]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 204 No Content in 19ms (ActiveRecord: 3.7ms | Allocations: 3263)


  [1m[36mBook Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Golden Bowl"], ["author", "Mrs. Warren Jast"], ["genre", "Fanfiction"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Repellat eius minima. Dolor et nostrum. Cum pariatur in."], ["created_at", "2025-11-11 12:47:42.116697"], ["updated_at", "2025-11-11 12:47:42.116697"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lavonda Hammes"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:42.309487"], ["updated_at", "2025-11-11 12:47:42.309487"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/178" for 127.0.0.1 at 2025-11-11 12:47:42 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"178", "book"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 193], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 5ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 586)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sung Nicolas"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:42.607252"], ["updated_at", "2025-11-11 12:47:42.607252"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fair Stood the Wind for France"], ["author", "Cleveland Hayes Jr."], ["genre", "Narrative nonfiction"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Necessitatibus sint ad. Aliquid assumenda odio. Molestiae temporibus perspiciatis."], ["created_at", "2025-11-11 12:47:42.621136"], ["updated_at", "2025-11-11 12:47:42.621136"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 179]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 194], ["book_id", 179], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.1ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 194], ["book_id", 179], ["borrowed_at", "2025-11-11 12:47:42.625601"], ["due_at", "2025-11-25 12:47:42.625638"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:42.635122"], ["updated_at", "2025-11-11 12:47:42.635122"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rocco Luettgen"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:42.825031"], ["updated_at", "2025-11-11 12:47:42.825031"]]
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Create (1.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Golden Bowl"], ["author", "Klara Beatty"], ["genre", "Historical fiction"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "Ex consectetur voluptatem. Quidem ut voluptas. Ea sapiente adipisci."], ["created_at", "2025-11-11 12:47:42.854124"], ["updated_at", "2025-11-11 12:47:42.854124"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 180]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 195], ["book_id", 180], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 195], ["book_id", 180], ["borrowed_at", "2025-11-11 12:47:42.861482"], ["due_at", "2025-11-25 12:47:42.861558"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:42.874199"], ["updated_at", "2025-11-11 12:47:42.874199"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-11 12:47:42 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 194], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 179]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 108ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 3411)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Trenton Nienow"], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:43.352525"], ["updated_at", "2025-11-11 12:47:43.352525"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Many-Splendoured Thing"], ["author", "Rosanna Carter"], ["genre", "Fanfiction"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "In qui illum. Eum architecto ab. Molestias molestiae ratione."], ["created_at", "2025-11-11 12:47:43.365000"], ["updated_at", "2025-11-11 12:47:43.365000"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 181]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 196], ["book_id", 181], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 196], ["book_id", 181], ["borrowed_at", "2025-11-11 12:47:43.369647"], ["due_at", "2025-11-25 12:47:43.369721"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:43.376855"], ["updated_at", "2025-11-11 12:47:43.376855"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Chau Lowe"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:43.563030"], ["updated_at", "2025-11-11 12:47:43.563030"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "In Death Ground"], ["author", "Luanne Konopelski"], ["genre", "Mythopoeia"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Mollitia deserunt nulla. Voluptatum consequuntur iure. Consequuntur dolorum unde."], ["created_at", "2025-11-11 12:47:43.574913"], ["updated_at", "2025-11-11 12:47:43.574913"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 182]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 197], ["book_id", 182], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 197], ["book_id", 182], ["borrowed_at", "2025-11-11 12:47:43.579753"], ["due_at", "2025-11-25 12:47:43.579800"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:43.587384"], ["updated_at", "2025-11-11 12:47:43.587384"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Norman Fay V"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:43.774862"], ["updated_at", "2025-11-11 12:47:43.774862"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fair Stood the Wind for France"], ["author", "Johnie Kuphal V"], ["genre", "Folklore"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "Occaecati omnis aut. Atque quod quaerat. Non ipsum rerum."], ["created_at", "2025-11-11 12:47:43.786958"], ["updated_at", "2025-11-11 12:47:43.786958"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 183]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 198], ["book_id", 183], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 198], ["book_id", 183], ["borrowed_at", "2025-11-11 12:47:43.791841"], ["due_at", "2025-11-25 12:47:43.791891"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:43.801360"], ["updated_at", "2025-11-11 12:47:43.801360"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tiesha Cruickshank"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:43.982813"], ["updated_at", "2025-11-11 12:47:43.982813"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-11 12:47:43 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 199], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 183], ["id", 182], ["id", 181], ["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2, $3, $4)[0m  [["id", 198], ["id", 197], ["id", 196], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 18ms (Views: 0.3ms | ActiveRecord: 2.9ms | Allocations: 3517)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Waiting for the Barbarians"], ["author", "Mauricio Bogan"], ["genre", "Legend"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "Facere ab accusantium. Quibusdam totam et. Sed illo sed."], ["created_at", "2025-11-11 12:47:44.111994"], ["updated_at", "2025-11-11 12:47:44.111994"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Odette Towne"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:44.299014"], ["updated_at", "2025-11-11 12:47:44.299014"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 12:47:44 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>184}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 200], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 184], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 184]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 200], ["book_id", 184], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 200], ["book_id", 184], ["borrowed_at", "2025-11-11 12:47:44.396083"], ["due_at", "2025-11-25 12:47:44.396116"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:44.404744"], ["updated_at", "2025-11-11 12:47:44.404744"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 18ms (Views: 0.2ms | ActiveRecord: 4.8ms | Allocations: 4059)


  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Create (1.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Moving Toyshop"], ["author", "Errol Kertzmann"], ["genre", "Fantasy"], ["isbn", "978030000033"], ["total_copies", 1], ["description", "Aut qui temporibus. Et ipsa doloremque. Velit non sit."], ["created_at", "2025-11-11 12:47:44.426978"], ["updated_at", "2025-11-11 12:47:44.426978"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Flora Raynor"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:44.609445"], ["updated_at", "2025-11-11 12:47:44.609445"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 185]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 201], ["book_id", 185], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.0ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 201], ["book_id", 185], ["borrowed_at", "2025-11-11 12:47:44.615804"], ["due_at", "2025-11-25 12:47:44.615857"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:44.623083"], ["updated_at", "2025-11-11 12:47:44.623083"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Margarito Hudson"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:44.807716"], ["updated_at", "2025-11-11 12:47:44.807716"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 12:47:44 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>185}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 202], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 185], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 185]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 202], ["book_id", 185], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 13ms (Views: 0.1ms | ActiveRecord: 3.3ms | Allocations: 3536)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Torment of Others"], ["author", "Abdul Hills"], ["genre", "Fairy tale"], ["isbn", "978030000034"], ["total_copies", 2], ["description", "Qui velit et. Ipsa voluptatem voluptas. Nostrum ut tenetur."], ["created_at", "2025-11-11 12:47:44.916109"], ["updated_at", "2025-11-11 12:47:44.916109"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sudie Huel"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:45.129869"], ["updated_at", "2025-11-11 12:47:45.129869"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-11 12:47:45 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>186}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 203], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 403 Forbidden in 4ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 576)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (7.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Look to Windward"], ["author", "Ronny Dickens"], ["genre", "Suspense/Thriller"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Maxime qui eveniet. Sed sit modi. Rerum esse nam."], ["created_at", "2025-11-11 12:47:45.247196"], ["updated_at", "2025-11-11 12:47:45.247196"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lynelle Gottlieb"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:45.442692"], ["updated_at", "2025-11-11 12:47:45.442692"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 187]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 204], ["book_id", 187], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 204], ["book_id", 187], ["borrowed_at", "2025-11-11 12:47:45.447813"], ["due_at", "2025-11-25 12:47:45.447864"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:45.457467"], ["updated_at", "2025-11-11 12:47:45.457467"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dara Ortiz DO"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:45.663536"], ["updated_at", "2025-11-11 12:47:45.663536"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/124/return" for 127.0.0.1 at 2025-11-11 12:47:45 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"124", "borrowing"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 205], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 124], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (3.4ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-11 12:47:45.814171"], ["updated_at", "2025-11-11 12:47:45.814990"], ["id", 124]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 204], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 187], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 32ms (Views: 0.3ms | ActiveRecord: 6.6ms | Allocations: 4496)


  [1m[36mBorrowing Load (0.9ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 124], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (1.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Create (1.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "If Not Now, When?"], ["author", "Viola Hand"], ["genre", "Western"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Ex numquam voluptatibus. Id ut rerum. Earum fugit error."], ["created_at", "2025-11-11 12:47:45.862330"], ["updated_at", "2025-11-11 12:47:45.862330"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (1.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Miss Marx Anderson"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:46.069426"], ["updated_at", "2025-11-11 12:47:46.069426"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 188]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.9ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 206], ["book_id", 188], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 206], ["book_id", 188], ["borrowed_at", "2025-11-11 12:47:46.077087"], ["due_at", "2025-11-25 12:47:46.077154"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:46.088415"], ["updated_at", "2025-11-11 12:47:46.088415"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Moira Mayert I"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:46.291727"], ["updated_at", "2025-11-11 12:47:46.291727"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/125/return" for 127.0.0.1 at 2025-11-11 12:47:46 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"125", "borrowing"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 207], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 125], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-11 12:47:46.403889"], ["updated_at", "2025-11-11 12:47:46.404348"], ["id", 125]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 206], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 188], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 4.5ms | Allocations: 3890)


Started PATCH "/borrowings/125/return" for 127.0.0.1 at 2025-11-11 12:47:46 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"125", "borrowing"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 207], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 125], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
Completed 422 Unprocessable Content in 6ms (Views: 0.3ms | ActiveRecord: 0.8ms | Allocations: 1014)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dick Schmidt"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-11 12:47:46.706000"], ["updated_at", "2025-11-11 12:47:46.706000"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Maynard Beatty"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:46.899406"], ["updated_at", "2025-11-11 12:47:46.899406"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Shall not Perish"], ["author", "Fr. Lorrie Douglas"], ["genre", "Historical fiction"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Debitis laborum qui. Qui vel inventore. Et et provident."], ["created_at", "2025-11-11 12:47:46.913789"], ["updated_at", "2025-11-11 12:47:46.913789"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Look Homeward, Angel"], ["author", "Minnie Cronin"], ["genre", "Fiction in verse"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Magnam rerum ea. Dolore earum voluptates. Ea ut officiis."], ["created_at", "2025-11-11 12:47:46.929401"], ["updated_at", "2025-11-11 12:47:46.929401"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 189]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 209], ["book_id", 189], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 209], ["book_id", 189], ["borrowed_at", "2025-11-11 12:47:46.935829"], ["due_at", "2025-11-25 12:47:46.935878"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:46.946252"], ["updated_at", "2025-11-11 12:47:46.946252"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 190]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 209], ["book_id", 190], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 209], ["book_id", 190], ["borrowed_at", "2025-10-21 12:47:46.953938"], ["due_at", "2025-11-04 12:47:46.954137"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:46.963174"], ["updated_at", "2025-11-11 12:47:46.963174"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-11 12:47:46 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 208], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-11 00:00:00"], ["due_at", "2025-11-11 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (1.1ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:47.135745')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:47.222308')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:47.225508')[0m  [["user_id", 209]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 99ms (Views: 0.4ms | ActiveRecord: 4.7ms | Allocations: 5104)


  [1m[36mBook Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tova Heaney"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-11 12:47:47.464395"], ["updated_at", "2025-11-11 12:47:47.464395"]]
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Create (0.9ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Unweaving the Rainbow"], ["author", "Davis Cummings"], ["genre", "Essay"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Voluptas qui praesentium. Quis necessitatibus deleniti. Quia accusantium harum."], ["created_at", "2025-11-11 12:47:47.482936"], ["updated_at", "2025-11-11 12:47:47.482936"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 191]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 210], ["book_id", 191], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 210], ["book_id", 191], ["borrowed_at", "2025-11-11 12:47:47.489834"], ["due_at", "2025-11-25 12:47:47.489894"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:47.500867"], ["updated_at", "2025-11-11 12:47:47.500867"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Time to Kill"], ["author", "Shalon Rodriguez"], ["genre", "Mystery"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Quod officia occaecati. Beatae dolor et. Natus quia et."], ["created_at", "2025-11-11 12:47:47.518032"], ["updated_at", "2025-11-11 12:47:47.518032"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 192]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 210], ["book_id", 192], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 210], ["book_id", 192], ["borrowed_at", "2025-10-21 12:47:47.523972"], ["due_at", "2025-11-04 12:47:47.524122"], ["returned_at", nil], ["created_at", "2025-11-11 12:47:47.534588"], ["updated_at", "2025-11-11 12:47:47.534588"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-11 12:47:47 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 210], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 210]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 191], ["id", 192]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-11 12:47:47.660047')[0m  [["user_id", 210]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 192]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 2.6ms | Allocations: 3539)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (2.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/" for 172.19.0.1 at 2025-11-11 23:02:49 +0000
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering /bundle/ruby/3.2.0/gems/railties-7.1.6/lib/rails/templates/rails/welcome/index.html.erb
  Rendered /bundle/ruby/3.2.0/gems/railties-7.1.6/lib/rails/templates/rails/welcome/index.html.erb (Duration: 0.9ms | Allocations: 378)
Completed 200 OK in 4620ms (Views: 53.3ms | ActiveRecord: 0.0ms | Allocations: 285940)


  [1m[36mActiveRecord::SchemaMigration Load (1.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (1.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (1.9ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:26:52.986521"], ["id", 1]]
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (2.0ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:26:53.168219"], ["id", 2]]
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (2.1ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.8ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:32:21.777422"], ["id", 1]]
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (2.3ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:32:21.960825"], ["id", 2]]
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:33:55.169733"], ["id", 1]]
  [1m[36mTRANSACTION (7.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (2.2ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:33:55.352672"], ["id", 2]]
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
Started POST "/login" for 172.19.0.1 at 2025-11-13 08:34:23 +0000
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 391ms (Views: 0.3ms | ActiveRecord: 8.3ms | Allocations: 21735)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:34:25 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:34:25.531153')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:34:25.706477')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 212ms (Views: 0.2ms | ActiveRecord: 9.0ms | Allocations: 10786)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:34:25 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:34:25.817985')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:34:25.827960')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 3232)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:34:41 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 36ms (Views: 0.2ms | ActiveRecord: 5.3ms | Allocations: 9608)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:34:42 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 23ms (Views: 0.3ms | ActiveRecord: 2.8ms | Allocations: 4149)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:10 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 124ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 9217)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:10 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1[0m  [["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2707)


Started POST "/login" for 172.19.0.1 at 2025-11-13 08:35:30 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 177ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 605)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:35:31 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:35:31.295991')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 3454)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:35:31 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 1], ["id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:35:31.436575')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 3394)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:35:36 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 24ms (Views: 0.3ms | ActiveRecord: 2.9ms | Allocations: 4149)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:35:36 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 29ms (Views: 0.4ms | ActiveRecord: 3.1ms | Allocations: 4150)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:39 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>2}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 26ms (Views: 0.3ms | ActiveRecord: 4.9ms | Allocations: 3906)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:43 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 17ms (Views: 0.3ms | ActiveRecord: 4.0ms | Allocations: 3175)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:48 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>3}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 3], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (10.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 3], ["borrowed_at", "2025-11-13 08:35:48.604108"], ["due_at", "2025-11-27 08:35:48.604129"], ["returned_at", nil], ["created_at", "2025-11-13 08:35:48.611858"], ["updated_at", "2025-11-13 08:35:48.611858"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 31ms (Views: 0.2ms | ActiveRecord: 15.4ms | Allocations: 4091)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:35:48 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 3.0ms | Allocations: 4150)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:50 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>3}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 3], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 15ms (Views: 0.2ms | ActiveRecord: 3.3ms | Allocations: 3169)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:52 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>4}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 4], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 4], ["borrowed_at", "2025-11-13 08:35:52.317316"], ["due_at", "2025-11-27 08:35:52.317342"], ["returned_at", nil], ["created_at", "2025-11-13 08:35:52.325465"], ["updated_at", "2025-11-13 08:35:52.325465"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (6.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 29ms (Views: 0.2ms | ActiveRecord: 10.9ms | Allocations: 3796)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:35:52 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 4150)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:35:54 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>5}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 5], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 5], ["borrowed_at", "2025-11-13 08:35:54.185820"], ["due_at", "2025-11-27 08:35:54.185843"], ["returned_at", nil], ["created_at", "2025-11-13 08:35:54.192680"], ["updated_at", "2025-11-13 08:35:54.192680"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (6.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 24ms (Views: 0.2ms | ActiveRecord: 10.3ms | Allocations: 3801)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:35:54 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.7ms | ActiveRecord: 2.7ms | Allocations: 4149)


Started POST "/signup" for 172.19.0.1 at 2025-11-13 08:36:21 +0000
Processing by AuthController#signup as HTML
  Parameters: {"user"=>{"name"=>"legolas", "email"=>"legolas@mail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "auth"=>{"user"=>{"name"=>"legolas", "email"=>"legolas@mail.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "legolas@mail.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Create (2.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "legolas"], ["email", "legolas@mail.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:36:21.332225"], ["updated_at", "2025-11-13 08:36:21.332225"]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (1.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 201 Created in 187ms (Views: 0.2ms | ActiveRecord: 7.1ms | Allocations: 2907)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:36:21 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:36:21.502134')[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 1680)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:36:21 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:36:21.624145')[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 1681)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:26 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 22ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 4150)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:26 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 4150)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:36:29 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>4}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 211], ["book_id", 4], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 211], ["book_id", 4], ["borrowed_at", "2025-11-13 08:36:29.457105"], ["due_at", "2025-11-27 08:36:29.457127"], ["returned_at", nil], ["created_at", "2025-11-13 08:36:29.465396"], ["updated_at", "2025-11-13 08:36:29.465396"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (6.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 27ms (Views: 0.2ms | ActiveRecord: 10.1ms | Allocations: 3801)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:29 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 4149)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:36:36 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>3}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 211], ["book_id", 3], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 211], ["book_id", 3], ["borrowed_at", "2025-11-13 08:36:36.689468"], ["due_at", "2025-11-27 08:36:36.689490"], ["returned_at", nil], ["created_at", "2025-11-13 08:36:36.697856"], ["updated_at", "2025-11-13 08:36:36.697856"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 23ms (Views: 0.2ms | ActiveRecord: 6.4ms | Allocations: 3797)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:36 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 3.0ms | Allocations: 4152)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:36:37 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>5}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 211], ["book_id", 5], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 211], ["book_id", 5], ["borrowed_at", "2025-11-13 08:36:37.989926"], ["due_at", "2025-11-27 08:36:37.989947"], ["returned_at", nil], ["created_at", "2025-11-13 08:36:37.997908"], ["updated_at", "2025-11-13 08:36:37.997908"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 26ms (Views: 0.2ms | ActiveRecord: 6.3ms | Allocations: 3798)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:38 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 21ms (Views: 0.7ms | ActiveRecord: 3.0ms | Allocations: 4150)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:36:38 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>2}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 211], ["book_id", 2], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 211], ["book_id", 2], ["borrowed_at", "2025-11-13 08:36:38.842999"], ["due_at", "2025-11-27 08:36:38.843051"], ["returned_at", nil], ["created_at", "2025-11-13 08:36:38.853720"], ["updated_at", "2025-11-13 08:36:38.853720"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (9.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 34ms (Views: 0.2ms | ActiveRecord: 14.2ms | Allocations: 3799)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:38 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 2.7ms | Allocations: 4149)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:36:39 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 211], ["book_id", 1], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 211], ["book_id", 1], ["borrowed_at", "2025-11-13 08:36:39.502604"], ["due_at", "2025-11-27 08:36:39.502630"], ["returned_at", nil], ["created_at", "2025-11-13 08:36:39.510171"], ["updated_at", "2025-11-13 08:36:39.510171"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (6.7ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 27ms (Views: 0.2ms | ActiveRecord: 10.4ms | Allocations: 3801)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:36:39 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 24ms (Views: 0.3ms | ActiveRecord: 3.5ms | Allocations: 4149)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:36:41 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 4], ["id", 3], ["id", 5], ["id", 2], ["id", 1]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:36:41.836830')[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 2973)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:36:41 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 4], ["id", 3], ["id", 5], ["id", 2], ["id", 1]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:36:41.955473')[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2973)


Started POST "/login" for 172.19.0.1 at 2025-11-13 08:37:13 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 174ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 606)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:37:13 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:37:13.690978')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:37:13.703271')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 18ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 3212)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:37:13 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:37:13.815762')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:37:13.825504')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 2.2ms | Allocations: 3212)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:37:21 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 27ms (Views: 0.2ms | ActiveRecord: 3.4ms | Allocations: 4149)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:37:21 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 4150)


Started POST "/books" for 172.19.0.1 at 2025-11-13 08:38:11 +0000
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"title"=>"Book 1", "author"=>"me", "genre"=>"Self Help", "isbn"=>"0", "total_copies"=>1, "description"=>""}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "0"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Create (7.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Book 1"], ["author", "me"], ["genre", "Self Help"], ["isbn", "0"], ["total_copies", 1], ["description", ""], ["created_at", "2025-11-13 08:38:11.357849"], ["updated_at", "2025-11-13 08:38:11.357849"]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 193]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 201 Created in 27ms (Views: 0.2ms | ActiveRecord: 12.7ms | Allocations: 3754)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:11 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 193]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 3.5ms | Allocations: 4795)


Started DELETE "/books/193" for 172.19.0.1 at 2025-11-13 08:38:18 +0000
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"193"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 193], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 193]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBook Destroy (0.5ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 193]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 204 No Content in 18ms (ActiveRecord: 3.3ms | Allocations: 3036)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:18 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 25ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 4149)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:20 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 3.2ms | Allocations: 4149)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:21 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 4150)


Started POST "/login" for 172.19.0.1 at 2025-11-13 08:38:22 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 172ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 606)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:38:22 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:38:22.905517')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:38:22.916219')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 19ms (Views: 0.5ms | ActiveRecord: 2.6ms | Allocations: 3213)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:38:22 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:38:23.040665')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:38:23.055267')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 3213)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:24 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 3.0ms | Allocations: 4149)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:25 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 4]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 3.4ms | Allocations: 4149)


Started DELETE "/books/4" for 172.19.0.1 at 2025-11-13 08:38:32 +0000
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"4"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:45:in `set_book'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 4]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Destroy (0.3ms)[0m  [1m[31mDELETE FROM "borrowings" WHERE "borrowings"."id" = $1[0m  [["id", 131]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBorrowing Destroy (0.5ms)[0m  [1m[31mDELETE FROM "borrowings" WHERE "borrowings"."id" = $1[0m  [["id", 133]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mBook Destroy (0.4ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 4]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (2.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 204 No Content in 24ms (ActiveRecord: 5.0ms | Allocations: 3981)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:38:32 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 3507)


Started GET "/books?q=Andrew&genre=" for 172.19.0.1 at 2025-11-13 08:39:56 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"Andrew", "genre"=>""}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (2.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%andrew%' OR LOWER(author) LIKE '%andrew%' OR LOWER(genre) LIKE '%andrew%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 3.2ms | Allocations: 1649)


Started POST "/books" for 172.19.0.1 at 2025-11-13 08:40:43 +0000
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"title"=>"The Pragmatic Programmer", "author"=>"Andrew Hunt ", "genre"=>"Technology", "isbn"=>"9780201616224", "total_copies"=>1, "description"=>""}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
Completed 422 Unprocessable Content in 4809ms (Views: 0.2ms | ActiveRecord: 2.9ms | Allocations: 284499)


Started GET "/books?q=&genre=" for 172.19.0.1 at 2025-11-13 08:40:48 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"", "genre"=>""}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 3506)


Started POST "/books" for 172.19.0.1 at 2025-11-13 08:42:44 +0000
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"title"=>"The Pragmatic Programmer 2", "author"=>"Andrew Hunt ", "genre"=>"Technology", "isbn"=>"9780201616224", "total_copies"=>1, "description"=>""}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
Completed 422 Unprocessable Content in 11ms (Views: 0.2ms | ActiveRecord: 3.6ms | Allocations: 2538)


Started POST "/books" for 172.19.0.1 at 2025-11-13 08:42:53 +0000
Processing by BooksController#create as HTML
  Parameters: {"book"=>{"title"=>"The Pragmatic Programmer 2", "author"=>"Andrew Hunt ", "genre"=>"Technology", "isbn"=>"9780201616225", "total_copies"=>1, "description"=>""}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616225"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Pragmatic Programmer 2"], ["author", "Andrew Hunt "], ["genre", "Technology"], ["isbn", "9780201616225"], ["total_copies", 1], ["description", ""], ["created_at", "2025-11-13 08:42:53.150744"], ["updated_at", "2025-11-13 08:42:53.150744"]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (1.9ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBorrowing Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 201 Created in 19ms (Views: 0.2ms | ActiveRecord: 6.3ms | Allocations: 3382)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:42:53 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 3.0ms | Allocations: 4152)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:24 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 13ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 3608)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:24 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 3608)


Started PATCH "/borrowings/2/return" for 172.19.0.1 at 2025-11-13 08:43:30 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"2"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.9ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (4.1ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:30.173214"], ["updated_at", "2025-11-13 08:43:30.173849"], ["id", 2]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 8.7ms | Allocations: 4366)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:30 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 20ms (Views: 0.6ms | ActiveRecord: 2.3ms | Allocations: 3619)


Started PATCH "/borrowings/1/return" for 172.19.0.1 at 2025-11-13 08:43:33 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (3.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:33.544281"], ["updated_at", "2025-11-13 08:43:33.544780"], ["id", 1]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (9.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 30ms (Views: 0.2ms | ActiveRecord: 13.8ms | Allocations: 3644)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:33 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 3630)


Started PATCH "/borrowings/130/return" for 172.19.0.1 at 2025-11-13 08:43:34 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"130"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 130], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (1.8ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:34.185301"], ["updated_at", "2025-11-13 08:43:34.185740"], ["id", 130]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (6.8ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 9.8ms | Allocations: 3643)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:34 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 11ms (Views: 0.3ms | ActiveRecord: 1.3ms | Allocations: 3641)


Started PATCH "/borrowings/132/return" for 172.19.0.1 at 2025-11-13 08:43:34 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"132"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 132], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.2ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:34.801457"], ["updated_at", "2025-11-13 08:43:34.801971"], ["id", 132]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 5.4ms | Allocations: 3644)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:34 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 15ms (Views: 0.4ms | ActiveRecord: 1.8ms | Allocations: 3652)


Started PATCH "/borrowings/134/return" for 172.19.0.1 at 2025-11-13 08:43:35 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"134"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 134], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:35.351542"], ["updated_at", "2025-11-13 08:43:35.351960"], ["id", 134]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (2.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 3644)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:35 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 13ms (Views: 0.4ms | ActiveRecord: 1.4ms | Allocations: 3663)


Started PATCH "/borrowings/135/return" for 172.19.0.1 at 2025-11-13 08:43:35 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"135"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 135], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (1.8ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:35.799679"], ["updated_at", "2025-11-13 08:43:35.800059"], ["id", 135]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (6.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 9.1ms | Allocations: 3642)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:35 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.8ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 3674)


Started PATCH "/borrowings/136/return" for 172.19.0.1 at 2025-11-13 08:43:36 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"136"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 136], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (5.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:36.386846"], ["updated_at", "2025-11-13 08:43:36.387271"], ["id", 136]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 7.8ms | Allocations: 3644)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:36 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.4ms | ActiveRecord: 1.4ms | Allocations: 3686)


Started PATCH "/borrowings/137/return" for 172.19.0.1 at 2025-11-13 08:43:36 +0000
Processing by BorrowingsController#return_book as HTML
  Parameters: {"id"=>"137"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 137], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.5ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:43:36.958092"], ["updated_at", "2025-11-13 08:43:36.958644"], ["id", 137]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (2.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 5.9ms | Allocations: 3643)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:43:36 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 1], ["id", 2], ["id", 5], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 211], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 3696)


Started POST "/login" for 172.19.0.1 at 2025-11-13 08:45:00 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"legolas@mail.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"legolas@mail.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "legolas@mail.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 175ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 605)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:45:01 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 3], ["id", 5], ["id", 2], ["id", 1]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:45:01.419302')[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2889)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:45:01 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 3], ["id", 5], ["id", 2], ["id", 1]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:45:01.538472')[0m  [["user_id", 211]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 12ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 2889)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:05 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 4153)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:05 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 22ms (Views: 0.5ms | ActiveRecord: 2.5ms | Allocations: 4153)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:08 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>194}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 194], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 211], ["book_id", 194], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 211], ["book_id", 194], ["borrowed_at", "2025-11-13 08:45:08.311600"], ["due_at", "2025-11-27 08:45:08.311653"], ["returned_at", nil], ["created_at", "2025-11-13 08:45:08.319914"], ["updated_at", "2025-11-13 08:45:08.319914"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (1.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 21ms (Views: 0.2ms | ActiveRecord: 5.5ms | Allocations: 3803)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:08 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 211], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 24ms (Views: 0.5ms | ActiveRecord: 3.2ms | Allocations: 4152)


Started POST "/login" for 172.19.0.1 at 2025-11-13 08:45:13 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 175ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 605)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:45:13 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:45:13.918976')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2890)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:45:13 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:45:14.033901')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 2889)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:16 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 5], ["id", 3], ["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 2573)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:16 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 5], ["id", 3], ["id", 1], ["id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 2558)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:18 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 4153)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:18 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 24ms (Views: 0.6ms | ActiveRecord: 3.0ms | Allocations: 4152)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:25 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>3}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (4.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 3], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 3], ["borrowed_at", "2025-11-13 08:45:25.890652"], ["due_at", "2025-11-27 08:45:25.890679"], ["returned_at", nil], ["created_at", "2025-11-13 08:45:25.902475"], ["updated_at", "2025-11-13 08:45:25.902475"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (6.2ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 29ms (Views: 0.4ms | ActiveRecord: 12.2ms | Allocations: 3803)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:25 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 4152)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:26 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>2}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 2], ["borrowed_at", "2025-11-13 08:45:26.757760"], ["due_at", "2025-11-27 08:45:26.757784"], ["returned_at", nil], ["created_at", "2025-11-13 08:45:26.767828"], ["updated_at", "2025-11-13 08:45:26.767828"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (5.1ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 26ms (Views: 0.2ms | ActiveRecord: 10.7ms | Allocations: 3796)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:26 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 4154)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:27 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 1], ["borrowed_at", "2025-11-13 08:45:27.447628"], ["due_at", "2025-11-27 08:45:27.447654"], ["returned_at", nil], ["created_at", "2025-11-13 08:45:27.455947"], ["updated_at", "2025-11-13 08:45:27.455947"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 24ms (Views: 0.2ms | ActiveRecord: 6.6ms | Allocations: 3799)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:27 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 27ms (Views: 0.6ms | ActiveRecord: 3.7ms | Allocations: 4152)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 08:45:28 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>5}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 5], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 5], ["borrowed_at", "2025-11-13 08:45:28.251502"], ["due_at", "2025-11-27 08:45:28.251523"], ["returned_at", nil], ["created_at", "2025-11-13 08:45:28.257983"], ["updated_at", "2025-11-13 08:45:28.257983"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (2.5ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 20ms (Views: 0.2ms | ActiveRecord: 5.7ms | Allocations: 3795)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:45:28 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:21:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:21:in `available_copies'
Completed 200 OK in 20ms (Views: 0.5ms | ActiveRecord: 2.7ms | Allocations: 4152)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:45:43 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:45:43.352380')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 16ms (Views: 0.4ms | ActiveRecord: 1.6ms | Allocations: 3277)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:45:43 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:45:43.484393')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 1.7ms | Allocations: 3278)


  [1m[36mActiveRecord::InternalMetadata Load (1.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (8.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (40.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (155.7ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (0.6ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (11.9ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (5.5ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (7.7ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (5.1ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (5.3ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (11.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (5.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (3.1ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (2.1ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (2.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (1.9ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (9.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (1.9ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-13 08:50:12.118696', '2025-11-13 08:50:12.118700') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (2.5ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-13 08:50:12.168640' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (1.7ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-13 08:50:12.174660', '2025-11-13 08:50:12.174662') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (17.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Last Temptation"], ["author", "Myong Gulgowski"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Green Bay Tree"], ["author", "Simone Shields JD"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Green Bay Tree"], ["author", "Simone Shields JD"], ["genre", "Fantasy"], ["isbn", "12345"], ["total_copies", 2], ["description", "Rerum et fugit. Sed voluptatum necessitatibus. Eius et dolore."], ["created_at", "2025-11-13 08:50:14.435537"], ["updated_at", "2025-11-13 08:50:14.435537"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "To a God Unknown"], ["author", "Winfred Pagac"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781111111111"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Book"], ["author", "John Doe"], ["genre", "Fanfiction"], ["isbn", "9781111111111"], ["total_copies", 2], ["description", "Fugiat mollitia est. Pariatur voluptatibus expedita. Aut repudiandae ut."], ["created_at", "2025-11-13 08:50:14.487371"], ["updated_at", "2025-11-13 08:50:14.487371"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9782222222222"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781111111111"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Book"], ["author", "John Doe"], ["genre", "Legend"], ["isbn", "9781111111111"], ["total_copies", 2], ["description", "Eligendi dolores voluptatem. Voluptatibus esse nesciunt. Eos fugiat et."], ["created_at", "2025-11-13 08:50:14.506343"], ["updated_at", "2025-11-13 08:50:14.506343"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9782222222222"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "Jane Smith"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Tirra Lirra by the River"], ["author", "Kala Miller"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Tender Is the Night"], ["author", "Martine Baumbach"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Tender Is the Night"], ["author", "Martine Baumbach"], ["genre", "Fiction in verse"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Explicabo asperiores esse. Aut aut aut. Molestiae et hic."], ["created_at", "2025-11-13 08:50:14.535334"], ["updated_at", "2025-11-13 08:50:14.535334"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Felicitas Bartell"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:14.743600"], ["updated_at", "2025-11-13 08:50:14.743600"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 198]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 212], ["book_id", 198], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 212], ["book_id", 198], ["borrowed_at", "2025-11-13 08:50:14.760285"], ["due_at", "2025-11-27 08:50:14.760346"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:14.790213"], ["updated_at", "2025-11-13 08:50:14.790213"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rep. Jacquelynn Kshlerin"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:14.969991"], ["updated_at", "2025-11-13 08:50:14.969991"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 198]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 213], ["book_id", 198], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 213], ["book_id", 198], ["borrowed_at", "2025-10-23 08:50:14.974021"], ["due_at", "2025-11-06 08:50:14.974098"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:14.979188"], ["updated_at", "2025-11-13 08:50:14.979188"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 198]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Ipsum voluptatibus ut. Assumenda mollitia exercitationem. Aspernatur et laudantium."], ["created_at", "2025-11-13 08:50:15.010181"], ["updated_at", "2025-11-13 08:50:15.010181"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Consequatur quo fuga. Veritatis deleniti facere. Explicabo aut sint."], ["created_at", "2025-11-13 08:50:15.021954"], ["updated_at", "2025-11-13 08:50:15.021954"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 199], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 200], ["LIMIT", 1]]
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Lathe of Heaven"], ["author", "Marshall West"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Lathe of Heaven"], ["author", "Marshall West"], ["genre", "Mythology"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Molestiae voluptatem itaque. Quos cumque eius. Nostrum voluptas reiciendis."], ["created_at", "2025-11-13 08:50:15.401689"], ["updated_at", "2025-11-13 08:50:15.401689"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Amb. Magen Moore"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:15.584990"], ["updated_at", "2025-11-13 08:50:15.584990"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 201]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 214], ["book_id", 201], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 214], ["book_id", 201], ["borrowed_at", "2025-11-13 08:50:15.589621"], ["due_at", "2025-11-27 08:50:15.589653"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:15.595543"], ["updated_at", "2025-11-13 08:50:15.595543"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Maryellen Orn"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:15.773147"], ["updated_at", "2025-11-13 08:50:15.773147"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 201]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 215], ["book_id", 201], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dr. Celinda Ernser"], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:15.974408"], ["updated_at", "2025-11-13 08:50:15.974408"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Wind's Twelve Quarters"], ["author", "Reynalda Gutmann"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Wind's Twelve Quarters"], ["author", "Reynalda Gutmann"], ["genre", "Legend"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Eos dolorem possimus. Dolore ut illo. Inventore aperiam aut."], ["created_at", "2025-11-13 08:50:15.991476"], ["updated_at", "2025-11-13 08:50:15.991476"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 202]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 216], ["book_id", 202], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 216], ["book_id", 202], ["borrowed_at", "2025-11-13 08:50:15.997477"], ["due_at", "2025-11-27 08:50:15.997536"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:16.007160"], ["updated_at", "2025-11-13 08:50:16.007160"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 202]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 216], ["book_id", 202], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Neely Grant Ret."], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:16.201661"], ["updated_at", "2025-11-13 08:50:16.201661"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Things Fall Apart"], ["author", "Lanita Beier"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Things Fall Apart"], ["author", "Lanita Beier"], ["genre", "Biography/Autobiography"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "Quasi doloremque autem. Nihil excepturi quis. Distinctio veniam corrupti."], ["created_at", "2025-11-13 08:50:16.212945"], ["updated_at", "2025-11-13 08:50:16.212945"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 203]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 217], ["book_id", 203], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 217], ["book_id", 203], ["borrowed_at", "2025-11-13 08:50:16.218680"], ["due_at", "2025-11-27 08:50:16.218717"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:16.226584"], ["updated_at", "2025-11-13 08:50:16.226584"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mrs. Evan Schroeder"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:16.409358"], ["updated_at", "2025-11-13 08:50:16.409358"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Alone on a Wide, Wide Sea"], ["author", "Mr. Collin Renner"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Alone on a Wide, Wide Sea"], ["author", "Mr. Collin Renner"], ["genre", "Short story"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Consectetur aut eum. Quia nihil odit. Eaque vero dolorem."], ["created_at", "2025-11-13 08:50:16.423587"], ["updated_at", "2025-11-13 08:50:16.423587"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 204]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 218], ["book_id", 204], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 218], ["book_id", 204], ["borrowed_at", "2025-11-13 08:50:16.427242"], ["due_at", "2025-11-27 08:50:16.427273"], ["returned_at", "2025-11-12 08:50:16.427354"], ["created_at", "2025-11-13 08:50:16.435448"], ["updated_at", "2025-11-13 08:50:16.435448"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 147], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 148], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Golda Luettgen"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:16.634550"], ["updated_at", "2025-11-13 08:50:16.634550"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Taming a Sea Horse"], ["author", "The Hon. Jose McDermott"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Taming a Sea Horse"], ["author", "The Hon. Jose McDermott"], ["genre", "Fable"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Fugit mollitia porro. Esse blanditiis reiciendis. Quasi consequatur voluptatum."], ["created_at", "2025-11-13 08:50:16.644879"], ["updated_at", "2025-11-13 08:50:16.644879"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 205]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 219], ["book_id", 205], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 219], ["book_id", 205], ["borrowed_at", "2025-10-23 08:50:16.651278"], ["due_at", "2025-11-06 08:50:16.651411"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:16.657531"], ["updated_at", "2025-11-13 08:50:16.657531"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ginette Gislason"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:16.845478"], ["updated_at", "2025-11-13 08:50:16.845478"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "From Here to Eternity"], ["author", "Truman Moen Esq."], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "From Here to Eternity"], ["author", "Truman Moen Esq."], ["genre", "Fantasy"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Sapiente quia maxime. Labore numquam fuga. Et ratione voluptas."], ["created_at", "2025-11-13 08:50:16.861014"], ["updated_at", "2025-11-13 08:50:16.861014"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 206]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 220], ["book_id", 206], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 220], ["book_id", 206], ["borrowed_at", "2025-11-13 08:50:16.865274"], ["due_at", "2025-11-27 08:50:16.865314"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:16.872877"], ["updated_at", "2025-11-13 08:50:16.872877"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:16.876125') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 149], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:16.877791') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 150], ["LIMIT", 1]]
  [1m[36mBorrowing Load (1.0ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:16.877791')[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Reynaldo Towne"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:17.061406"], ["updated_at", "2025-11-13 08:50:17.061406"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Skull Beneath the Skin"], ["author", "Harold Botsford LLD"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Skull Beneath the Skin"], ["author", "Harold Botsford LLD"], ["genre", "Legend"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Laborum excepturi voluptatem. Ad rerum sit. Repellendus recusandae sed."], ["created_at", "2025-11-13 08:50:17.073020"], ["updated_at", "2025-11-13 08:50:17.073020"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 207]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 221], ["book_id", 207], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 221], ["book_id", 207], ["borrowed_at", "2025-11-13 08:50:17.076452"], ["due_at", "2025-11-27 08:50:17.076479"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:17.083968"], ["updated_at", "2025-11-13 08:50:17.083968"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.6ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 151]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dion Anderson"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:17.465026"], ["updated_at", "2025-11-13 08:50:17.465026"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Cathey Watsica"], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:17.855330"], ["updated_at", "2025-11-13 08:50:17.855330"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 223], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elbert Predovic LLD"], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:18.060530"], ["updated_at", "2025-11-13 08:50:18.060530"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Blue Remembered Earth"], ["author", "Sen. Latosha Crooks"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Blue Remembered Earth"], ["author", "Sen. Latosha Crooks"], ["genre", "Essay"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Nisi consequatur accusamus. Tenetur accusamus consequatur. Tempora reiciendis inventore."], ["created_at", "2025-11-13 08:50:18.072517"], ["updated_at", "2025-11-13 08:50:18.072517"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 208]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 224], ["book_id", 208], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 224], ["book_id", 208], ["borrowed_at", "2025-11-13 08:50:18.076113"], ["due_at", "2025-11-27 08:50:18.076137"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:18.083971"], ["updated_at", "2025-11-13 08:50:18.083971"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Quo Vadis"], ["author", "Darrin Frami III"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Quo Vadis"], ["author", "Darrin Frami III"], ["genre", "Metafiction"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Et et quo. Sint placeat rerum. Nulla dolor et."], ["created_at", "2025-11-13 08:50:18.094685"], ["updated_at", "2025-11-13 08:50:18.094685"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 209]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 224], ["book_id", 209], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 224], ["book_id", 209], ["borrowed_at", "2025-11-13 08:50:18.099794"], ["due_at", "2025-11-27 08:50:18.099836"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:18.106009"], ["updated_at", "2025-11-13 08:50:18.106009"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 224]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Ty Frami"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:18.289352"], ["updated_at", "2025-11-13 08:50:18.289352"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Last Temptation"], ["author", "Aubrey Schmidt"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Last Temptation"], ["author", "Aubrey Schmidt"], ["genre", "Humor"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Dolor qui aut. Porro id optio. Id et et."], ["created_at", "2025-11-13 08:50:18.300324"], ["updated_at", "2025-11-13 08:50:18.300324"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 210]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 225], ["book_id", 210], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 225], ["book_id", 210], ["borrowed_at", "2025-11-13 08:50:18.305749"], ["due_at", "2025-11-27 08:50:18.305795"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:18.311736"], ["updated_at", "2025-11-13 08:50:18.311736"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Look Homeward, Angel"], ["author", "Guadalupe Bergnaum"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Look Homeward, Angel"], ["author", "Guadalupe Bergnaum"], ["genre", "Tall tale"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Qui soluta perferendis. Debitis et ut. Dolorem molestias est."], ["created_at", "2025-11-13 08:50:18.324457"], ["updated_at", "2025-11-13 08:50:18.324457"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (3.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 211]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 225], ["book_id", 211], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 225], ["book_id", 211], ["borrowed_at", "2025-10-23 08:50:18.327560"], ["due_at", "2025-11-06 08:50:18.327625"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:18.335455"], ["updated_at", "2025-11-13 08:50:18.335455"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:18.338676')[0m  [["user_id", 225]]
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:18.341078') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 225], ["id", 154], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:18.341078')[0m  [["user_id", 225]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-13 08:50:18 +0000
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "auth"=>{"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (3.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "sam@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sam Reader"], ["email", "sam@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:18.734173"], ["updated_at", "2025-11-13 08:50:18.734173"]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 201 Created in 218ms (Views: 0.2ms | ActiveRecord: 4.2ms | Allocations: 5184)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-13 08:50:18 +0000
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"email"=>""}, "auth"=>{"user"=>{"email"=>""}}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", ""], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 422 Unprocessable Content in 8ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 3337)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Emile White"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:19.078804"], ["updated_at", "2025-11-13 08:50:19.078804"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-13 08:50:19 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 182ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 825)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "The Hon. Carmel Turner"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:19.553983"], ["updated_at", "2025-11-13 08:50:19.553983"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-13 08:50:19 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 401 Unauthorized in 173ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 581)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Ab quam ad. Quos iure provident. Molestias distinctio ipsum."], ["created_at", "2025-11-13 08:50:19.838035"], ["updated_at", "2025-11-13 08:50:19.838035"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "Itaque optio dolorum. Repellendus facilis suscipit. Repellendus reiciendis sit."], ["created_at", "2025-11-13 08:50:19.849795"], ["updated_at", "2025-11-13 08:50:19.849795"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Pablo Heller"], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:20.036011"], ["updated_at", "2025-11-13 08:50:20.036011"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books" for 127.0.0.1 at 2025-11-13 08:50:20 +0000
Processing by BooksController#index as HTML
  Parameters: {"book"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 229], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 212]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 213]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 3.2ms | Allocations: 6033)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Perferendis dolores vel. Accusamus deleniti minima. Odit velit harum."], ["created_at", "2025-11-13 08:50:20.207798"], ["updated_at", "2025-11-13 08:50:20.207798"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Occaecati dolorem minus. Facere ut nostrum. A consequatur voluptatum."], ["created_at", "2025-11-13 08:50:20.221970"], ["updated_at", "2025-11-13 08:50:20.221970"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Reina Hilpert"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:20.402018"], ["updated_at", "2025-11-13 08:50:20.402018"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books?q=ruby" for 127.0.0.1 at 2025-11-13 08:50:20 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"ruby", "book"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 230], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 214]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 1713)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elmer King"], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:20.726147"], ["updated_at", "2025-11-13 08:50:20.726147"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 08:50:20 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 231], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "New Book"], ["author", "Author Name"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "New Book"], ["author", "Author Name"], ["genre", "Genre"], ["isbn", "9781234567890"], ["total_copies", 3], ["description", nil], ["created_at", "2025-11-13 08:50:20.834752"], ["updated_at", "2025-11-13 08:50:20.834752"]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 216]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 201 Created in 17ms (Views: 0.2ms | ActiveRecord: 3.8ms | Allocations: 4297)


  [1m[36mBook Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dorotha Bailey"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:21.023681"], ["updated_at", "2025-11-13 08:50:21.023681"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 08:50:21 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 232], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 607)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (5.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Original Title"], ["author", "Sasha Harvey"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Sasha Harvey"], ["genre", "Speech"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Et earum tempora. Quisquam distinctio at. Velit quaerat praesentium."], ["created_at", "2025-11-13 08:50:21.138005"], ["updated_at", "2025-11-13 08:50:21.138005"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rita Christiansen"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:21.320328"], ["updated_at", "2025-11-13 08:50:21.320328"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/217" for 127.0.0.1 at 2025-11-13 08:50:21 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"217"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 233], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 217], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."id" != $2 AND "books"."author" = $3 LIMIT $4[0m  [["title", "Updated Title"], ["id", 217], ["author", "Sasha Harvey"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBook Update (0.5ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Updated Title"], ["updated_at", "2025-11-13 08:50:21.432282"], ["id", 217]]
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 217]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 21ms (Views: 0.1ms | ActiveRecord: 6.4ms | Allocations: 4653)


  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 217], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Original Title"], ["author", "Mohamed Hamill"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Mohamed Hamill"], ["genre", "Mythology"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "Ab est quos. Error velit voluptates. Eius ex nulla."], ["created_at", "2025-11-13 08:50:21.454050"], ["updated_at", "2025-11-13 08:50:21.454050"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Versie Buckridge Ret."], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:21.634788"], ["updated_at", "2025-11-13 08:50:21.634788"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/218" for 127.0.0.1 at 2025-11-13 08:50:21 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"218"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 234], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 585)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Infinite Jest"], ["author", "Bernadette Harris"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Infinite Jest"], ["author", "Bernadette Harris"], ["genre", "Western"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Mollitia itaque officia. Aut officia eos. Sit suscipit praesentium."], ["created_at", "2025-11-13 08:50:21.749754"], ["updated_at", "2025-11-13 08:50:21.749754"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Werner Pacocha DDS"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:21.934542"], ["updated_at", "2025-11-13 08:50:21.934542"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/219" for 127.0.0.1 at 2025-11-13 08:50:21 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"219", "book"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 235], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 219], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL LIMIT $2[0m  [["book_id", 219], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:43:in `destroy'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 219]]
  â†³ app/controllers/books_controller.rb:43:in `destroy'
  [1m[36mBook Destroy (0.4ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 219]]
  â†³ app/controllers/books_controller.rb:43:in `destroy'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:43:in `destroy'
Completed 204 No Content in 15ms (ActiveRecord: 2.0ms | Allocations: 3759)


  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "By Grand Central Station I Sat Down and Wept"], ["author", "Gov. Leroy Keebler"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "By Grand Central Station I Sat Down and Wept"], ["author", "Gov. Leroy Keebler"], ["genre", "Essay"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Magni rerum sed. Eaque in labore. Sit culpa eum."], ["created_at", "2025-11-13 08:50:22.071024"], ["updated_at", "2025-11-13 08:50:22.071024"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Cyril Renner VM"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:22.251097"], ["updated_at", "2025-11-13 08:50:22.251097"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/220" for 127.0.0.1 at 2025-11-13 08:50:22 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"220", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 236], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 586)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Consider Phlebas"], ["author", "Mr. Dirk Glover"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Consider Phlebas"], ["author", "Mr. Dirk Glover"], ["genre", "Historical fiction"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Adipisci quo aut. Fuga est minima. Optio provident placeat."], ["created_at", "2025-11-13 08:50:22.367880"], ["updated_at", "2025-11-13 08:50:22.367880"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rev. Walter Huels"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:22.548068"], ["updated_at", "2025-11-13 08:50:22.548068"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 221]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 237], ["book_id", 221], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 237], ["book_id", 221], ["borrowed_at", "2025-11-13 08:50:22.554815"], ["due_at", "2025-11-27 08:50:22.554850"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:22.561175"], ["updated_at", "2025-11-13 08:50:22.561175"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Alva Kuphal"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:22.742175"], ["updated_at", "2025-11-13 08:50:22.742175"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/221" for 127.0.0.1 at 2025-11-13 08:50:22 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"221", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 238], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 221], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL LIMIT $2[0m  [["book_id", 221], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 422 Unprocessable Content in 7ms (Views: 0.2ms | ActiveRecord: 0.8ms | Allocations: 1572)


  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 221], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781111111111"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Book"], ["author", "John Doe"], ["genre", "Fable"], ["isbn", "9781111111111"], ["total_copies", 2], ["description", "Ea earum rerum. Velit ea aliquam. Debitis itaque sit."], ["created_at", "2025-11-13 08:50:22.884632"], ["updated_at", "2025-11-13 08:50:22.884632"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mr. Henrietta Beahan"], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:23.062937"], ["updated_at", "2025-11-13 08:50:23.062937"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 08:50:23 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"The Book", "author"=>"John Doe", "genre"=>"Fiction", "isbn"=>"9782222222222", "total_copies"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 239], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9782222222222"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
Completed 422 Unprocessable Content in 12ms (Views: 0.2ms | ActiveRecord: 4.0ms | Allocations: 3334)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Mr Standfast"], ["author", "Gerard Mohr"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Mr Standfast"], ["author", "Gerard Mohr"], ["genre", "Mythopoeia"], ["isbn", "9781234567890"], ["total_copies", 2], ["description", "Harum officia ex. Eum repudiandae repellendus. Ut praesentium debitis."], ["created_at", "2025-11-13 08:50:23.184746"], ["updated_at", "2025-11-13 08:50:23.184746"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Claudine O'Conner"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:23.370796"], ["updated_at", "2025-11-13 08:50:23.370796"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 08:50:23 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"Different Title", "author"=>"Different Author", "genre"=>"Fiction", "isbn"=>"9781234567890", "total_copies"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 240], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Different Title"], ["author", "Different Author"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
Completed 422 Unprocessable Content in 11ms (Views: 0.1ms | ActiveRecord: 3.0ms | Allocations: 3435)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Paulene Reynolds IV"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:23.662141"], ["updated_at", "2025-11-13 08:50:23.662141"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Lilies of the Field"], ["author", "Sung Jacobs"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Lilies of the Field"], ["author", "Sung Jacobs"], ["genre", "Fiction in verse"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "Iusto culpa in. Et veritatis qui. Enim nesciunt qui."], ["created_at", "2025-11-13 08:50:23.675056"], ["updated_at", "2025-11-13 08:50:23.675056"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (3.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 224]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 241], ["book_id", 224], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 241], ["book_id", 224], ["borrowed_at", "2025-11-13 08:50:23.678464"], ["due_at", "2025-11-27 08:50:23.678490"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:23.686978"], ["updated_at", "2025-11-13 08:50:23.686978"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mr. Kattie Treutel"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:23.870563"], ["updated_at", "2025-11-13 08:50:23.870563"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Proper Study"], ["author", "Fidel Koss"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Proper Study"], ["author", "Fidel Koss"], ["genre", "Tall tale"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "Quibusdam numquam consequatur. Quis aut ea. Quo error magnam."], ["created_at", "2025-11-13 08:50:23.881330"], ["updated_at", "2025-11-13 08:50:23.881330"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 225]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 242], ["book_id", 225], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 242], ["book_id", 225], ["borrowed_at", "2025-11-13 08:50:23.886310"], ["due_at", "2025-11-27 08:50:23.886345"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:23.892253"], ["updated_at", "2025-11-13 08:50:23.892253"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-13 08:50:23 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 241], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 241]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 224]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 35ms (Views: 0.5ms | ActiveRecord: 1.4ms | Allocations: 3404)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elinore Huels V"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:24.250838"], ["updated_at", "2025-11-13 08:50:24.250838"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Kendall Rau"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Kendall Rau"], ["genre", "Mystery"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Quos aut illum. Dolorem id nihil. Rerum omnis hic."], ["created_at", "2025-11-13 08:50:24.264100"], ["updated_at", "2025-11-13 08:50:24.264100"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (3.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 226]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 243], ["book_id", 226], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 243], ["book_id", 226], ["borrowed_at", "2025-11-13 08:50:24.269891"], ["due_at", "2025-11-27 08:50:24.269935"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:24.281824"], ["updated_at", "2025-11-13 08:50:24.281824"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Oliver Osinski"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:24.470656"], ["updated_at", "2025-11-13 08:50:24.470656"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Parliament of Man"], ["author", "Santiago Weimann"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Parliament of Man"], ["author", "Santiago Weimann"], ["genre", "Fanfiction"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "Eius velit repellat. Vero cupiditate beatae. Quas deleniti rerum."], ["created_at", "2025-11-13 08:50:24.480348"], ["updated_at", "2025-11-13 08:50:24.480348"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 227]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 244], ["book_id", 227], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 244], ["book_id", 227], ["borrowed_at", "2025-11-13 08:50:24.486057"], ["due_at", "2025-11-27 08:50:24.486098"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:24.492198"], ["updated_at", "2025-11-13 08:50:24.492198"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Charleen Bogan"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:24.670280"], ["updated_at", "2025-11-13 08:50:24.670280"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "To Say Nothing of the Dog"], ["author", "Rep. Sunday Grant"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "To Say Nothing of the Dog"], ["author", "Rep. Sunday Grant"], ["genre", "Fairy tale"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "Debitis possimus dolorum. Aspernatur minima ipsum. Qui pariatur aspernatur."], ["created_at", "2025-11-13 08:50:24.683912"], ["updated_at", "2025-11-13 08:50:24.683912"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 228]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 245], ["book_id", 228], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 245], ["book_id", 228], ["borrowed_at", "2025-11-13 08:50:24.687543"], ["due_at", "2025-11-27 08:50:24.687567"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:24.694325"], ["updated_at", "2025-11-13 08:50:24.694325"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gov. Bryce Harris"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:24.874950"], ["updated_at", "2025-11-13 08:50:24.874950"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-13 08:50:24 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 246], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8)[0m  [["id", 228], ["id", 227], ["id", 226], ["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 245], ["id", 244], ["id", 243], ["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 1.7ms | Allocations: 5280)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Let Us Now Praise Famous Men"], ["author", "Brigette Bode"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Let Us Now Praise Famous Men"], ["author", "Brigette Bode"], ["genre", "Reference book"], ["isbn", "978030000033"], ["total_copies", 2], ["description", "Facere ut qui. Totam aperiam quia. Vero culpa qui."], ["created_at", "2025-11-13 08:50:25.007366"], ["updated_at", "2025-11-13 08:50:25.007366"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Natalie Zulauf DDS"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:25.191374"], ["updated_at", "2025-11-13 08:50:25.191374"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 08:50:25 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>229}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 247], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 229], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 229]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 247], ["book_id", 229], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 247], ["book_id", 229], ["borrowed_at", "2025-11-13 08:50:25.294049"], ["due_at", "2025-11-27 08:50:25.294073"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:25.301772"], ["updated_at", "2025-11-13 08:50:25.301772"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 16ms (Views: 0.2ms | ActiveRecord: 3.8ms | Allocations: 4060)


  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "All the King's Men"], ["author", "Tamika Kerluke"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "All the King's Men"], ["author", "Tamika Kerluke"], ["genre", "Horror"], ["isbn", "978030000034"], ["total_copies", 1], ["description", "Ea est et. Nobis voluptas magnam. Reiciendis et iusto."], ["created_at", "2025-11-13 08:50:25.322541"], ["updated_at", "2025-11-13 08:50:25.322541"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Frances Walsh JD"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:25.508336"], ["updated_at", "2025-11-13 08:50:25.508336"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (3.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 230]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 248], ["book_id", 230], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 248], ["book_id", 230], ["borrowed_at", "2025-11-13 08:50:25.511838"], ["due_at", "2025-11-27 08:50:25.511867"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:25.520212"], ["updated_at", "2025-11-13 08:50:25.520212"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Cordell Lubowitz II"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:25.706569"], ["updated_at", "2025-11-13 08:50:25.706569"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 08:50:25 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>230}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 249], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 230], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 230]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 249], ["book_id", 230], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 14ms (Views: 0.2ms | ActiveRecord: 3.1ms | Allocations: 3536)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Mermaids Singing"], ["author", "Leandro Pacocha"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Mermaids Singing"], ["author", "Leandro Pacocha"], ["genre", "Narrative nonfiction"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Nihil et reiciendis. Tenetur quaerat ut. Tempore vitae aliquid."], ["created_at", "2025-11-13 08:50:25.829530"], ["updated_at", "2025-11-13 08:50:25.829530"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Emmitt McClure"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:26.010801"], ["updated_at", "2025-11-13 08:50:26.010801"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 08:50:26 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>231}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 250], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 576)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dick Powlowski DVM"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:26.291137"], ["updated_at", "2025-11-13 08:50:26.291137"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Number the Stars"], ["author", "Molly Turcotte"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Number the Stars"], ["author", "Molly Turcotte"], ["genre", "Textbook"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Voluptas ut ut. Nihil ea et. Eos at in."], ["created_at", "2025-11-13 08:50:26.304465"], ["updated_at", "2025-11-13 08:50:26.304465"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 232]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 251], ["book_id", 232], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 251], ["book_id", 232], ["borrowed_at", "2025-11-13 08:50:26.309061"], ["due_at", "2025-11-27 08:50:26.309101"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:26.318061"], ["updated_at", "2025-11-13 08:50:26.318061"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 08:50:26 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>232}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 251], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 232], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 232]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 251], ["book_id", 232], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 16ms (Views: 0.1ms | ActiveRecord: 3.7ms | Allocations: 3428)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Down to a Sunless Sea"], ["author", "Antony Schmidt"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Down to a Sunless Sea"], ["author", "Antony Schmidt"], ["genre", "Textbook"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Dolores velit ipsum. Expedita mollitia esse. Accusantium reprehenderit voluptate."], ["created_at", "2025-01-15 10:00:00"], ["updated_at", "2025-01-15 10:00:00"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Saturnina Reinger"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-01-15 10:00:00"], ["updated_at", "2025-01-15 10:00:00"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-01-15 10:00:00 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>233}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 252], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 233], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (3.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 233]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 252], ["book_id", 233], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 252], ["book_id", 233], ["borrowed_at", "2025-01-15 10:00:00"], ["due_at", "2025-01-29 10:00:00"], ["returned_at", nil], ["created_at", "2025-01-15 10:00:00"], ["updated_at", "2025-01-15 10:00:00"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 18ms (Views: 0.2ms | ActiveRecord: 5.1ms | Allocations: 3954)


  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 165], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Postern of Fate"], ["author", "Deandrea Volkman MD"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Postern of Fate"], ["author", "Deandrea Volkman MD"], ["genre", "Horror"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Optio facilis animi. Consequuntur sint eum. Qui in rem."], ["created_at", "2025-11-13 08:50:26.776296"], ["updated_at", "2025-11-13 08:50:26.776296"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Marion Turner"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:26.974940"], ["updated_at", "2025-11-13 08:50:26.974940"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (3.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 234]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 253], ["book_id", 234], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 253], ["book_id", 234], ["borrowed_at", "2025-11-13 08:50:26.979046"], ["due_at", "2025-11-27 08:50:26.979079"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:26.989475"], ["updated_at", "2025-11-13 08:50:26.989475"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user42@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Monroe Hermann"], ["email", "user42@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:27.181021"], ["updated_at", "2025-11-13 08:50:27.181021"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/166/return" for 127.0.0.1 at 2025-11-13 08:50:27 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"166", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 254], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 166], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:50:27.284098"], ["updated_at", "2025-11-13 08:50:27.284727"], ["id", 166]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 253], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 234], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 17ms (Views: 0.1ms | ActiveRecord: 3.6ms | Allocations: 4390)


  [1m[36mBorrowing Load (0.7ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 166], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Stranger in a Strange Land"], ["author", "Brian O'Hara"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Stranger in a Strange Land"], ["author", "Brian O'Hara"], ["genre", "Comic/Graphic Novel"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Blanditiis ut aut. Iste dolores ad. Quibusdam possimus odio."], ["created_at", "2025-11-13 08:50:27.312116"], ["updated_at", "2025-11-13 08:50:27.312116"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user43@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Aundrea Mohr"], ["email", "user43@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:27.495619"], ["updated_at", "2025-11-13 08:50:27.495619"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 235]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 255], ["book_id", 235], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 255], ["book_id", 235], ["borrowed_at", "2025-11-13 08:50:27.501190"], ["due_at", "2025-11-27 08:50:27.501233"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:27.510937"], ["updated_at", "2025-11-13 08:50:27.510937"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user44@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Noble Simonis"], ["email", "user44@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:27.698521"], ["updated_at", "2025-11-13 08:50:27.698521"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/167/return" for 127.0.0.1 at 2025-11-13 08:50:27 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"167", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 256], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 167], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 08:50:27.801241"], ["updated_at", "2025-11-13 08:50:27.801813"], ["id", 167]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 255], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 235], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 16ms (Views: 0.2ms | ActiveRecord: 3.6ms | Allocations: 3890)


Started PATCH "/borrowings/167/return" for 127.0.0.1 at 2025-11-13 08:50:27 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"167", "borrowing"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 256], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 167], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
Completed 422 Unprocessable Content in 9ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 1014)


  [1m[36mTRANSACTION (0.5ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user45@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Willis Kilback"], ["email", "user45@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 08:50:28.176402"], ["updated_at", "2025-11-13 08:50:28.176402"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user46@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sabrina Fisher VM"], ["email", "user46@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:28.353473"], ["updated_at", "2025-11-13 08:50:28.353473"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "O Jerusalem!"], ["author", "Norris Herzog"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "O Jerusalem!"], ["author", "Norris Herzog"], ["genre", "Mystery"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Placeat quaerat quos. Optio voluptatem placeat. Et id fugit."], ["created_at", "2025-11-13 08:50:28.362524"], ["updated_at", "2025-11-13 08:50:28.362524"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000041"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Behold the Man"], ["author", "Rep. Ardelle Wehner"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Behold the Man"], ["author", "Rep. Ardelle Wehner"], ["genre", "Fiction narrative"], ["isbn", "978030000041"], ["total_copies", 2], ["description", "Soluta ducimus odio. Consequuntur ex sit. Incidunt et rerum."], ["created_at", "2025-11-13 08:50:28.372983"], ["updated_at", "2025-11-13 08:50:28.372983"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 236]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 258], ["book_id", 236], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 258], ["book_id", 236], ["borrowed_at", "2025-11-13 08:50:28.376465"], ["due_at", "2025-11-27 08:50:28.376494"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:28.385788"], ["updated_at", "2025-11-13 08:50:28.385788"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 237]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 258], ["book_id", 237], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 258], ["book_id", 237], ["borrowed_at", "2025-10-23 08:50:28.390099"], ["due_at", "2025-11-06 08:50:28.390201"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:28.396000"], ["updated_at", "2025-11-13 08:50:28.396000"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-13 08:50:28 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 257], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:28.518973')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:28.546373')[0m  [["user_id", 258]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 34ms (Views: 0.3ms | ActiveRecord: 3.0ms | Allocations: 4463)


  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user47@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Freddie Marvin"], ["email", "user47@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 08:50:28.736405"], ["updated_at", "2025-11-13 08:50:28.736405"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000042"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "His Dark Materials"], ["author", "Timothy Schuster"], ["LIMIT", 1]]
  [1m[36mBook Create (1.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "His Dark Materials"], ["author", "Timothy Schuster"], ["genre", "Mythology"], ["isbn", "978030000042"], ["total_copies", 2], ["description", "Perspiciatis dolorem id. Iure at suscipit. Ea voluptas tempora."], ["created_at", "2025-11-13 08:50:28.747222"], ["updated_at", "2025-11-13 08:50:28.747222"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 238]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 259], ["book_id", 238], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 259], ["book_id", 238], ["borrowed_at", "2025-11-13 08:50:28.752470"], ["due_at", "2025-11-27 08:50:28.752508"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:28.758502"], ["updated_at", "2025-11-13 08:50:28.758502"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000043"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Amb. Miquel Block"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Amb. Miquel Block"], ["genre", "Folklore"], ["isbn", "978030000043"], ["total_copies", 2], ["description", "Minima consequuntur in. Perspiciatis ut sed. Sed non amet."], ["created_at", "2025-11-13 08:50:28.770031"], ["updated_at", "2025-11-13 08:50:28.770031"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 239]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 259], ["book_id", 239], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 259], ["book_id", 239], ["borrowed_at", "2025-10-23 08:50:28.773605"], ["due_at", "2025-11-06 08:50:28.773681"], ["returned_at", nil], ["created_at", "2025-11-13 08:50:28.779375"], ["updated_at", "2025-11-13 08:50:28.779375"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-13 08:50:28 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 259], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 259]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 238], ["id", 239]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:50:28.895130')[0m  [["user_id", 259]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 239]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 3542)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
Started POST "/login" for 172.19.0.1 at 2025-11-13 08:51:13 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 225ms (Views: 0.2ms | ActiveRecord: 4.1ms | Allocations: 6104)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:51:14 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (1.0ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:51:14.473974')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 69ms (Views: 0.2ms | ActiveRecord: 5.8ms | Allocations: 6961)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:51:14 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:51:14.632074')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2577)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:51:20 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:51:20.904467')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2576)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:51:20 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:51:21.028612')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 2.3ms | Allocations: 2576)


Started POST "/login" for 172.19.0.1 at 2025-11-13 08:51:23 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 175ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 606)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:51:23 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:51:24.104199')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 22ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 9660)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:51:24 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:51:24.232539')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 15ms (Views: 0.3ms | ActiveRecord: 1.6ms | Allocations: 3283)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:51:27 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 20ms (Views: 0.3ms | ActiveRecord: 2.6ms | Allocations: 4354)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:51:27 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 3.1ms | Allocations: 4152)


  [1m[36mActiveRecord::SchemaMigration Load (1.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (1.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (2.0ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:51:59.058872"], ["id", 1]]
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (3.7ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 08:51:59.308822"], ["id", 2]]
  [1m[36mTRANSACTION (2.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (3.0ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Load (1.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Load (0.6ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Educated"], ["author", "Tara Westover"], ["LIMIT", 1]]
  [1m[36mBook Create (2.0ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Educated"], ["author", "Tara Westover"], ["genre", "Memoir"], ["isbn", "9780399590504"], ["total_copies", 2], ["description", nil], ["created_at", "2025-11-13 08:51:59.409083"], ["updated_at", "2025-11-13 08:51:59.409083"]]
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (1.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBorrowing Load (2.1ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
Started POST "/login" for 172.19.0.1 at 2025-11-13 08:52:19 +0000
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 338ms (Views: 0.2ms | ActiveRecord: 10.1ms | Allocations: 21749)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:52:20 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (1.8ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:52:20.924495')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 92ms (Views: 0.2ms | ActiveRecord: 8.8ms | Allocations: 8953)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 08:52:20 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 08:52:21.093730')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 2598)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:52:24 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 70ms (Views: 0.4ms | ActiveRecord: 3.5ms | Allocations: 16539)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 08:52:24 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 14ms (Views: 0.4ms | ActiveRecord: 1.6ms | Allocations: 4461)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:52:25 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 50ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 5848)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:52:25 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 26ms (Views: 0.5ms | ActiveRecord: 3.9ms | Allocations: 4795)


Started DELETE "/books/2" for 172.19.0.1 at 2025-11-13 08:52:28 +0000
Processing by BooksController#destroy as HTML
  Parameters: {"id"=>"2"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL LIMIT $2[0m  [["book_id", 2], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 422 Unprocessable Content in 11ms (Views: 0.5ms | ActiveRecord: 1.0ms | Allocations: 1691)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:52:45 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 28ms (Views: 0.4ms | ActiveRecord: 3.7ms | Allocations: 4796)


Started GET "/books" for 172.19.0.1 at 2025-11-13 08:52:45 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 28ms (Views: 1.0ms | ActiveRecord: 3.9ms | Allocations: 4795)


  [1m[36mActiveRecord::SchemaMigration Load (2.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (2.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (2.8ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 15:36:48.743682"], ["id", 1]]
  [1m[36mTRANSACTION (1.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (1.9ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 15:36:48.922806"], ["id", 2]]
  [1m[36mTRANSACTION (4.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (1.8ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBorrowing Load (2.0ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (2.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.9ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[35m (38.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "librarian_test"[0m
  [1m[35m (149.9ms)[0m  [1m[35mCREATE DATABASE "librarian_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (1.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "books" CASCADE[0m
  [1m[35m (12.3ms)[0m  [1m[35mCREATE TABLE "books" ("id" bigserial primary key, "title" character varying NOT NULL, "author" character varying NOT NULL, "genre" character varying NOT NULL, "isbn" character varying NOT NULL, "total_copies" integer DEFAULT 1 NOT NULL, "description" text, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL, CONSTRAINT books_total_copies_positive CHECK (total_copies >= 0))[0m
  [1m[35m (5.2ms)[0m  [1m[35mCREATE INDEX "index_books_on_author" ON "books" ("author")[0m
  [1m[35m (5.0ms)[0m  [1m[35mCREATE INDEX "index_books_on_genre" ON "books" ("genre")[0m
  [1m[35m (5.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_books_on_isbn" ON "books" ("isbn")[0m
  [1m[35m (5.4ms)[0m  [1m[35mCREATE INDEX "index_books_on_title" ON "books" ("title")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "borrowings" CASCADE[0m
  [1m[35m (8.7ms)[0m  [1m[35mCREATE TABLE "borrowings" ("id" bigserial primary key, "user_id" bigint NOT NULL, "book_id" bigint NOT NULL, "borrowed_at" timestamp(6) NOT NULL, "due_at" timestamp(6) NOT NULL, "returned_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (4.4ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_book_id" ON "borrowings" ("book_id")[0m
  [1m[35m (5.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_borrowings_on_user_book_active" ON "borrowings" ("user_id", "book_id") WHERE (returned_at IS NULL)[0m
  [1m[35m (4.7ms)[0m  [1m[35mCREATE INDEX "index_borrowings_on_user_id" ON "borrowings" ("user_id")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying NOT NULL, "email" character varying NOT NULL, "password_digest" character varying NOT NULL, "role" integer DEFAULT 0 NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (5.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_users_on_email" ON "users" ("email")[0m
  [1m[35m (3.8ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_2d6421032c"
FOREIGN KEY ("book_id")
  REFERENCES "books" ("id")
[0m
  [1m[35m (2.2ms)[0m  [1m[35mALTER TABLE "borrowings" ADD CONSTRAINT "fk_rails_64d35f133d"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (12.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (1.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20251111102335)[0m
  [1m[35m (1.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20251111102305),
(20251111102212);[0m
  [1m[35m (8.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (2.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-11-13 15:44:16.093142', '2025-11-13 15:44:16.093145') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Update (2.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2025-11-13 15:44:16.140039' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (1.9ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'ad2161a7f3af753e8ca850cd6ae6815f088635f0', '2025-11-13 15:44:16.145544', '2025-11-13 15:44:16.145547') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (16.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000001"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Unweaving the Rainbow"], ["author", "Harvey White"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Postern of Fate"], ["author", "Napoleon Funk"], ["LIMIT", 1]]
  [1m[36mBook Create (2.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Postern of Fate"], ["author", "Napoleon Funk"], ["genre", "Textbook"], ["isbn", "12345"], ["total_copies", 2], ["description", "Laborum sit aliquid. Ut eos laborum. Culpa delectus pariatur."], ["created_at", "2025-11-13 15:44:21.309241"], ["updated_at", "2025-11-13 15:44:21.309241"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "12345"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Precious Bane"], ["author", "Horacio Nienow"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781111111111"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Book"], ["author", "John Doe"], ["genre", "Mythology"], ["isbn", "9781111111111"], ["total_copies", 2], ["description", "Aut ex consequuntur. Non qui repellat. Molestiae accusantium est."], ["created_at", "2025-11-13 15:44:21.359496"], ["updated_at", "2025-11-13 15:44:21.359496"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9782222222222"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781111111111"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Book"], ["author", "John Doe"], ["genre", "Reference book"], ["isbn", "9781111111111"], ["total_copies", 2], ["description", "Similique sed vel. Quam possimus fugit. Ab aliquam officia."], ["created_at", "2025-11-13 15:44:21.382263"], ["updated_at", "2025-11-13 15:44:21.382263"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9782222222222"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "Jane Smith"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000002"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Cover Her Face"], ["author", "Miss Charmaine Hand"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000003"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Now Sleeps the Crimson Petal"], ["author", "Zachary Fritsch"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Now Sleeps the Crimson Petal"], ["author", "Zachary Fritsch"], ["genre", "Mystery"], ["isbn", "978030000003"], ["total_copies", 3], ["description", "Molestiae commodi numquam. Earum sed et. Totam voluptas corporis."], ["created_at", "2025-11-13 15:44:21.411405"], ["updated_at", "2025-11-13 15:44:21.411405"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user1@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (1.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jill Zboncak"], ["email", "user1@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:21.619465"], ["updated_at", "2025-11-13 15:44:21.619465"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (4.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 265]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 278], ["book_id", 265], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 278], ["book_id", 265], ["borrowed_at", "2025-11-13 15:44:21.661132"], ["due_at", "2025-11-27 15:44:21.661192"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:21.736412"], ["updated_at", "2025-11-13 15:44:21.736412"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user2@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Marvel Pfannerstill JD"], ["email", "user2@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:21.916551"], ["updated_at", "2025-11-13 15:44:21.916551"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 265]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 279], ["book_id", 265], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.6ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 279], ["book_id", 265], ["borrowed_at", "2025-10-23 15:44:21.922449"], ["due_at", "2025-11-06 15:44:21.922577"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:21.927967"], ["updated_at", "2025-11-13 15:44:21.927967"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 265]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000004"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Ruby 101"], ["author", "Jane Doe"], ["genre", "Programming"], ["isbn", "978030000004"], ["total_copies", 2], ["description", "Qui qui quo. Est sint sunt. Velit dicta quam."], ["created_at", "2025-11-13 15:44:21.957063"], ["updated_at", "2025-11-13 15:44:21.957063"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000005"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["LIMIT", 1]]
  [1m[36mBook Create (0.8ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Cooking Basics"], ["author", "Chef Anne"], ["genre", "Cooking"], ["isbn", "978030000005"], ["total_copies", 2], ["description", "Qui nesciunt optio. Ipsam qui qui. Et corrupti numquam."], ["created_at", "2025-11-13 15:44:21.967725"], ["updated_at", "2025-11-13 15:44:21.967725"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 266], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%') AND "books"."id" = $1 LIMIT $2[0m  [["id", 267], ["LIMIT", 1]]
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000008"], ["LIMIT", 1]]
  [1m[36mBook Exists? (1.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Look Homeward, Angel"], ["author", "Alma Ratke"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Look Homeward, Angel"], ["author", "Alma Ratke"], ["genre", "Biography/Autobiography"], ["isbn", "978030000008"], ["total_copies", 1], ["description", "Eligendi libero ex. Quisquam et quia. Commodi modi dolore."], ["created_at", "2025-11-13 15:44:22.350861"], ["updated_at", "2025-11-13 15:44:22.350861"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user5@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Rev. Eduardo Homenick"], ["email", "user5@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:22.537937"], ["updated_at", "2025-11-13 15:44:22.537937"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 268]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 280], ["book_id", 268], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 280], ["book_id", 268], ["borrowed_at", "2025-11-13 15:44:22.541948"], ["due_at", "2025-11-27 15:44:22.541980"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:22.548795"], ["updated_at", "2025-11-13 15:44:22.548795"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user6@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Glen Jenkins"], ["email", "user6@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:22.731881"], ["updated_at", "2025-11-13 15:44:22.731881"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 268]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 281], ["book_id", 268], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user7@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Latricia Bins"], ["email", "user7@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:22.918883"], ["updated_at", "2025-11-13 15:44:22.918883"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000009"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Edna O'Brien"], ["author", "Lamont Konopelski"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Edna O'Brien"], ["author", "Lamont Konopelski"], ["genre", "Legend"], ["isbn", "978030000009"], ["total_copies", 2], ["description", "Omnis iusto repellat. Officiis voluptas cupiditate. Velit doloribus porro."], ["created_at", "2025-11-13 15:44:22.927188"], ["updated_at", "2025-11-13 15:44:22.927188"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 269]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 282], ["book_id", 269], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 282], ["book_id", 269], ["borrowed_at", "2025-11-13 15:44:22.931546"], ["due_at", "2025-11-27 15:44:22.931583"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:22.937583"], ["updated_at", "2025-11-13 15:44:22.937583"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 269]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 282], ["book_id", 269], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user8@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Pres. Leticia Ratke"], ["email", "user8@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:23.123485"], ["updated_at", "2025-11-13 15:44:23.123485"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000010"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "An Acceptable Time"], ["author", "Zack Heaney IV"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "An Acceptable Time"], ["author", "Zack Heaney IV"], ["genre", "Mystery"], ["isbn", "978030000010"], ["total_copies", 2], ["description", "Fugiat ut veniam. Ut molestiae sint. Ducimus earum quasi."], ["created_at", "2025-11-13 15:44:23.135247"], ["updated_at", "2025-11-13 15:44:23.135247"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 270]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 283], ["book_id", 270], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.7ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 283], ["book_id", 270], ["borrowed_at", "2025-11-13 15:44:23.138826"], ["due_at", "2025-11-27 15:44:23.138856"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:23.147362"], ["updated_at", "2025-11-13 15:44:23.147362"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user9@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Tona Blick"], ["email", "user9@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:23.325937"], ["updated_at", "2025-11-13 15:44:23.325937"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000011"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Moab Is My Washpot"], ["author", "Yon Heaney"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Moab Is My Washpot"], ["author", "Yon Heaney"], ["genre", "Suspense/Thriller"], ["isbn", "978030000011"], ["total_copies", 2], ["description", "Quaerat enim sit. Ipsa sunt laudantium. Nostrum aliquid sed."], ["created_at", "2025-11-13 15:44:23.337838"], ["updated_at", "2025-11-13 15:44:23.337838"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 271]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 284], ["book_id", 271], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 284], ["book_id", 271], ["borrowed_at", "2025-11-13 15:44:23.341157"], ["due_at", "2025-11-27 15:44:23.341183"], ["returned_at", "2025-11-12 15:44:23.341248"], ["created_at", "2025-11-13 15:44:23.347684"], ["updated_at", "2025-11-13 15:44:23.347684"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 180], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 181], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user10@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sen. Sebrina Ratke"], ["email", "user10@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:23.542636"], ["updated_at", "2025-11-13 15:44:23.542636"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000012"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "A Confederacy of Dunces"], ["author", "Milagros Hilll"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Confederacy of Dunces"], ["author", "Milagros Hilll"], ["genre", "Mythology"], ["isbn", "978030000012"], ["total_copies", 2], ["description", "Qui unde asperiores. Assumenda sint excepturi. Rerum impedit est."], ["created_at", "2025-11-13 15:44:23.558217"], ["updated_at", "2025-11-13 15:44:23.558217"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 272]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 285], ["book_id", 272], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.8ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 285], ["book_id", 272], ["borrowed_at", "2025-10-23 15:44:23.563049"], ["due_at", "2025-11-06 15:44:23.563170"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:23.571104"], ["updated_at", "2025-11-13 15:44:23.571104"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user11@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Dino Waelchi DC"], ["email", "user11@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:23.765037"], ["updated_at", "2025-11-13 15:44:23.765037"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000013"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Tender Is the Night"], ["author", "Kristle Boyer"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Tender Is the Night"], ["author", "Kristle Boyer"], ["genre", "Reference book"], ["isbn", "978030000013"], ["total_copies", 2], ["description", "Perspiciatis ipsum possimus. Possimus quam occaecati. Molestiae dolorem natus."], ["created_at", "2025-11-13 15:44:23.777057"], ["updated_at", "2025-11-13 15:44:23.777057"]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 273]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 286], ["book_id", 273], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 286], ["book_id", 273], ["borrowed_at", "2025-11-13 15:44:23.781809"], ["due_at", "2025-11-27 15:44:23.781851"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:23.789050"], ["updated_at", "2025-11-13 15:44:23.789050"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:23.793283') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 182], ["LIMIT", 1]]
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:23.795751') AND "borrowings"."id" = $1 LIMIT $2[0m  [["id", 183], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.6ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:23.795751')[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user12@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Luisa Armstrong"], ["email", "user12@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:23.982875"], ["updated_at", "2025-11-13 15:44:23.982875"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000014"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Moab Is My Washpot"], ["author", "Lanita Moen"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Moab Is My Washpot"], ["author", "Lanita Moen"], ["genre", "Mythopoeia"], ["isbn", "978030000014"], ["total_copies", 2], ["description", "Nihil qui odio. Eos ut assumenda. Blanditiis quia est."], ["created_at", "2025-11-13 15:44:23.992018"], ["updated_at", "2025-11-13 15:44:23.992018"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 274]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 287], ["book_id", 274], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 287], ["book_id", 274], ["borrowed_at", "2025-11-13 15:44:23.995773"], ["due_at", "2025-11-27 15:44:23.995815"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:24.002174"], ["updated_at", "2025-11-13 15:44:24.002174"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.5ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-01-01 12:00:00"], ["updated_at", "2025-01-01 12:00:00"], ["id", 184]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user13@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jaleesa Armstrong"], ["email", "test@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:24.386175"], ["updated_at", "2025-11-13 15:44:24.386175"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "test@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user14@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (5.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mrs. Tereasa Schaefer"], ["email", "user@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:24.765855"], ["updated_at", "2025-11-13 15:44:24.765855"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 289], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user15@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kayleigh Rice Ret."], ["email", "user15@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:24.947797"], ["updated_at", "2025-11-13 15:44:24.947797"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000015"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Pale Kings and Princes"], ["author", "Arnulfo Hoeger"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Pale Kings and Princes"], ["author", "Arnulfo Hoeger"], ["genre", "Biography/Autobiography"], ["isbn", "978030000015"], ["total_copies", 2], ["description", "Voluptas omnis sint. Voluptates in sed. Reprehenderit perspiciatis est."], ["created_at", "2025-11-13 15:44:24.957884"], ["updated_at", "2025-11-13 15:44:24.957884"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 275]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 290], ["book_id", 275], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 290], ["book_id", 275], ["borrowed_at", "2025-11-13 15:44:24.960863"], ["due_at", "2025-11-27 15:44:24.960887"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:24.967925"], ["updated_at", "2025-11-13 15:44:24.967925"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000016"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Consider Phlebas"], ["author", "Alba Boehm"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Consider Phlebas"], ["author", "Alba Boehm"], ["genre", "Fable"], ["isbn", "978030000016"], ["total_copies", 2], ["description", "Cupiditate dolorem officia. Officia laboriosam dolore. Perspiciatis tempore tenetur."], ["created_at", "2025-11-13 15:44:24.976846"], ["updated_at", "2025-11-13 15:44:24.976846"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 276]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 290], ["book_id", 276], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 290], ["book_id", 276], ["borrowed_at", "2025-11-13 15:44:24.980813"], ["due_at", "2025-11-27 15:44:24.980852"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:24.987190"], ["updated_at", "2025-11-13 15:44:24.987190"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 290]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user16@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mark Monahan"], ["email", "user16@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:25.174488"], ["updated_at", "2025-11-13 15:44:25.174488"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000017"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Mr Standfast"], ["author", "Sam Schuppe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Mr Standfast"], ["author", "Sam Schuppe"], ["genre", "Fairy tale"], ["isbn", "978030000017"], ["total_copies", 2], ["description", "Et quia sit. Temporibus sed fugiat. Tempore id nulla."], ["created_at", "2025-11-13 15:44:25.184157"], ["updated_at", "2025-11-13 15:44:25.184157"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 277]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 291], ["book_id", 277], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 291], ["book_id", 277], ["borrowed_at", "2025-11-13 15:44:25.188729"], ["due_at", "2025-11-27 15:44:25.188753"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:25.193722"], ["updated_at", "2025-11-13 15:44:25.193722"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000018"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Vile Bodies"], ["author", "Percy Wilkinson CPA"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Vile Bodies"], ["author", "Percy Wilkinson CPA"], ["genre", "Mythopoeia"], ["isbn", "978030000018"], ["total_copies", 2], ["description", "Nemo doloremque accusamus. Vero libero dignissimos. Sunt et qui."], ["created_at", "2025-11-13 15:44:25.204197"], ["updated_at", "2025-11-13 15:44:25.204197"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 278]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 291], ["book_id", 278], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 291], ["book_id", 278], ["borrowed_at", "2025-10-23 15:44:25.207261"], ["due_at", "2025-11-06 15:44:25.207344"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:25.215069"], ["updated_at", "2025-11-13 15:44:25.215069"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:25.219465')[0m  [["user_id", 291]]
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:25.221831') AND "borrowings"."id" = $2 LIMIT $3[0m  [["user_id", 291], ["id", 187], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:25.221831')[0m  [["user_id", 291]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-13 15:44:25 +0000
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}, "auth"=>{"user"=>{"name"=>"Sam Reader", "email"=>"sam@example.com", "password"=>"[FILTERED]", "password_confirmation"=>"[FILTERED]"}}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "sam@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sam Reader"], ["email", "sam@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:25.657057"], ["updated_at", "2025-11-13 15:44:25.657057"]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 201 Created in 252ms (Views: 0.2ms | ActiveRecord: 3.0ms | Allocations: 5184)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
Started POST "/signup" for 127.0.0.1 at 2025-11-13 15:44:25 +0000
Processing by AuthController#signup as JSON
  Parameters: {"user"=>{"email"=>""}, "auth"=>{"user"=>{"email"=>""}}}
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mUser Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", ""], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:7:in `signup'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/auth_controller.rb:7:in `signup'
Completed 422 Unprocessable Content in 6ms (Views: 0.1ms | ActiveRecord: 2.2ms | Allocations: 3337)


  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Wilmer O'Kon MD"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:25.983978"], ["updated_at", "2025-11-13 15:44:25.983978"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-13 15:44:25 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 176ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 826)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Sen. Farrah Cartwright"], ["email", "login@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:26.424512"], ["updated_at", "2025-11-13 15:44:26.424512"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/login" for 127.0.0.1 at 2025-11-13 15:44:26 +0000
Processing by AuthController#login as JSON
  Parameters: {"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"login@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "login@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 401 Unauthorized in 169ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 580)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000019"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000019"], ["total_copies", 2], ["description", "Et est et. Officia voluptatem nam. Sed sint excepturi."], ["created_at", "2025-11-13 15:44:26.698467"], ["updated_at", "2025-11-13 15:44:26.698467"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000020"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["LIMIT", 1]]
  [1m[36mBook Create (0.2ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000020"], ["total_copies", 2], ["description", "Quaerat cumque molestias. Distinctio et velit. Id voluptatum et."], ["created_at", "2025-11-13 15:44:26.706958"], ["updated_at", "2025-11-13 15:44:26.706958"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user17@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Emile Willms"], ["email", "user17@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:26.883500"], ["updated_at", "2025-11-13 15:44:26.883500"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books" for 127.0.0.1 at 2025-11-13 15:44:26 +0000
Processing by BooksController#index as HTML
  Parameters: {"book"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 295], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 279]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 280]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 3.1ms | Allocations: 6692)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000021"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Eloquent Ruby"], ["author", "Russ Olsen"], ["genre", "Programming"], ["isbn", "978030000021"], ["total_copies", 2], ["description", "Officia autem aspernatur. Consectetur et error. Fuga unde nihil."], ["created_at", "2025-11-13 15:44:27.039365"], ["updated_at", "2025-11-13 15:44:27.039365"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000022"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Hobbit"], ["author", "J.R.R. Tolkien"], ["genre", "Fantasy"], ["isbn", "978030000022"], ["total_copies", 2], ["description", "Quia labore id. Dolores occaecati aliquid. Et blanditiis inventore."], ["created_at", "2025-11-13 15:44:27.051557"], ["updated_at", "2025-11-13 15:44:27.051557"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user18@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Madie Roberts"], ["email", "user18@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:27.228065"], ["updated_at", "2025-11-13 15:44:27.228065"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/books?q=ruby" for 127.0.0.1 at 2025-11-13 15:44:27 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"ruby", "book"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 296], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%ruby%' OR LOWER(author) LIKE '%ruby%' OR LOWER(genre) LIKE '%ruby%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 281]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 6ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 1713)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBook Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user19@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Erasmo Heathcote Jr."], ["email", "user19@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:27.569345"], ["updated_at", "2025-11-13 15:44:27.569345"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 15:44:27 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 297], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "New Book"], ["author", "Author Name"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "New Book"], ["author", "Author Name"], ["genre", "Genre"], ["isbn", "9781234567890"], ["total_copies", 3], ["description", nil], ["created_at", "2025-11-13 15:44:27.668950"], ["updated_at", "2025-11-13 15:44:27.668950"]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 283]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 201 Created in 14ms (Views: 0.1ms | ActiveRecord: 3.5ms | Allocations: 4297)


  [1m[36mBook Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user20@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Lavonne Lesch"], ["email", "user20@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:27.852945"], ["updated_at", "2025-11-13 15:44:27.852945"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 15:44:27 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"New Book", "author"=>"Author Name", "genre"=>"Genre", "isbn"=>"9781234567890", "total_copies"=>3}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 298], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 607)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000023"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Original Title"], ["author", "Bert Hudson VM"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Bert Hudson VM"], ["genre", "Humor"], ["isbn", "978030000023"], ["total_copies", 2], ["description", "Voluptatum labore quidem. Labore reprehenderit soluta. Rerum exercitationem ipsum."], ["created_at", "2025-11-13 15:44:27.960598"], ["updated_at", "2025-11-13 15:44:27.960598"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user21@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Gemma Harris"], ["email", "user21@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:28.136892"], ["updated_at", "2025-11-13 15:44:28.136892"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/284" for 127.0.0.1 at 2025-11-13 15:44:28 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"284"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 299], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 284], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."id" != $2 AND "books"."author" = $3 LIMIT $4[0m  [["title", "Updated Title"], ["id", 284], ["author", "Bert Hudson VM"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBook Update (0.3ms)[0m  [1m[33mUPDATE "books" SET "title" = $1, "updated_at" = $2 WHERE "books"."id" = $3[0m  [["title", "Updated Title"], ["updated_at", "2025-11-13 15:44:28.240832"], ["id", 284]]
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:30:in `update'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 284]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 7.3ms | Allocations: 4653)


  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 284], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000024"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Original Title"], ["author", "Scotty Tromp"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Original Title"], ["author", "Scotty Tromp"], ["genre", "Speech"], ["isbn", "978030000024"], ["total_copies", 2], ["description", "At suscipit nulla. Et eveniet sit. Iusto recusandae exercitationem."], ["created_at", "2025-11-13 15:44:28.258870"], ["updated_at", "2025-11-13 15:44:28.258870"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user22@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Nana Koss V"], ["email", "user22@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:28.437566"], ["updated_at", "2025-11-13 15:44:28.437566"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/books/285" for 127.0.0.1 at 2025-11-13 15:44:28 +0000
Processing by BooksController#update as JSON
  Parameters: {"book"=>{"title"=>"Updated Title"}, "id"=>"285"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 300], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 585)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000025"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Dance Dance Dance"], ["author", "Ramon Prohaska"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Dance Dance Dance"], ["author", "Ramon Prohaska"], ["genre", "Fantasy"], ["isbn", "978030000025"], ["total_copies", 2], ["description", "Ut mollitia ducimus. Deleniti suscipit quia. Voluptatem cumque voluptas."], ["created_at", "2025-11-13 15:44:28.545045"], ["updated_at", "2025-11-13 15:44:28.545045"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user23@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kip Greenfelder"], ["email", "user23@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:28.736695"], ["updated_at", "2025-11-13 15:44:28.736695"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/286" for 127.0.0.1 at 2025-11-13 15:44:28 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"286", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 301], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 286], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL LIMIT $2[0m  [["book_id", 286], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:43:in `destroy'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."book_id" = $1[0m  [["book_id", 286]]
  â†³ app/controllers/books_controller.rb:43:in `destroy'
  [1m[36mBook Destroy (0.5ms)[0m  [1m[31mDELETE FROM "books" WHERE "books"."id" = $1[0m  [["id", 286]]
  â†³ app/controllers/books_controller.rb:43:in `destroy'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:43:in `destroy'
Completed 204 No Content in 14ms (ActiveRecord: 1.8ms | Allocations: 3759)


  [1m[36mBook Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000026"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Fame Is the Spur"], ["author", "Russ O'Hara VM"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fame Is the Spur"], ["author", "Russ O'Hara VM"], ["genre", "Fiction in verse"], ["isbn", "978030000026"], ["total_copies", 2], ["description", "Ut sed vero. Optio velit vitae. Deserunt non suscipit."], ["created_at", "2025-11-13 15:44:28.862144"], ["updated_at", "2025-11-13 15:44:28.862144"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user24@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Jacqueline Klein"], ["email", "user24@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:29.038918"], ["updated_at", "2025-11-13 15:44:29.038918"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/287" for 127.0.0.1 at 2025-11-13 15:44:29 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"287", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 302], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Filter chain halted as :require_librarian! rendered or redirected
Completed 403 Forbidden in 3ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 585)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000027"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Time of our Darkness"], ["author", "Aurelio Littel"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Time of our Darkness"], ["author", "Aurelio Littel"], ["genre", "Fiction narrative"], ["isbn", "978030000027"], ["total_copies", 2], ["description", "Sunt rerum aut. Dolor veritatis necessitatibus. Qui omnis quasi."], ["created_at", "2025-11-13 15:44:29.142842"], ["updated_at", "2025-11-13 15:44:29.142842"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user25@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Renato Gislason"], ["email", "user25@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:29.320209"], ["updated_at", "2025-11-13 15:44:29.320209"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 288]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 303], ["book_id", 288], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 303], ["book_id", 288], ["borrowed_at", "2025-11-13 15:44:29.327491"], ["due_at", "2025-11-27 15:44:29.327532"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:29.334330"], ["updated_at", "2025-11-13 15:44:29.334330"]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.9ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user26@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Starla Ondricka"], ["email", "user26@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:29.514671"], ["updated_at", "2025-11-13 15:44:29.514671"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started DELETE "/books/288" for 127.0.0.1 at 2025-11-13 15:44:29 +0000
Processing by BooksController#destroy as JSON
  Parameters: {"id"=>"288", "book"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 304], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 288], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:50:in `set_book'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL LIMIT $2[0m  [["book_id", 288], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:38:in `destroy'
Completed 422 Unprocessable Content in 6ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 1572)


  [1m[36mBook Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 288], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781111111111"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Book"], ["author", "John Doe"], ["genre", "Speech"], ["isbn", "9781111111111"], ["total_copies", 2], ["description", "Quia iure labore. Vero ut est. Consequatur deleniti aut."], ["created_at", "2025-11-13 15:44:29.653363"], ["updated_at", "2025-11-13 15:44:29.653363"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user27@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Eleni Cremin"], ["email", "user27@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:29.835629"], ["updated_at", "2025-11-13 15:44:29.835629"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 15:44:29 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"The Book", "author"=>"John Doe", "genre"=>"Fiction", "isbn"=>"9782222222222", "total_copies"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 305], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9782222222222"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Book"], ["author", "John Doe"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
Completed 422 Unprocessable Content in 13ms (Views: 0.2ms | ActiveRecord: 3.8ms | Allocations: 3334)


  [1m[36mTRANSACTION (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Nine Coaches Waiting"], ["author", "Graig Greenfelder"], ["LIMIT", 1]]
  [1m[36mBook Create (0.6ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Nine Coaches Waiting"], ["author", "Graig Greenfelder"], ["genre", "Tall tale"], ["isbn", "9781234567890"], ["total_copies", 2], ["description", "Accusantium enim et. Assumenda sit sed. Inventore qui eveniet."], ["created_at", "2025-11-13 15:44:29.954347"], ["updated_at", "2025-11-13 15:44:29.954347"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user28@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Clark Cartwright"], ["email", "user28@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:30.135333"], ["updated_at", "2025-11-13 15:44:30.135333"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/books" for 127.0.0.1 at 2025-11-13 15:44:30 +0000
Processing by BooksController#create as JSON
  Parameters: {"book"=>{"title"=>"Different Title", "author"=>"Different Author", "genre"=>"Fiction", "isbn"=>"9781234567890", "total_copies"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 306], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9781234567890"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Different Title"], ["author", "Different Author"], ["LIMIT", 1]]
  â†³ app/controllers/books_controller.rb:22:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/books_controller.rb:22:in `create'
Completed 422 Unprocessable Content in 11ms (Views: 0.1ms | ActiveRecord: 3.2ms | Allocations: 3435)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user29@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Alex Grant"], ["email", "user29@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:30.413350"], ["updated_at", "2025-11-13 15:44:30.413350"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000028"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "After Many a Summer Dies the Swan"], ["author", "Lashawnda Keebler"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "After Many a Summer Dies the Swan"], ["author", "Lashawnda Keebler"], ["genre", "Crime/Detective"], ["isbn", "978030000028"], ["total_copies", 2], ["description", "Beatae voluptatem commodi. Natus omnis officiis. Iste eius veniam."], ["created_at", "2025-11-13 15:44:30.423352"], ["updated_at", "2025-11-13 15:44:30.423352"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 291]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 307], ["book_id", 291], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 307], ["book_id", 291], ["borrowed_at", "2025-11-13 15:44:30.426989"], ["due_at", "2025-11-27 15:44:30.427030"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:30.434240"], ["updated_at", "2025-11-13 15:44:30.434240"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user30@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Michele Medhurst"], ["email", "user30@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:30.611583"], ["updated_at", "2025-11-13 15:44:30.611583"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000029"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Grapes of Wrath"], ["author", "Noel Boyer"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Grapes of Wrath"], ["author", "Noel Boyer"], ["genre", "Historical fiction"], ["isbn", "978030000029"], ["total_copies", 2], ["description", "Possimus eos eum. Necessitatibus tempore enim. Vel et maxime."], ["created_at", "2025-11-13 15:44:30.622905"], ["updated_at", "2025-11-13 15:44:30.622905"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 292]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 308], ["book_id", 292], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 308], ["book_id", 292], ["borrowed_at", "2025-11-13 15:44:30.626085"], ["due_at", "2025-11-27 15:44:30.626108"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:30.634742"], ["updated_at", "2025-11-13 15:44:30.634742"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-13 15:44:30 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 307], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 307]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 291]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 70ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 3403)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user31@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Mica Welch"], ["email", "user31@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:31.007747"], ["updated_at", "2025-11-13 15:44:31.007747"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000030"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Some Buried Caesar"], ["author", "Myrle Paucek"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Some Buried Caesar"], ["author", "Myrle Paucek"], ["genre", "Textbook"], ["isbn", "978030000030"], ["total_copies", 2], ["description", "Doloribus ipsa doloremque. Iusto ratione aliquid. Nemo consequatur sunt."], ["created_at", "2025-11-13 15:44:31.018656"], ["updated_at", "2025-11-13 15:44:31.018656"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 293]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 309], ["book_id", 293], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 309], ["book_id", 293], ["borrowed_at", "2025-11-13 15:44:31.021805"], ["due_at", "2025-11-27 15:44:31.021830"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:31.026916"], ["updated_at", "2025-11-13 15:44:31.026916"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user32@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Denny Orn LLD"], ["email", "user32@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:31.202599"], ["updated_at", "2025-11-13 15:44:31.202599"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000031"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Little Hands Clapping"], ["author", "Milton Borer"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Little Hands Clapping"], ["author", "Milton Borer"], ["genre", "Realistic fiction"], ["isbn", "978030000031"], ["total_copies", 2], ["description", "Commodi animi doloribus. In nobis tempore. Nam minus quis."], ["created_at", "2025-11-13 15:44:31.212193"], ["updated_at", "2025-11-13 15:44:31.212193"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 294]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 310], ["book_id", 294], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 310], ["book_id", 294], ["borrowed_at", "2025-11-13 15:44:31.216128"], ["due_at", "2025-11-27 15:44:31.216153"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:31.221521"], ["updated_at", "2025-11-13 15:44:31.221521"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user33@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Joshua Nader"], ["email", "user33@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:31.399867"], ["updated_at", "2025-11-13 15:44:31.399867"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000032"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Daffodil Sky"], ["author", "Luisa Kihn"], ["LIMIT", 1]]
  [1m[36mBook Create (0.5ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Daffodil Sky"], ["author", "Luisa Kihn"], ["genre", "Humor"], ["isbn", "978030000032"], ["total_copies", 2], ["description", "At quis blanditiis. Aliquam dolores odio. Et sint fugit."], ["created_at", "2025-11-13 15:44:31.412131"], ["updated_at", "2025-11-13 15:44:31.412131"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 295]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 311], ["book_id", 295], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 311], ["book_id", 295], ["borrowed_at", "2025-11-13 15:44:31.416214"], ["due_at", "2025-11-27 15:44:31.416251"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:31.422072"], ["updated_at", "2025-11-13 15:44:31.422072"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user34@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Chet Kessler"], ["email", "user34@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:31.596593"], ["updated_at", "2025-11-13 15:44:31.596593"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/borrowings" for 127.0.0.1 at 2025-11-13 15:44:31 +0000
Processing by BorrowingsController#index as HTML
  Parameters: {"borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 312], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5, $6, $7, $8)[0m  [["id", 295], ["id", 294], ["id", 293], ["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 311], ["id", 310], ["id", 309], ["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 11ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 5279)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.8ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000033"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Rey Reinger"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "To Sail Beyond the Sunset"], ["author", "Rey Reinger"], ["genre", "Biography/Autobiography"], ["isbn", "978030000033"], ["total_copies", 2], ["description", "Laboriosam qui et. Eligendi totam cupiditate. At sed repellat."], ["created_at", "2025-11-13 15:44:31.713235"], ["updated_at", "2025-11-13 15:44:31.713235"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user35@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Cythia Boyle"], ["email", "user35@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:31.890611"], ["updated_at", "2025-11-13 15:44:31.890611"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 15:44:31 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>296}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 313], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 296], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 296]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 313], ["book_id", 296], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 313], ["book_id", 296], ["borrowed_at", "2025-11-13 15:44:31.984296"], ["due_at", "2025-11-27 15:44:31.984321"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:31.989581"], ["updated_at", "2025-11-13 15:44:31.989581"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 13ms (Views: 0.1ms | ActiveRecord: 2.9ms | Allocations: 4060)


  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.0ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000034"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Daffodil Sky"], ["author", "Lorretta Raynor"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Daffodil Sky"], ["author", "Lorretta Raynor"], ["genre", "Narrative nonfiction"], ["isbn", "978030000034"], ["total_copies", 1], ["description", "Itaque labore est. Placeat et officia. Quia aliquam aut."], ["created_at", "2025-11-13 15:44:32.007530"], ["updated_at", "2025-11-13 15:44:32.007530"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user36@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Nickolas Schumm"], ["email", "user36@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:32.185539"], ["updated_at", "2025-11-13 15:44:32.185539"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 297]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 314], ["book_id", 297], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 314], ["book_id", 297], ["borrowed_at", "2025-11-13 15:44:32.188697"], ["due_at", "2025-11-27 15:44:32.188720"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:32.194568"], ["updated_at", "2025-11-13 15:44:32.194568"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user37@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Erik O'Hara"], ["email", "user37@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:32.372414"], ["updated_at", "2025-11-13 15:44:32.372414"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 15:44:32 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>297}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 315], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 297], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 297]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 315], ["book_id", 297], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 13ms (Views: 0.1ms | ActiveRecord: 3.1ms | Allocations: 3536)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000035"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "In Death Ground"], ["author", "Shizue Powlowski V"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "In Death Ground"], ["author", "Shizue Powlowski V"], ["genre", "Essay"], ["isbn", "978030000035"], ["total_copies", 2], ["description", "Deserunt ratione nihil. Occaecati aut quis. Optio est tenetur."], ["created_at", "2025-11-13 15:44:32.487797"], ["updated_at", "2025-11-13 15:44:32.487797"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user38@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Oscar Jerde"], ["email", "user38@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:32.664402"], ["updated_at", "2025-11-13 15:44:32.664402"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 15:44:32 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>298}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 316], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
Completed 403 Forbidden in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 576)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (4.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user39@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Loren Glover"], ["email", "user39@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:32.936608"], ["updated_at", "2025-11-13 15:44:32.936608"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.6ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000036"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "The Other Side of Silence"], ["author", "Olimpia Hirthe"], ["LIMIT", 1]]
  [1m[36mBook Create (0.7ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "The Other Side of Silence"], ["author", "Olimpia Hirthe"], ["genre", "Classic"], ["isbn", "978030000036"], ["total_copies", 2], ["description", "Tenetur expedita quos. Quam et nulla. Placeat officiis recusandae."], ["created_at", "2025-11-13 15:44:32.946718"], ["updated_at", "2025-11-13 15:44:32.946718"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 299]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 317], ["book_id", 299], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 317], ["book_id", 299], ["borrowed_at", "2025-11-13 15:44:32.951376"], ["due_at", "2025-11-27 15:44:32.951406"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:32.956356"], ["updated_at", "2025-11-13 15:44:32.956356"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-11-13 15:44:32 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>299}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 317], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 299], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 299]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 317], ["book_id", 299], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 11ms (Views: 0.1ms | ActiveRecord: 2.9ms | Allocations: 3428)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (2.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000037"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "If I Forget Thee Jerusalem"], ["author", "Msgr. Bennie Ferry"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "If I Forget Thee Jerusalem"], ["author", "Msgr. Bennie Ferry"], ["genre", "Fiction in verse"], ["isbn", "978030000037"], ["total_copies", 2], ["description", "Sint est non. Ducimus corrupti esse. Corporis qui sint."], ["created_at", "2025-01-15 10:00:00"], ["updated_at", "2025-01-15 10:00:00"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user40@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Constance Lang DO"], ["email", "user40@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-01-15 10:00:00"], ["updated_at", "2025-01-15 10:00:00"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started POST "/borrowings" for 127.0.0.1 at 2025-01-15 10:00:00 +0000
Processing by BorrowingsController#create as JSON
  Parameters: {"borrowing"=>{"book_id"=>300}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 318], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.9ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 300], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 300]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 318], ["book_id", 300], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 318], ["book_id", 300], ["borrowed_at", "2025-01-15 10:00:00"], ["due_at", "2025-01-29 10:00:00"], ["returned_at", nil], ["created_at", "2025-01-15 10:00:00"], ["updated_at", "2025-01-15 10:00:00"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 21ms (Views: 0.1ms | ActiveRecord: 5.4ms | Allocations: 3957)


  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 198], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (4.1ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000038"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "East of Eden"], ["author", "Sen. Latosha Osinski"], ["LIMIT", 1]]
  [1m[36mBook Create (0.4ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "East of Eden"], ["author", "Sen. Latosha Osinski"], ["genre", "Tall tale"], ["isbn", "978030000038"], ["total_copies", 2], ["description", "Cum vitae repellendus. Et culpa omnis. Nobis soluta omnis."], ["created_at", "2025-11-13 15:44:33.409004"], ["updated_at", "2025-11-13 15:44:33.409004"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user41@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Taylor Hauck"], ["email", "user41@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:33.595566"], ["updated_at", "2025-11-13 15:44:33.595566"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 301]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 319], ["book_id", 301], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.4ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 319], ["book_id", 301], ["borrowed_at", "2025-11-13 15:44:33.600645"], ["due_at", "2025-11-27 15:44:33.600684"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:33.606918"], ["updated_at", "2025-11-13 15:44:33.606918"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user42@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Hallie Romaguera"], ["email", "user42@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:33.787888"], ["updated_at", "2025-11-13 15:44:33.787888"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/199/return" for 127.0.0.1 at 2025-11-13 15:44:33 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"199", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 320], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 199], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (1.6ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 15:44:33.884676"], ["updated_at", "2025-11-13 15:44:33.885112"], ["id", 199]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 319], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 301], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 13ms (Views: 0.1ms | ActiveRecord: 2.8ms | Allocations: 4390)


  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 199], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.9ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000039"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Fair Stood the Wind for France"], ["author", "Ismael Torp"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Fair Stood the Wind for France"], ["author", "Ismael Torp"], ["genre", "Fairy tale"], ["isbn", "978030000039"], ["total_copies", 2], ["description", "Non iusto dolorem. A ut et. Vel nihil aspernatur."], ["created_at", "2025-11-13 15:44:33.906977"], ["updated_at", "2025-11-13 15:44:33.906977"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user43@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Msgr. Winford Cormier"], ["email", "user43@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:34.082122"], ["updated_at", "2025-11-13 15:44:34.082122"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 302]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 321], ["book_id", 302], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 321], ["book_id", 302], ["borrowed_at", "2025-11-13 15:44:34.087276"], ["due_at", "2025-11-27 15:44:34.087300"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:34.092037"], ["updated_at", "2025-11-13 15:44:34.092037"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user44@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Deon Dooley"], ["email", "user44@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:34.273899"], ["updated_at", "2025-11-13 15:44:34.273899"]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started PATCH "/borrowings/200/return" for 127.0.0.1 at 2025-11-13 15:44:34 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"200", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 322], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 200], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mBorrowing Update (2.0ms)[0m  [1m[33mUPDATE "borrowings" SET "returned_at" = $1, "updated_at" = $2 WHERE "borrowings"."id" = $3[0m  [["returned_at", "2025-11-13 15:44:34.383020"], ["updated_at", "2025-11-13 15:44:34.383427"], ["id", 200]]
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  â†³ app/models/borrowing.rb:15:in `mark_returned!'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 321], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:60:in `borrowing_response'
  [1m[36mBook Load (0.1ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 302], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:61:in `borrowing_response'
Completed 200 OK in 12ms (Views: 0.1ms | ActiveRecord: 3.1ms | Allocations: 3890)


Started PATCH "/borrowings/200/return" for 127.0.0.1 at 2025-11-13 15:44:34 +0000
Processing by BorrowingsController#return_book as JSON
  Parameters: {"id"=>"200", "borrowing"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 322], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."id" = $1 LIMIT $2[0m  [["id", 200], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:51:in `set_borrowing'
Completed 422 Unprocessable Content in 4ms (Views: 0.1ms | ActiveRecord: 0.6ms | Allocations: 1014)


  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user45@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Elbert Champlin"], ["email", "user45@example.com"], ["password_digest", "[FILTERED]"], ["role", 1], ["created_at", "2025-11-13 15:44:34.658311"], ["updated_at", "2025-11-13 15:44:34.658311"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (2.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user46@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Kandy Fisher"], ["email", "user46@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:34.835323"], ["updated_at", "2025-11-13 15:44:34.835323"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000040"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Time of our Darkness"], ["author", "Rayford Cremin"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Time of our Darkness"], ["author", "Rayford Cremin"], ["genre", "Folklore"], ["isbn", "978030000040"], ["total_copies", 2], ["description", "Illum quidem possimus. Quibusdam est saepe. Quas laborum laboriosam."], ["created_at", "2025-11-13 15:44:34.843784"], ["updated_at", "2025-11-13 15:44:34.843784"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000041"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Dying of the Light"], ["author", "Jordon Bosco"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Dying of the Light"], ["author", "Jordon Bosco"], ["genre", "Narrative nonfiction"], ["isbn", "978030000041"], ["total_copies", 2], ["description", "Et atque aspernatur. Sint molestiae ut. Minus numquam est."], ["created_at", "2025-11-13 15:44:34.852017"], ["updated_at", "2025-11-13 15:44:34.852017"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 303]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 324], ["book_id", 303], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 324], ["book_id", 303], ["borrowed_at", "2025-11-13 15:44:34.856712"], ["due_at", "2025-11-27 15:44:34.856743"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:34.862285"], ["updated_at", "2025-11-13 15:44:34.862285"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 304]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 324], ["book_id", 304], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 324], ["book_id", 304], ["borrowed_at", "2025-10-23 15:44:34.865840"], ["due_at", "2025-11-06 15:44:34.865900"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:34.870564"], ["updated_at", "2025-11-13 15:44:34.870564"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-13 15:44:34 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 323], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:34.987468')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:35.041028')[0m  [["user_id", 324]]
  â†³ app/controllers/dashboards_controller.rb:27:in `block in librarian_dashboard'
Completed 200 OK in 58ms (Views: 0.2ms | ActiveRecord: 2.1ms | Allocations: 4462)


  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Exists? (3.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "user47@example.com"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("name", "email", "password_digest", "role", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["name", "Felicidad Gutkowski"], ["email", "user47@example.com"], ["password_digest", "[FILTERED]"], ["role", 0], ["created_at", "2025-11-13 15:44:35.225897"], ["updated_at", "2025-11-13 15:44:35.225897"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000042"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "A Farewell to Arms"], ["author", "Genaro Hegmann Jr."], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "A Farewell to Arms"], ["author", "Genaro Hegmann Jr."], ["genre", "Textbook"], ["isbn", "978030000042"], ["total_copies", 2], ["description", "At aliquam rerum. Inventore et natus. Voluptatem suscipit dolore."], ["created_at", "2025-11-13 15:44:35.235232"], ["updated_at", "2025-11-13 15:44:35.235232"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 305]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 325], ["book_id", 305], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.3ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 325], ["book_id", 305], ["borrowed_at", "2025-11-13 15:44:35.238624"], ["due_at", "2025-11-27 15:44:35.238649"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:35.243220"], ["updated_at", "2025-11-13 15:44:35.243220"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mBook Exists? (1.5ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "978030000043"], ["LIMIT", 1]]
  [1m[36mBook Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "books" WHERE "books"."title" = $1 AND "books"."author" = $2 LIMIT $3[0m  [["title", "Nine Coaches Waiting"], ["author", "Msgr. Janett Nikolaus"], ["LIMIT", 1]]
  [1m[36mBook Create (0.3ms)[0m  [1m[32mINSERT INTO "books" ("title", "author", "genre", "isbn", "total_copies", "description", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["title", "Nine Coaches Waiting"], ["author", "Msgr. Janett Nikolaus"], ["genre", "Comic/Graphic Novel"], ["isbn", "978030000043"], ["total_copies", 2], ["description", "Et consequuntur temporibus. Similique ipsam distinctio. Quia rerum ut."], ["created_at", "2025-11-13 15:44:35.251932"], ["updated_at", "2025-11-13 15:44:35.251932"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 306]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 325], ["book_id", 306], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (0.2ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 325], ["book_id", 306], ["borrowed_at", "2025-10-23 15:44:35.254702"], ["due_at", "2025-11-06 15:44:35.254760"], ["returned_at", nil], ["created_at", "2025-11-13 15:44:35.259000"], ["updated_at", "2025-11-13 15:44:35.259000"]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Started GET "/dashboard" for 127.0.0.1 at 2025-11-13 15:44:35 +0000
Processing by DashboardsController#show as HTML
  Parameters: {"dashboard"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 325], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.2ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 325]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2)[0m  [["id", 305], ["id", 306]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:44:35.359561')[0m  [["user_id", 325]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1[0m  [["id", 306]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.2ms | Allocations: 3544)


  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 15:48:25.536206"], ["id", 1]]
  [1m[36mTRANSACTION (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (2.1ms)[0m  [1m[33mUPDATE "users" SET "password_digest" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["password_digest", "[FILTERED]"], ["updated_at", "2025-11-13 15:48:25.711028"], ["id", 2]]
  [1m[36mTRANSACTION (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780201616224"], ["LIMIT", 1]]
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780132350884"], ["LIMIT", 1]]
  [1m[36mBook Load (0.2ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780062316097"], ["LIMIT", 1]]
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780399590504"], ["LIMIT", 1]]
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."isbn" = $1 LIMIT $2[0m  [["isbn", "9780451524935"], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."book_id" = $2 AND "borrowings"."returned_at" IS NULL LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
Started POST "/login" for 172.19.0.1 at 2025-11-13 15:50:00 +0000
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 319ms (Views: 0.3ms | ActiveRecord: 8.3ms | Allocations: 21735)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:50:01 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:50:01.806435')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 80ms (Views: 0.2ms | ActiveRecord: 5.7ms | Allocations: 8959)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:50:01 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:50:01.956218')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2582)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:50:07 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 47ms (Views: 0.3ms | ActiveRecord: 4.0ms | Allocations: 11471)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:50:07 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 4795)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:50:08 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:50:08.588200')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2577)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:50:08 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:50:08.695885')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2594)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:50:10 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 2.5ms | Allocations: 4810)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:50:10 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 21ms (Views: 0.5ms | ActiveRecord: 2.8ms | Allocations: 4795)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:50:18 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.5ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 45ms (Views: 0.7ms | ActiveRecord: 1.5ms | Allocations: 10973)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:50:18 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5)[0m  [["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 12ms (Views: 0.4ms | ActiveRecord: 1.3ms | Allocations: 4446)


Started POST "/login" for 172.19.0.1 at 2025-11-13 15:51:42 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"member@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "member@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 172ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 605)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:51:42 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:51:42.487280')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 12ms (Views: 0.3ms | ActiveRecord: 1.2ms | Allocations: 3347)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:51:42 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 2], ["id", 1], ["id", 3], ["id", 5]]
  â†³ app/controllers/dashboards_controller.rb:36:in `map'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:51:42.607257')[0m  [["user_id", 2]]
  â†³ app/controllers/dashboards_controller.rb:37:in `map'
Completed 200 OK in 13ms (Views: 0.3ms | ActiveRecord: 1.4ms | Allocations: 3277)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:51:59 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 5], ["id", 1], ["id", 2], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 0.9ms | Allocations: 3133)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:51:59 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.3ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" WHERE "borrowings"."user_id" = $1 ORDER BY "borrowings"."borrowed_at" DESC[0m  [["user_id", 2]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4)[0m  [["id", 5], ["id", 1], ["id", 2], ["id", 3]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 0.9ms | Allocations: 3118)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:52:11 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 2.4ms | Allocations: 4795)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:52:11 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 21ms (Views: 0.4ms | ActiveRecord: 2.5ms | Allocations: 4796)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:14 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>1}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 1], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 19ms (Views: 0.2ms | ActiveRecord: 4.1ms | Allocations: 3905)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:16 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>2}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 2], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 15ms (Views: 0.2ms | ActiveRecord: 3.5ms | Allocations: 3177)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:17 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>3}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (1.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 3], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 13ms (Views: 0.2ms | ActiveRecord: 2.9ms | Allocations: 3171)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:17 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>261}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 261], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 261], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mBorrowing Create (1.5ms)[0m  [1m[32mINSERT INTO "borrowings" ("user_id", "book_id", "borrowed_at", "due_at", "returned_at", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["user_id", 2], ["book_id", 261], ["borrowed_at", "2025-11-13 15:52:18.009587"], ["due_at", "2025-11-27 15:52:18.009615"], ["returned_at", nil], ["created_at", "2025-11-13 15:52:18.016588"], ["updated_at", "2025-11-13 15:52:18.016588"]]
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
  [1m[36mTRANSACTION (4.4ms)[0m  [1m[35mCOMMIT[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 201 Created in 23ms (Views: 0.2ms | ActiveRecord: 8.8ms | Allocations: 4088)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:52:18 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 21ms (Views: 0.3ms | ActiveRecord: 3.0ms | Allocations: 4796)


Started POST "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:19 +0000
Processing by BorrowingsController#create as HTML
  Parameters: {"borrowing"=>{"book_id"=>5}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  â†³ app/controllers/borrowings_controller.rb:25:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (2.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "borrowings" WHERE "borrowings"."user_id" = $1 AND "borrowings"."returned_at" IS NULL AND "borrowings"."book_id" = $2 LIMIT $3[0m  [["user_id", 2], ["book_id", 5], ["LIMIT", 1]]
  â†³ app/models/borrowing.rb:36:in `unique_active_borrowing_for_user'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  â†³ app/controllers/borrowings_controller.rb:32:in `create'
Completed 422 Unprocessable Content in 13ms (Views: 0.2ms | ActiveRecord: 3.3ms | Allocations: 3167)


Started POST "/login" for 172.19.0.1 at 2025-11-13 15:52:34 +0000
Processing by AuthController#login as HTML
  Parameters: {"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}, "auth"=>{"user"=>{"email"=>"librarian@example.com", "password"=>"[FILTERED]"}}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 LIMIT $2[0m  [["email", "librarian@example.com"], ["LIMIT", 1]]
  â†³ app/controllers/auth_controller.rb:15:in `login'
Completed 200 OK in 171ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 607)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:52:35 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:52:35.300257')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 1.8ms | Allocations: 2577)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:52:35 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:52:35.411521')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2576)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:41 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5, $6)[0m  [["id", 261], ["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 12ms (Views: 0.3ms | ActiveRecord: 1.2ms | Allocations: 4605)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:52:41 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5, $6)[0m  [["id", 261], ["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 11ms (Views: 0.4ms | ActiveRecord: 1.2ms | Allocations: 4605)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:52:46 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:52:46.238155')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 2576)


Started GET "/dashboard" for 172.19.0.1 at 2025-11-13 15:52:46 +0000
Processing by DashboardsController#show as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "books"[0m
  â†³ app/controllers/dashboards_controller.rb:19:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL[0m
  â†³ app/controllers/dashboards_controller.rb:20:in `librarian_dashboard'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."returned_at" IS NULL AND "borrowings"."due_at" BETWEEN $1 AND $2[0m  [["due_at", "2025-11-13 00:00:00"], ["due_at", "2025-11-13 23:59:59.999999"]]
  â†³ app/controllers/dashboards_controller.rb:21:in `librarian_dashboard'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT DISTINCT "users".* FROM "users" INNER JOIN "borrowings" ON "borrowings"."user_id" = "users"."id" WHERE "users"."role" = $1 AND "borrowings"."returned_at" IS NULL AND (due_at < '2025-11-13 15:52:46.344765')[0m  [["role", 0]]
  â†³ app/controllers/dashboards_controller.rb:22:in `map'
Completed 200 OK in 13ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2576)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:53:01 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 18ms (Views: 0.5ms | ActiveRecord: 2.3ms | Allocations: 4796)


Started GET "/books" for 172.19.0.1 at 2025-11-13 15:53:01 +0000
Processing by BooksController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books"[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 1]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 3]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 5]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 194]]
  â†³ app/models/book.rb:22:in `available_copies'
  [1m[36mBorrowing Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 261]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 4796)


Started GET "/books?q=clean+code&genre=" for 172.19.0.1 at 2025-11-13 15:53:24 +0000
Processing by BooksController#index as HTML
  Parameters: {"q"=>"clean code", "genre"=>""}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBook Load (1.7ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE (LOWER(title) LIKE '%clean code%' OR LOWER(author) LIKE '%clean code%' OR LOWER(genre) LIKE '%clean code%')[0m
  â†³ app/controllers/books_controller.rb:12:in `map'
  [1m[36mBorrowing Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "borrowings" WHERE "borrowings"."book_id" = $1 AND "borrowings"."returned_at" IS NULL[0m  [["book_id", 2]]
  â†³ app/models/book.rb:22:in `available_copies'
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 1649)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:53:35 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.4ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.4ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5, $6)[0m  [["id", 261], ["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 13ms (Views: 0.8ms | ActiveRecord: 1.3ms | Allocations: 4605)


Started GET "/borrowings" for 172.19.0.1 at 2025-11-13 15:53:35 +0000
Processing by BorrowingsController#index as HTML
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  â†³ app/controllers/application_controller.rb:19:in `authenticate_user!'
  [1m[36mBorrowing Load (0.5ms)[0m  [1m[34mSELECT "borrowings".* FROM "borrowings" ORDER BY "borrowings"."borrowed_at" DESC[0m
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mBook Load (0.3ms)[0m  [1m[34mSELECT "books".* FROM "books" WHERE "books"."id" IN ($1, $2, $3, $4, $5, $6)[0m  [["id", 261], ["id", 5], ["id", 1], ["id", 2], ["id", 3], ["id", 194]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" IN ($1, $2)[0m  [["id", 2], ["id", 211]]
  â†³ app/controllers/borrowings_controller.rb:12:in `map'
Completed 200 OK in 13ms (Views: 0.7ms | ActiveRecord: 1.3ms | Allocations: 4605)


